<!DOCTYPE html>

<html lang="en-us">
    <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <meta name="generator" content="Hugo 0.125.3">

    

    

    
        
            <meta
                name="description"
                content="This is my new hugo site" />
        

        
            <meta
                name="keywords"
                content="security,cryptohack,writeups,cyber" />
        

        
            <meta
                name="author"
                content="yoavshah" />
        

    


    <title>
        
            16-beatboxer |
            SecurityBlog
        
    </title>

    


    
    

    
    


    
    


    
    


    
    

    


    
    

    

    

        
        


        
        


        <link
            rel="stylesheet"
            href="/css/index_d751713.min.912d03bce61461ecbc3ca083479e1ed814bba94df76d0bdc6aa88fdca33621b9bb410dc2c81af31e8101fec62decfa5f6e48901ad673bc5056d2f1d1f2368a34.css"
            integrity="sha512-kS0DvOYUYey8PKCDR54e2BS7qU33bQvcaqiP3KM2Ibm7QQ3CyBrzHoEB/sYt7PpfbkiQGtZzvFBW0vHR8jaKNA==" />
    


    
    

    

    

    


    
		
        

            




    
        
    




<link
    rel="stylesheet"
    href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css"
    integrity="sha384-n8MVd4RsNIU0tAv4ct0nTaAbDJwPJzDEaqSD1odI+WdtXRGWt2kTvGFasHpSy3SV"
    crossorigin="anonymous" />


<script
    defer
    src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"
    integrity="sha384-XjKyOOlGwcjNTAIQHIpgOno0Hl1YQqzUOEleOLALmuqehneUG+vnGctmUb0ZY0l8"
    crossorigin="anonymous"></script>


<script
    defer
    src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"
    integrity="sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05"
    crossorigin="anonymous"
    
        onload="renderMathInElement(document.body , { trust: true });"
    ></script>

<script>
    document.addEventListener("DOMContentLoaded", function () {
        renderMathInElement(document.body, {
            
            
            delimiters: [
                { left: "$$", right: "$$", display: true },
                { left: "$", right: "$", display: false },
                { left: "\\(", right: "\\)", display: false },
                { left: "\\[", right: "\\]", display: true },
            ],
            
            throwOnError: false,

            
                trust: true
            
        });
    });
</script>

        

    
</head>



    <body>
        <header class="header">
    <div class="header_left">
        
    </div>

    <div class="header_middle">
        
            16-beatboxer -
            SecurityBlog
        
    </div>
</header>



        <main>
            <aside class="sidebar" style="overflow-y: auto;">
    



    
    

    
    

    

    <ul class="section-tree">
        
            
                <li
                    
                        class="dir closed-dir"
                    >
                    <span class="dir-text"> Blockchain </span>

                    



    
    

    
    

    

    <ul class="section-tree">
        
            
                <li
                    
                        class="dir closed-dir"
                    >
                    <span class="dir-text"> smart-contracts-development </span>

                    



    
    

    
    

    

    <ul class="section-tree">
        
            
                <li class="file">
                    <a href="https://yoavshah.github.io/blockchain/development/0-setting_up_environment/" title="./blockchain/development/0-setting_up_environment/">
                        
                            0-setting_up_environment
                        
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="https://yoavshah.github.io/blockchain/development/1-kingofthehill/" title="./blockchain/development/1-kingofthehill/">
                        
                            1-KingOfTheHill
                        
                    </a>
                </li>
            
        
    </ul>


                </li>
            
        
            
                <li
                    
                        class="dir closed-dir"
                    >
                    <span class="dir-text"> ethernaut </span>

                    



    
    

    
    

    

    <ul class="section-tree">
        
            
                <li class="file">
                    <a href="https://yoavshah.github.io/blockchain/ethernaut/0-setting_up_environment/" title="./blockchain/ethernaut/0-setting_up_environment/">
                        
                            0-setting_up_environment
                        
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="https://yoavshah.github.io/blockchain/ethernaut/1-fallback/" title="./blockchain/ethernaut/1-fallback/">
                        
                            1-fallback
                        
                    </a>
                </li>
            
        
    </ul>


                </li>
            
        
    </ul>


                </li>
            
        
            
                <li
                    
                        class="dir opened-dir"
                    >
                    <span class="dir-text"> Cryptohack </span>

                    



    
    

    
    

    

    <ul class="section-tree">
        
            
                <li
                    
                        class="dir closed-dir"
                    >
                    <span class="dir-text"> diffie-helman </span>

                    



    
    

    
    

    

    <ul class="section-tree">
        
            
                <li class="file">
                    <a href="https://yoavshah.github.io/cryptohack/diffie-hellman/0-diffie_hellman_explained/" title="./cryptohack/diffie-hellman/0-diffie_hellman_explained/">
                        
                            0-diffie_hellman_explained
                        
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="https://yoavshah.github.io/cryptohack/diffie-hellman/1-parameter_injection/" title="./cryptohack/diffie-hellman/1-parameter_injection/">
                        
                            1-parameter_injection
                        
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="https://yoavshah.github.io/cryptohack/diffie-hellman/2-export_grade/" title="./cryptohack/diffie-hellman/2-export_grade/">
                        
                            2-export_grade
                        
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="https://yoavshah.github.io/cryptohack/diffie-hellman/3-static_client/" title="./cryptohack/diffie-hellman/3-static_client/">
                        
                            3-static_client
                        
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="https://yoavshah.github.io/cryptohack/diffie-hellman/4-additive/" title="./cryptohack/diffie-hellman/4-additive/">
                        
                            4-additive
                        
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="https://yoavshah.github.io/cryptohack/diffie-hellman/5-static_client_2/" title="./cryptohack/diffie-hellman/5-static_client_2/">
                        
                            5-static_client_2
                        
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="https://yoavshah.github.io/cryptohack/diffie-hellman/6-script_kiddie/" title="./cryptohack/diffie-hellman/6-script_kiddie/">
                        
                            6-script_kiddie
                        
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="https://yoavshah.github.io/cryptohack/diffie-hellman/7-the_matrix/" title="./cryptohack/diffie-hellman/7-the_matrix/">
                        
                            7-the_matrix
                        
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="https://yoavshah.github.io/cryptohack/diffie-hellman/8-the_matrix_reloaded/" title="./cryptohack/diffie-hellman/8-the_matrix_reloaded/">
                        
                            8-the_matrix_reloaded
                        
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="https://yoavshah.github.io/cryptohack/diffie-hellman/9-the_matrix_revolutions/" title="./cryptohack/diffie-hellman/9-the_matrix_revolutions/">
                        
                            9-the_matrix_revolutions
                        
                    </a>
                </li>
            
        
    </ul>


                </li>
            
        
            
                <li
                    
                        class="dir closed-dir"
                    >
                    <span class="dir-text"> hashes </span>

                    



    
    

    
    

    

    <ul class="section-tree">
        
            
                <li class="file">
                    <a href="https://yoavshah.github.io/cryptohack/hashes/1-collider/" title="./cryptohack/hashes/1-collider/">
                        
                            1-collider
                        
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="https://yoavshah.github.io/cryptohack/hashes/2-hash_stuffing/" title="./cryptohack/hashes/2-hash_stuffing/">
                        
                            2-hash_stuffing
                        
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="https://yoavshah.github.io/cryptohack/hashes/3-primed5/" title="./cryptohack/hashes/3-primed5/">
                        
                            3-PriMeD5
                        
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="https://yoavshah.github.io/cryptohack/hashes/4-twin_keys/" title="./cryptohack/hashes/4-twin_keys/">
                        
                            4-twin_keys
                        
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="https://yoavshah.github.io/cryptohack/hashes/5-no_difference/" title="./cryptohack/hashes/5-no_difference/">
                        
                            5-no_difference
                        
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="https://yoavshah.github.io/cryptohack/hashes/6-md0/" title="./cryptohack/hashes/6-md0/">
                        
                            6-md0
                        
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="https://yoavshah.github.io/cryptohack/hashes/7-mdflag/" title="./cryptohack/hashes/7-mdflag/">
                        
                            7-mdflag
                        
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="https://yoavshah.github.io/cryptohack/hashes/8-mixed_up/" title="./cryptohack/hashes/8-mixed_up/">
                        
                            8-mixed_up
                        
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="https://yoavshah.github.io/cryptohack/hashes/9-invariant/" title="./cryptohack/hashes/9-invariant/">
                        
                            9-invariant
                        
                    </a>
                </li>
            
        
    </ul>


                </li>
            
        
            
                <li
                    
                        class="dir closed-dir"
                    >
                    <span class="dir-text"> rsa </span>

                    



    
    

    
    

    

    <ul class="section-tree">
        
            
                <li class="file">
                    <a href="https://yoavshah.github.io/cryptohack/rsa/0-rsa_explained/" title="./cryptohack/rsa/0-rsa_explained/">
                        
                            0-rsa_explained
                        
                    </a>
                </li>
            
        
    </ul>


                </li>
            
        
            
                <li
                    
                        class="dir opened-dir"
                    >
                    <span class="dir-text"> symmetric </span>

                    



    
    

    
    

    

    <ul class="section-tree">
        
            
                <li class="file">
                    <a href="https://yoavshah.github.io/cryptohack/symmetric/01-passwords_as_keys/" title="./cryptohack/symmetric/01-passwords_as_keys/">
                        
                            01-passwords_as_keys
                        
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="https://yoavshah.github.io/cryptohack/symmetric/02-ecbcbcwtf/" title="./cryptohack/symmetric/02-ecbcbcwtf/">
                        
                            02-ecbcbcwtf
                        
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="https://yoavshah.github.io/cryptohack/symmetric/03-ecb_oracle/" title="./cryptohack/symmetric/03-ecb_oracle/">
                        
                            03-ecb_oracle
                        
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="https://yoavshah.github.io/cryptohack/symmetric/04-flipping_cookie/" title="./cryptohack/symmetric/04-flipping_cookie/">
                        
                            04-flipping_cookie
                        
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="https://yoavshah.github.io/cryptohack/symmetric/05-lazy_cbc/" title="./cryptohack/symmetric/05-lazy_cbc/">
                        
                            05-lazy_cbc
                        
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="https://yoavshah.github.io/cryptohack/symmetric/06-triple_des/" title="./cryptohack/symmetric/06-triple_des/">
                        
                            06-triple_des
                        
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="https://yoavshah.github.io/cryptohack/symmetric/07-symmetry/" title="./cryptohack/symmetric/07-symmetry/">
                        
                            07-symmetry
                        
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="https://yoavshah.github.io/cryptohack/symmetric/08-bean_counter/" title="./cryptohack/symmetric/08-bean_counter/">
                        
                            08-bean_counter
                        
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="https://yoavshah.github.io/cryptohack/symmetric/09-ctrime/" title="./cryptohack/symmetric/09-ctrime/">
                        
                            09-ctrime
                        
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="https://yoavshah.github.io/cryptohack/symmetric/10-logon_zero/" title="./cryptohack/symmetric/10-logon_zero/">
                        
                            10-logon_zero
                        
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="https://yoavshah.github.io/cryptohack/symmetric/11-stream_consciousness/" title="./cryptohack/symmetric/11-stream_consciousness/">
                        
                            11-stream_consciousness
                        
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="https://yoavshah.github.io/cryptohack/symmetric/12-dancing_queen/" title="./cryptohack/symmetric/12-dancing_queen/">
                        
                            12-dancing_queen
                        
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="https://yoavshah.github.io/cryptohack/symmetric/13-oh-snap/" title="./cryptohack/symmetric/13-oh-snap/">
                        
                            13-oh-snap
                        
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="https://yoavshah.github.io/cryptohack/symmetric/14-paper_plane/" title="./cryptohack/symmetric/14-paper_plane/">
                        
                            14-paper_plane
                        
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="https://yoavshah.github.io/cryptohack/symmetric/15-forbidden_fruit/" title="./cryptohack/symmetric/15-forbidden_fruit/">
                        
                            15-forbidden_fruit
                        
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="https://yoavshah.github.io/cryptohack/symmetric/16-beatboxer/" title="./cryptohack/symmetric/16-beatboxer/">
                        
                            16-beatboxer
                        
                    </a>
                </li>
            
        
    </ul>


                </li>
            
        
    </ul>


                </li>
            
        
            
                <li
                    
                        class="dir closed-dir"
                    >
                    <span class="dir-text"> Windows </span>

                    



    
    

    
    

    

    <ul class="section-tree">
        
            
                <li
                    
                        class="dir closed-dir"
                    >
                    <span class="dir-text"> Kernel </span>

                    



    
    

    
    

    

    <ul class="section-tree">
        
            
                <li class="file">
                    <a href="https://yoavshah.github.io/windows/kernel/readwrite_using_dbutil_2_3/" title="./windows/kernel/readwrite_using_dbutil_2_3/">
                        
                            Read/Write using dbutil_2_3
                        
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="https://yoavshah.github.io/windows/kernel/reverse_dbutil_2_3/" title="./windows/kernel/reverse_dbutil_2_3/">
                        
                            Reverse dbutil_2_3
                        
                    </a>
                </li>
            
        
            
                <li class="file">
                    <a href="https://yoavshah.github.io/windows/kernel/reverse_rtcore64/" title="./windows/kernel/reverse_rtcore64/">
                        
                            Reverse RTCore64
                        
                    </a>
                </li>
            
        
    </ul>


                </li>
            
        
            
                <li
                    
                        class="dir closed-dir"
                    >
                    <span class="dir-text"> Portable-Executable </span>

                    



    
    

    
    

    

    <ul class="section-tree">
        
            
                <li class="file">
                    <a href="https://yoavshah.github.io/windows/portable-executable/fileinfector/" title="./windows/portable-executable/fileinfector/">
                        
                            FileInfector
                        
                    </a>
                </li>
            
        
    </ul>


                </li>
            
        
    </ul>


                </li>
            
        
    </ul>


</aside>
<aside class="exapandable"></aside>


            
    <article class="main">
        <button
    class="sidebar-toggle-btn"
    type="menu"
    aria-expanded="false"
    aria-haspopup="true">
    <i class="bi bi-list"></i>
</button>



        <div class="title">
            <h1 class="title-header">
                16-beatboxer
            </h1>

            <div class="author-date-readtime">
                

                    
                        <div class="author" title="Author">
                            <i class="bi bi-person"></i>
                            <a
                                href="/author/yoavshah/"
                                class="cat-btn">
                                yoavshah
                            </a>
                        </div>
                    

                

                
                    <div class="date" title="Date">
                        <i class="bi bi-calendar3"></i>
                        <time
                            datetime="2024.05.08"
                            >2024.05.08
                        </time>
                    </div>
                

                
                    <div
                        class="readtime"
                        title="Time to Read">
                        <i class="bi bi-clock"></i>
                        22 mins to read
                    </div>
                
            </div>
        </div>

        <div class="article-meta">
            

            

            
                <div class="breadcumb">
                    <i class="bi bi-folder"></i>
                    
    
    
    




<a href="https://yoavshah.github.io/" class="bread-btn">
    
        <i class="bi bi-house-fill"></i>
    

    
        Home
    
</a>




    /



<a href="https://yoavshah.github.io/cryptohack/" class="bread-btn">
    

    
        Cryptohack
    
</a>




    /



<a href="https://yoavshah.github.io/cryptohack/symmetric/" class="bread-btn">
    

    
        symmetric
    
</a>




    /



<a href="https://yoavshah.github.io/cryptohack/symmetric/16-beatboxer/" class="bread-btn">
    

    
        
            16-beatboxer
        

    
</a>

                </div>
            

            
        </div>

        
            <nav id="TableOfContents"></nav>
        


        <div class="content">
            
                <h1 id="challenge">Challenge</h1>
<p>In this challenge we get a remote program, that lets us to encrypt a message once and get the encrypted flag, nothing else.
We need to use this functionality to find the flag.</p>







<div class="codeblock">
    
        <div class="copy-button-box">
            <button class="copy-button" state="copy" data="#!/usr/bin/env%20python3%0d%0a%0d%0afrom%20os%20import%20urandom%0d%0afrom%20utils%20import%20listener%0d%0a%0d%0aFLAG%20=%20b%27crypto%7b????????????????????????????%7d%27%0d%0a%0d%0a%0d%0aclass%20AES:%0d%0a%20%20%20%20sbox%20=%20%28%0d%0a%20%20%20%20%20%20%20%200x2a,%200x00,%200x7e,%200x54,%200x82,%200xa8,%200xd6,%200xfc,%200x61,%200x4b,%200x35,%200x1f,%200xc9,%200xe3,%200x9d,%200xb7,%0d%0a%20%20%20%20%20%20%20%200xbc,%200x96,%200xe8,%200xc2,%200x14,%200x3e,%200x40,%200x6a,%200xf7,%200xdd,%200xa3,%200x89,%200x5f,%200x75,%200x0b,%200x21,%0d%0a%20%20%20%20%20%20%20%200x1d,%200x37,%200x49,%200x63,%200xb5,%200x9f,%200xe1,%200xcb,%200x56,%200x7c,%200x02,%200x28,%200xfe,%200xd4,%200xaa,%200x80,%0d%0a%20%20%20%20%20%20%20%200x8b,%200xa1,%200xdf,%200xf5,%200x23,%200x09,%200x77,%200x5d,%200xc0,%200xea,%200x94,%200xbe,%200x68,%200x42,%200x3c,%200x16,%0d%0a%20%20%20%20%20%20%20%200x44,%200x6e,%200x10,%200x3a,%200xec,%200xc6,%200xb8,%200x92,%200x0f,%200x25,%200x5b,%200x71,%200xa7,%200x8d,%200xf3,%200xd9,%20%0d%0a%20%20%20%20%20%20%20%200xd2,%200xf8,%200x86,%200xac,%200x7a,%200x50,%200x2e,%200x04,%200x99,%200xb3,%200xcd,%200xe7,%200x31,%200x1b,%200x65,%200x4f,%0d%0a%20%20%20%20%20%20%20%200x73,%200x59,%200x27,%200x0d,%200xdb,%200xf1,%200x8f,%200xa5,%200x38,%200x12,%200x6c,%200x46,%200x90,%200xba,%200xc4,%200xee,%0d%0a%20%20%20%20%20%20%20%200xe5,%200xcf,%200xb1,%200x9b,%200x4d,%200x67,%200x19,%200x33,%200xae,%200x84,%200xfa,%200xd0,%200x06,%200x2c,%200x52,%200x78,%0d%0a%20%20%20%20%20%20%20%200xf6,%200xdc,%200xa2,%200x88,%200x5e,%200x74,%200x0a,%200x20,%200xbd,%200x97,%200xe9,%200xc3,%200x15,%200x3f,%200x41,%200x6b,%0d%0a%20%20%20%20%20%20%20%200x60,%200x4a,%200x34,%200x1e,%200xc8,%200xe2,%200x9c,%200xb6,%200x2b,%200x01,%200x7f,%200x55,%200x83,%200xa9,%200xd7,%200xfd,%0d%0a%20%20%20%20%20%20%20%200xc1,%200xeb,%200x95,%200xbf,%200x69,%200x43,%200x3d,%200x17,%200x8a,%200xa0,%200xde,%200xf4,%200x22,%200x08,%200x76,%200x5c,%0d%0a%20%20%20%20%20%20%20%200x57,%200x7d,%200x03,%200x29,%200xff,%200xd5,%200xab,%200x81,%200x1c,%200x36,%200x48,%200x62,%200xb4,%200x9e,%200xe0,%200xca,%0d%0a%20%20%20%20%20%20%20%200x98,%200xb2,%200xcc,%200xe6,%200x30,%200x1a,%200x64,%200x4e,%200xd3,%200xf9,%200x87,%200xad,%200x7b,%200x51,%200x2f,%200x05,%0d%0a%20%20%20%20%20%20%20%200x0e,%200x24,%200x5a,%200x70,%200xa6,%200x8c,%200xf2,%200xd8,%200x45,%200x6f,%200x11,%200x3b,%200xed,%200xc7,%200xb9,%200x93,%20%0d%0a%20%20%20%20%20%20%20%200xaf,%200x85,%200xfb,%200xd1,%200x07,%200x2d,%200x53,%200x79,%200xe4,%200xce,%200xb0,%200x9a,%200x4c,%200x66,%200x18,%200x32,%20%0d%0a%20%20%20%20%20%20%20%200x39,%200x13,%200x6d,%200x47,%200x91,%200xbb,%200xc5,%200xef,%200x72,%200x58,%200x26,%200x0c,%200xda,%200xf0,%200x8e,%200xa4%0d%0a%20%20%20%20%29%0d%0a%0d%0a%20%20%20%20rcon%20=%20%280x8d,%200x01,%200x02,%200x04,%200x08,%200x10,%200x20,%200x40,%200x80,%200x1b,%200x36%29%0d%0a%0d%0a%20%20%20%20gmul2%20=%20%28%0d%0a%20%20%20%20%20%20%20%200x00,%200x02,%200x04,%200x06,%200x08,%200x0a,%200x0c,%200x0e,%200x10,%200x12,%200x14,%200x16,%200x18,%200x1a,%200x1c,%200x1e,%20%0d%0a%20%20%20%20%20%20%20%200x20,%200x22,%200x24,%200x26,%200x28,%200x2a,%200x2c,%200x2e,%200x30,%200x32,%200x34,%200x36,%200x38,%200x3a,%200x3c,%200x3e,%20%0d%0a%20%20%20%20%20%20%20%200x40,%200x42,%200x44,%200x46,%200x48,%200x4a,%200x4c,%200x4e,%200x50,%200x52,%200x54,%200x56,%200x58,%200x5a,%200x5c,%200x5e,%20%0d%0a%20%20%20%20%20%20%20%200x60,%200x62,%200x64,%200x66,%200x68,%200x6a,%200x6c,%200x6e,%200x70,%200x72,%200x74,%200x76,%200x78,%200x7a,%200x7c,%200x7e,%20%0d%0a%20%20%20%20%20%20%20%200x80,%200x82,%200x84,%200x86,%200x88,%200x8a,%200x8c,%200x8e,%200x90,%200x92,%200x94,%200x96,%200x98,%200x9a,%200x9c,%200x9e,%20%0d%0a%20%20%20%20%20%20%20%200xa0,%200xa2,%200xa4,%200xa6,%200xa8,%200xaa,%200xac,%200xae,%200xb0,%200xb2,%200xb4,%200xb6,%200xb8,%200xba,%200xbc,%200xbe,%20%0d%0a%20%20%20%20%20%20%20%200xc0,%200xc2,%200xc4,%200xc6,%200xc8,%200xca,%200xcc,%200xce,%200xd0,%200xd2,%200xd4,%200xd6,%200xd8,%200xda,%200xdc,%200xde,%20%0d%0a%20%20%20%20%20%20%20%200xe0,%200xe2,%200xe4,%200xe6,%200xe8,%200xea,%200xec,%200xee,%200xf0,%200xf2,%200xf4,%200xf6,%200xf8,%200xfa,%200xfc,%200xfe,%20%0d%0a%20%20%20%20%20%20%20%200x1b,%200x19,%200x1f,%200x1d,%200x13,%200x11,%200x17,%200x15,%200x0b,%200x09,%200x0f,%200x0d,%200x03,%200x01,%200x07,%200x05,%20%0d%0a%20%20%20%20%20%20%20%200x3b,%200x39,%200x3f,%200x3d,%200x33,%200x31,%200x37,%200x35,%200x2b,%200x29,%200x2f,%200x2d,%200x23,%200x21,%200x27,%200x25,%20%0d%0a%20%20%20%20%20%20%20%200x5b,%200x59,%200x5f,%200x5d,%200x53,%200x51,%200x57,%200x55,%200x4b,%200x49,%200x4f,%200x4d,%200x43,%200x41,%200x47,%200x45,%20%0d%0a%20%20%20%20%20%20%20%200x7b,%200x79,%200x7f,%200x7d,%200x73,%200x71,%200x77,%200x75,%200x6b,%200x69,%200x6f,%200x6d,%200x63,%200x61,%200x67,%200x65,%20%0d%0a%20%20%20%20%20%20%20%200x9b,%200x99,%200x9f,%200x9d,%200x93,%200x91,%200x97,%200x95,%200x8b,%200x89,%200x8f,%200x8d,%200x83,%200x81,%200x87,%200x85,%20%0d%0a%20%20%20%20%20%20%20%200xbb,%200xb9,%200xbf,%200xbd,%200xb3,%200xb1,%200xb7,%200xb5,%200xab,%200xa9,%200xaf,%200xad,%200xa3,%200xa1,%200xa7,%200xa5,%20%0d%0a%20%20%20%20%20%20%20%200xdb,%200xd9,%200xdf,%200xdd,%200xd3,%200xd1,%200xd7,%200xd5,%200xcb,%200xc9,%200xcf,%200xcd,%200xc3,%200xc1,%200xc7,%200xc5,%20%0d%0a%20%20%20%20%20%20%20%200xfb,%200xf9,%200xff,%200xfd,%200xf3,%200xf1,%200xf7,%200xf5,%200xeb,%200xe9,%200xef,%200xed,%200xe3,%200xe1,%200xe7,%200xe5%0d%0a%20%20%20%20%29%0d%0a%0d%0a%20%20%20%20gmul3%20=%20%28%0d%0a%20%20%20%20%20%20%20%200x00,%200x03,%200x06,%200x05,%200x0c,%200x0f,%200x0a,%200x09,%200x18,%200x1b,%200x1e,%200x1d,%200x14,%200x17,%200x12,%200x11,%20%0d%0a%20%20%20%20%20%20%20%200x30,%200x33,%200x36,%200x35,%200x3c,%200x3f,%200x3a,%200x39,%200x28,%200x2b,%200x2e,%200x2d,%200x24,%200x27,%200x22,%200x21,%20%0d%0a%20%20%20%20%20%20%20%200x60,%200x63,%200x66,%200x65,%200x6c,%200x6f,%200x6a,%200x69,%200x78,%200x7b,%200x7e,%200x7d,%200x74,%200x77,%200x72,%200x71,%20%0d%0a%20%20%20%20%20%20%20%200x50,%200x53,%200x56,%200x55,%200x5c,%200x5f,%200x5a,%200x59,%200x48,%200x4b,%200x4e,%200x4d,%200x44,%200x47,%200x42,%200x41,%20%0d%0a%20%20%20%20%20%20%20%200xc0,%200xc3,%200xc6,%200xc5,%200xcc,%200xcf,%200xca,%200xc9,%200xd8,%200xdb,%200xde,%200xdd,%200xd4,%200xd7,%200xd2,%200xd1,%20%0d%0a%20%20%20%20%20%20%20%200xf0,%200xf3,%200xf6,%200xf5,%200xfc,%200xff,%200xfa,%200xf9,%200xe8,%200xeb,%200xee,%200xed,%200xe4,%200xe7,%200xe2,%200xe1,%20%0d%0a%20%20%20%20%20%20%20%200xa0,%200xa3,%200xa6,%200xa5,%200xac,%200xaf,%200xaa,%200xa9,%200xb8,%200xbb,%200xbe,%200xbd,%200xb4,%200xb7,%200xb2,%200xb1,%20%0d%0a%20%20%20%20%20%20%20%200x90,%200x93,%200x96,%200x95,%200x9c,%200x9f,%200x9a,%200x99,%200x88,%200x8b,%200x8e,%200x8d,%200x84,%200x87,%200x82,%200x81,%20%0d%0a%20%20%20%20%20%20%20%200x9b,%200x98,%200x9d,%200x9e,%200x97,%200x94,%200x91,%200x92,%200x83,%200x80,%200x85,%200x86,%200x8f,%200x8c,%200x89,%200x8a,%20%0d%0a%20%20%20%20%20%20%20%200xab,%200xa8,%200xad,%200xae,%200xa7,%200xa4,%200xa1,%200xa2,%200xb3,%200xb0,%200xb5,%200xb6,%200xbf,%200xbc,%200xb9,%200xba,%20%0d%0a%20%20%20%20%20%20%20%200xfb,%200xf8,%200xfd,%200xfe,%200xf7,%200xf4,%200xf1,%200xf2,%200xe3,%200xe0,%200xe5,%200xe6,%200xef,%200xec,%200xe9,%200xea,%20%0d%0a%20%20%20%20%20%20%20%200xcb,%200xc8,%200xcd,%200xce,%200xc7,%200xc4,%200xc1,%200xc2,%200xd3,%200xd0,%200xd5,%200xd6,%200xdf,%200xdc,%200xd9,%200xda,%20%0d%0a%20%20%20%20%20%20%20%200x5b,%200x58,%200x5d,%200x5e,%200x57,%200x54,%200x51,%200x52,%200x43,%200x40,%200x45,%200x46,%200x4f,%200x4c,%200x49,%200x4a,%20%0d%0a%20%20%20%20%20%20%20%200x6b,%200x68,%200x6d,%200x6e,%200x67,%200x64,%200x61,%200x62,%200x73,%200x70,%200x75,%200x76,%200x7f,%200x7c,%200x79,%200x7a,%20%0d%0a%20%20%20%20%20%20%20%200x3b,%200x38,%200x3d,%200x3e,%200x37,%200x34,%200x31,%200x32,%200x23,%200x20,%200x25,%200x26,%200x2f,%200x2c,%200x29,%200x2a,%20%0d%0a%20%20%20%20%20%20%20%200x0b,%200x08,%200x0d,%200x0e,%200x07,%200x04,%200x01,%200x02,%200x13,%200x10,%200x15,%200x16,%200x1f,%200x1c,%200x19,%200x1a%0d%0a%20%20%20%20%29%0d%0a%0d%0a%20%20%20%20def%20__init__%28self,%20key%29:%0d%0a%20%20%20%20%20%20%20%20self._block_size%20=%2016%0d%0a%20%20%20%20%20%20%20%20self._round_keys%20=%20self._expand_key%28[i%20for%20i%20in%20key]%29%0d%0a%20%20%20%20%20%20%20%20self._state%20=%20[]%0d%0a%0d%0a%20%20%20%20def%20_transpose%28self,%20m%29:%0d%0a%20%20%20%20%20%20%20%20return%20[m[4%20*%20j%20&#43;%20i]%20for%20i%20in%20range%284%29%20for%20j%20in%20range%284%29]%0d%0a%0d%0a%20%20%20%20def%20_xor%28self,%20a,%20b%29:%0d%0a%20%20%20%20%20%20%20%20return%20[x%20%5e%20y%20for%20x,%20y%20in%20zip%28a,%20b%29]%0d%0a%0d%0a%20%20%20%20def%20_expand_key%28self,%20key%29:%0d%0a%20%20%20%20%20%20%20%20round_keys%20=%20[key]%0d%0a%0d%0a%20%20%20%20%20%20%20%20for%20i%20in%20range%2810%29:%0d%0a%20%20%20%20%20%20%20%20%20%20%20%20round_key%20=%20[]%0d%0a%20%20%20%20%20%20%20%20%20%20%20%20first%20=%20round_keys[i][:4]%0d%0a%20%20%20%20%20%20%20%20%20%20%20%20last%20=%20round_keys[i][-4:]%0d%0a%20%20%20%20%20%20%20%20%20%20%20%20last%20=%20last[1:]%20&#43;%20[last[0]]%0d%0a%20%20%20%20%20%20%20%20%20%20%20%20last%20=%20[self.sbox[i]%20for%20i%20in%20last]%0d%0a%0d%0a%20%20%20%20%20%20%20%20%20%20%20%20round_key.extend%28self._xor%28self._xor%28first,%20last%29,%20[self.rcon[i&#43;1],%200,%200,%200]%29%29%0d%0a%20%20%20%20%20%20%20%20%20%20%20%20for%20j%20in%20range%280,%2012,%204%29:%0d%0a%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20round_key.extend%28self._xor%28round_key[j:j%20&#43;%204],%20round_keys[i][j%20&#43;%204:j%20&#43;%208]%29%29%0d%0a%20%20%20%20%20%20%20%20%20%20%20%20round_keys.append%28round_key%29%0d%0a%0d%0a%20%20%20%20%20%20%20%20for%20i%20in%20range%28len%28round_keys%29%29:%0d%0a%20%20%20%20%20%20%20%20%20%20%20%20round_keys[i]%20=%20self._transpose%28round_keys[i]%29%0d%0a%0d%0a%20%20%20%20%20%20%20%20return%20round_keys%0d%0a%0d%0a%20%20%20%20def%20_add_round_key%28self,%20i%29:%0d%0a%20%20%20%20%20%20%20%20self._state%20=%20self._xor%28self._round_keys[i],%20self._state%29%0d%0a%0d%0a%20%20%20%20def%20_mix_columns%28self%29:%0d%0a%20%20%20%20%20%20%20%20s%20=%20[0]%20*%20self._block_size%0d%0a%20%20%20%20%20%20%20%20for%20i%20in%20range%284%29:%0d%0a%20%20%20%20%20%20%20%20%20%20%20%20s[i]%20=%20self.gmul2[self._state[i]]%20%5e%20self.gmul3[self._state[i%20&#43;%204]]%20%5e%20self._state[i%20&#43;%208]%20%5e%20self._state[i%20&#43;%2012]%0d%0a%20%20%20%20%20%20%20%20%20%20%20%20s[i%20&#43;%204]%20=%20self._state[i]%20%5e%20self.gmul2[self._state[i%20&#43;%204]]%20%5e%20self.gmul3[self._state[i%20&#43;%208]]%20%5e%20self._state[i%20&#43;%2012]%0d%0a%20%20%20%20%20%20%20%20%20%20%20%20s[i%20&#43;%208]%20=%20self._state[i]%20%5e%20self._state[i%20&#43;%204]%20%5e%20self.gmul2[self._state[i%20&#43;%208]]%20%5e%20self.gmul3[self._state[i%20&#43;%2012]]%0d%0a%20%20%20%20%20%20%20%20%20%20%20%20s[i%20&#43;%2012]%20=%20self.gmul3[self._state[i]]%20%5e%20self._state[i%20&#43;%204]%20%5e%20self._state[i%20&#43;%208]%20%5e%20self.gmul2[self._state[i%20&#43;%2012]]%0d%0a%20%20%20%20%20%20%20%20self._state%20=%20s%0d%0a%0d%0a%20%20%20%20def%20_shift_rows%28self%29:%0d%0a%20%20%20%20%20%20%20%20self._state%20=%20[%0d%0a%20%20%20%20%20%20%20%20%20%20%20%20self._state[0],%20self._state[1],%20self._state[2],%20self._state[3],%0d%0a%20%20%20%20%20%20%20%20%20%20%20%20self._state[5],%20self._state[6],%20self._state[7],%20self._state[4],%0d%0a%20%20%20%20%20%20%20%20%20%20%20%20self._state[10],%20self._state[11],%20self._state[8],%20self._state[9],%0d%0a%20%20%20%20%20%20%20%20%20%20%20%20self._state[15],%20self._state[12],%20self._state[13],%20self._state[14]%0d%0a%20%20%20%20%20%20%20%20]%0d%0a%0d%0a%20%20%20%20def%20_sub_bytes%28self%29:%0d%0a%20%20%20%20%20%20%20%20self._state%20=%20[self.sbox[i]%20for%20i%20in%20self._state]%0d%0a%0d%0a%20%20%20%20def%20_encrypt_block%28self%29:%0d%0a%20%20%20%20%20%20%20%20self._add_round_key%280%29%0d%0a%0d%0a%20%20%20%20%20%20%20%20for%20i%20in%20range%281,%2010%29:%0d%0a%20%20%20%20%20%20%20%20%20%20%20%20self._sub_bytes%28%29%0d%0a%20%20%20%20%20%20%20%20%20%20%20%20self._shift_rows%28%29%0d%0a%20%20%20%20%20%20%20%20%20%20%20%20self._mix_columns%28%29%0d%0a%20%20%20%20%20%20%20%20%20%20%20%20self._add_round_key%28i%29%0d%0a%0d%0a%20%20%20%20%20%20%20%20self._sub_bytes%28%29%0d%0a%20%20%20%20%20%20%20%20self._shift_rows%28%29%0d%0a%20%20%20%20%20%20%20%20self._add_round_key%2810%29%0d%0a%0d%0a%20%20%20%20def%20encrypt%28self,%20plaintext%29:%0d%0a%20%20%20%20%20%20%20%20ciphertext%20=%20b%27%27%0d%0a%0d%0a%20%20%20%20%20%20%20%20self._state%20=%20self._transpose%28[c%20for%20c%20in%20plaintext]%29%0d%0a%20%20%20%20%20%20%20%20self._encrypt_block%28%29%0d%0a%20%20%20%20%20%20%20%20ciphertext%20&#43;=%20bytes%28bytearray%28self._transpose%28self._state%29%29%29%0d%0a%0d%0a%20%20%20%20%20%20%20%20return%20ciphertext%0d%0a%0d%0a%0d%0aclass%20Challenge:%0d%0a%20%20%20%20def%20__init__%28self%29:%0d%0a%20%20%20%20%20%20%20%20self.before_input%20=%20%22Welcome%20to%20my%20military%20grade%20encryption%20service!%20Try%20it%20out%20by%20encrypting%20a%20message.%20You%20can%20even%20encrypt%20the%20flag,%20you%20will%20not%20be%20able%20to%20decrypt%20it%20anyway...%5cn%22%0d%0a%20%20%20%20%20%20%20%20self.aes%20=%20AES%28urandom%2816%29%29%0d%0a%20%20%20%20%20%20%20%20self.nb_encryptions%20=%200%0d%0a%0d%0a%20%20%20%20def%20challenge%28self,%20your_input%29:%0d%0a%20%20%20%20%20%20%20%20if%20%27option%27%20not%20in%20your_input:%0d%0a%20%20%20%20%20%20%20%20%20%20%20%20return%20%7b%27error%27:%20%27You%20must%20specify%20an%20option%27%7d%0d%0a%0d%0a%20%20%20%20%20%20%20%20if%20your_input[%27option%27]%20==%20%27encrypt_message%27:%0d%0a%20%20%20%20%20%20%20%20%20%20%20%20message%20=%20bytes.fromhex%28your_input[%27message%27]%29%0d%0a%20%20%20%20%20%20%20%20%20%20%20%20if%20self.nb_encryptions%20%3e%200:%0d%0a%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20%7b%27error%27:%20%27You%20already%20encrypted%20a%20message%27%7d%0d%0a%20%20%20%20%20%20%20%20%20%20%20%20if%20len%28message%29%20!=%2016:%0d%0a%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20%7b%27error%27:%20%27Message%20length%20must%20be%20exactly%2016%20bytes%27%7d%0d%0a%0d%0a%20%20%20%20%20%20%20%20%20%20%20%20self.nb_encryptions%20&#43;=%201%0d%0a%20%20%20%20%20%20%20%20%20%20%20%20return%20%7b%27encrypted_message%27:%20self.aes.encrypt%28message%29.hex%28%29%7d%0d%0a%0d%0a%20%20%20%20%20%20%20%20elif%20your_input[%27option%27]%20==%20%27encrypt_flag%27:%0d%0a%20%20%20%20%20%20%20%20%20%20%20%20padding_length%20=%2016%20-%20%28len%28FLAG%29%20%25%2016%29%0d%0a%20%20%20%20%20%20%20%20%20%20%20%20padded_flag%20=%20FLAG%20&#43;%20bytes%28[padding_length]%29%20*%20padding_length%0d%0a%0d%0a%20%20%20%20%20%20%20%20%20%20%20%20encrypted_flag%20%20=%20b%27%27%0d%0a%20%20%20%20%20%20%20%20%20%20%20%20for%20i%20in%20range%280,%20len%28padded_flag%29,%2016%29:%0d%0a%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20encrypted_flag%20&#43;=%20self.aes.encrypt%28padded_flag[i:i%20&#43;%2016]%29%0d%0a%0d%0a%20%20%20%20%20%20%20%20%20%20%20%20return%20%7b%27encrypted_flag%27:%20encrypted_flag.hex%28%29%7d%0d%0a%0d%0a%20%20%20%20%20%20%20%20return%20%7b%27error%27:%20%27Unknown%20action%27%7d%0d%0a%0d%0a%0d%0alistener.start_server%28port=13406%29">
                <i class="bi bi-copy"></i>
            </button>
        </div>
    

    
        <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e">#!/usr/bin/env python3</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> os <span style="color:#f92672">import</span> urandom
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> utils <span style="color:#f92672">import</span> listener
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>FLAG <span style="color:#f92672">=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;crypto{????????????????????????????}&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">AES</span>:
</span></span><span style="display:flex;"><span>    sbox <span style="color:#f92672">=</span> (
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0x2a</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x7e</span>, <span style="color:#ae81ff">0x54</span>, <span style="color:#ae81ff">0x82</span>, <span style="color:#ae81ff">0xa8</span>, <span style="color:#ae81ff">0xd6</span>, <span style="color:#ae81ff">0xfc</span>, <span style="color:#ae81ff">0x61</span>, <span style="color:#ae81ff">0x4b</span>, <span style="color:#ae81ff">0x35</span>, <span style="color:#ae81ff">0x1f</span>, <span style="color:#ae81ff">0xc9</span>, <span style="color:#ae81ff">0xe3</span>, <span style="color:#ae81ff">0x9d</span>, <span style="color:#ae81ff">0xb7</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0xbc</span>, <span style="color:#ae81ff">0x96</span>, <span style="color:#ae81ff">0xe8</span>, <span style="color:#ae81ff">0xc2</span>, <span style="color:#ae81ff">0x14</span>, <span style="color:#ae81ff">0x3e</span>, <span style="color:#ae81ff">0x40</span>, <span style="color:#ae81ff">0x6a</span>, <span style="color:#ae81ff">0xf7</span>, <span style="color:#ae81ff">0xdd</span>, <span style="color:#ae81ff">0xa3</span>, <span style="color:#ae81ff">0x89</span>, <span style="color:#ae81ff">0x5f</span>, <span style="color:#ae81ff">0x75</span>, <span style="color:#ae81ff">0x0b</span>, <span style="color:#ae81ff">0x21</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0x1d</span>, <span style="color:#ae81ff">0x37</span>, <span style="color:#ae81ff">0x49</span>, <span style="color:#ae81ff">0x63</span>, <span style="color:#ae81ff">0xb5</span>, <span style="color:#ae81ff">0x9f</span>, <span style="color:#ae81ff">0xe1</span>, <span style="color:#ae81ff">0xcb</span>, <span style="color:#ae81ff">0x56</span>, <span style="color:#ae81ff">0x7c</span>, <span style="color:#ae81ff">0x02</span>, <span style="color:#ae81ff">0x28</span>, <span style="color:#ae81ff">0xfe</span>, <span style="color:#ae81ff">0xd4</span>, <span style="color:#ae81ff">0xaa</span>, <span style="color:#ae81ff">0x80</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0x8b</span>, <span style="color:#ae81ff">0xa1</span>, <span style="color:#ae81ff">0xdf</span>, <span style="color:#ae81ff">0xf5</span>, <span style="color:#ae81ff">0x23</span>, <span style="color:#ae81ff">0x09</span>, <span style="color:#ae81ff">0x77</span>, <span style="color:#ae81ff">0x5d</span>, <span style="color:#ae81ff">0xc0</span>, <span style="color:#ae81ff">0xea</span>, <span style="color:#ae81ff">0x94</span>, <span style="color:#ae81ff">0xbe</span>, <span style="color:#ae81ff">0x68</span>, <span style="color:#ae81ff">0x42</span>, <span style="color:#ae81ff">0x3c</span>, <span style="color:#ae81ff">0x16</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0x44</span>, <span style="color:#ae81ff">0x6e</span>, <span style="color:#ae81ff">0x10</span>, <span style="color:#ae81ff">0x3a</span>, <span style="color:#ae81ff">0xec</span>, <span style="color:#ae81ff">0xc6</span>, <span style="color:#ae81ff">0xb8</span>, <span style="color:#ae81ff">0x92</span>, <span style="color:#ae81ff">0x0f</span>, <span style="color:#ae81ff">0x25</span>, <span style="color:#ae81ff">0x5b</span>, <span style="color:#ae81ff">0x71</span>, <span style="color:#ae81ff">0xa7</span>, <span style="color:#ae81ff">0x8d</span>, <span style="color:#ae81ff">0xf3</span>, <span style="color:#ae81ff">0xd9</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0xd2</span>, <span style="color:#ae81ff">0xf8</span>, <span style="color:#ae81ff">0x86</span>, <span style="color:#ae81ff">0xac</span>, <span style="color:#ae81ff">0x7a</span>, <span style="color:#ae81ff">0x50</span>, <span style="color:#ae81ff">0x2e</span>, <span style="color:#ae81ff">0x04</span>, <span style="color:#ae81ff">0x99</span>, <span style="color:#ae81ff">0xb3</span>, <span style="color:#ae81ff">0xcd</span>, <span style="color:#ae81ff">0xe7</span>, <span style="color:#ae81ff">0x31</span>, <span style="color:#ae81ff">0x1b</span>, <span style="color:#ae81ff">0x65</span>, <span style="color:#ae81ff">0x4f</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0x73</span>, <span style="color:#ae81ff">0x59</span>, <span style="color:#ae81ff">0x27</span>, <span style="color:#ae81ff">0x0d</span>, <span style="color:#ae81ff">0xdb</span>, <span style="color:#ae81ff">0xf1</span>, <span style="color:#ae81ff">0x8f</span>, <span style="color:#ae81ff">0xa5</span>, <span style="color:#ae81ff">0x38</span>, <span style="color:#ae81ff">0x12</span>, <span style="color:#ae81ff">0x6c</span>, <span style="color:#ae81ff">0x46</span>, <span style="color:#ae81ff">0x90</span>, <span style="color:#ae81ff">0xba</span>, <span style="color:#ae81ff">0xc4</span>, <span style="color:#ae81ff">0xee</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0xe5</span>, <span style="color:#ae81ff">0xcf</span>, <span style="color:#ae81ff">0xb1</span>, <span style="color:#ae81ff">0x9b</span>, <span style="color:#ae81ff">0x4d</span>, <span style="color:#ae81ff">0x67</span>, <span style="color:#ae81ff">0x19</span>, <span style="color:#ae81ff">0x33</span>, <span style="color:#ae81ff">0xae</span>, <span style="color:#ae81ff">0x84</span>, <span style="color:#ae81ff">0xfa</span>, <span style="color:#ae81ff">0xd0</span>, <span style="color:#ae81ff">0x06</span>, <span style="color:#ae81ff">0x2c</span>, <span style="color:#ae81ff">0x52</span>, <span style="color:#ae81ff">0x78</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0xf6</span>, <span style="color:#ae81ff">0xdc</span>, <span style="color:#ae81ff">0xa2</span>, <span style="color:#ae81ff">0x88</span>, <span style="color:#ae81ff">0x5e</span>, <span style="color:#ae81ff">0x74</span>, <span style="color:#ae81ff">0x0a</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0xbd</span>, <span style="color:#ae81ff">0x97</span>, <span style="color:#ae81ff">0xe9</span>, <span style="color:#ae81ff">0xc3</span>, <span style="color:#ae81ff">0x15</span>, <span style="color:#ae81ff">0x3f</span>, <span style="color:#ae81ff">0x41</span>, <span style="color:#ae81ff">0x6b</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0x60</span>, <span style="color:#ae81ff">0x4a</span>, <span style="color:#ae81ff">0x34</span>, <span style="color:#ae81ff">0x1e</span>, <span style="color:#ae81ff">0xc8</span>, <span style="color:#ae81ff">0xe2</span>, <span style="color:#ae81ff">0x9c</span>, <span style="color:#ae81ff">0xb6</span>, <span style="color:#ae81ff">0x2b</span>, <span style="color:#ae81ff">0x01</span>, <span style="color:#ae81ff">0x7f</span>, <span style="color:#ae81ff">0x55</span>, <span style="color:#ae81ff">0x83</span>, <span style="color:#ae81ff">0xa9</span>, <span style="color:#ae81ff">0xd7</span>, <span style="color:#ae81ff">0xfd</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0xc1</span>, <span style="color:#ae81ff">0xeb</span>, <span style="color:#ae81ff">0x95</span>, <span style="color:#ae81ff">0xbf</span>, <span style="color:#ae81ff">0x69</span>, <span style="color:#ae81ff">0x43</span>, <span style="color:#ae81ff">0x3d</span>, <span style="color:#ae81ff">0x17</span>, <span style="color:#ae81ff">0x8a</span>, <span style="color:#ae81ff">0xa0</span>, <span style="color:#ae81ff">0xde</span>, <span style="color:#ae81ff">0xf4</span>, <span style="color:#ae81ff">0x22</span>, <span style="color:#ae81ff">0x08</span>, <span style="color:#ae81ff">0x76</span>, <span style="color:#ae81ff">0x5c</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0x57</span>, <span style="color:#ae81ff">0x7d</span>, <span style="color:#ae81ff">0x03</span>, <span style="color:#ae81ff">0x29</span>, <span style="color:#ae81ff">0xff</span>, <span style="color:#ae81ff">0xd5</span>, <span style="color:#ae81ff">0xab</span>, <span style="color:#ae81ff">0x81</span>, <span style="color:#ae81ff">0x1c</span>, <span style="color:#ae81ff">0x36</span>, <span style="color:#ae81ff">0x48</span>, <span style="color:#ae81ff">0x62</span>, <span style="color:#ae81ff">0xb4</span>, <span style="color:#ae81ff">0x9e</span>, <span style="color:#ae81ff">0xe0</span>, <span style="color:#ae81ff">0xca</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0x98</span>, <span style="color:#ae81ff">0xb2</span>, <span style="color:#ae81ff">0xcc</span>, <span style="color:#ae81ff">0xe6</span>, <span style="color:#ae81ff">0x30</span>, <span style="color:#ae81ff">0x1a</span>, <span style="color:#ae81ff">0x64</span>, <span style="color:#ae81ff">0x4e</span>, <span style="color:#ae81ff">0xd3</span>, <span style="color:#ae81ff">0xf9</span>, <span style="color:#ae81ff">0x87</span>, <span style="color:#ae81ff">0xad</span>, <span style="color:#ae81ff">0x7b</span>, <span style="color:#ae81ff">0x51</span>, <span style="color:#ae81ff">0x2f</span>, <span style="color:#ae81ff">0x05</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0x0e</span>, <span style="color:#ae81ff">0x24</span>, <span style="color:#ae81ff">0x5a</span>, <span style="color:#ae81ff">0x70</span>, <span style="color:#ae81ff">0xa6</span>, <span style="color:#ae81ff">0x8c</span>, <span style="color:#ae81ff">0xf2</span>, <span style="color:#ae81ff">0xd8</span>, <span style="color:#ae81ff">0x45</span>, <span style="color:#ae81ff">0x6f</span>, <span style="color:#ae81ff">0x11</span>, <span style="color:#ae81ff">0x3b</span>, <span style="color:#ae81ff">0xed</span>, <span style="color:#ae81ff">0xc7</span>, <span style="color:#ae81ff">0xb9</span>, <span style="color:#ae81ff">0x93</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0xaf</span>, <span style="color:#ae81ff">0x85</span>, <span style="color:#ae81ff">0xfb</span>, <span style="color:#ae81ff">0xd1</span>, <span style="color:#ae81ff">0x07</span>, <span style="color:#ae81ff">0x2d</span>, <span style="color:#ae81ff">0x53</span>, <span style="color:#ae81ff">0x79</span>, <span style="color:#ae81ff">0xe4</span>, <span style="color:#ae81ff">0xce</span>, <span style="color:#ae81ff">0xb0</span>, <span style="color:#ae81ff">0x9a</span>, <span style="color:#ae81ff">0x4c</span>, <span style="color:#ae81ff">0x66</span>, <span style="color:#ae81ff">0x18</span>, <span style="color:#ae81ff">0x32</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0x39</span>, <span style="color:#ae81ff">0x13</span>, <span style="color:#ae81ff">0x6d</span>, <span style="color:#ae81ff">0x47</span>, <span style="color:#ae81ff">0x91</span>, <span style="color:#ae81ff">0xbb</span>, <span style="color:#ae81ff">0xc5</span>, <span style="color:#ae81ff">0xef</span>, <span style="color:#ae81ff">0x72</span>, <span style="color:#ae81ff">0x58</span>, <span style="color:#ae81ff">0x26</span>, <span style="color:#ae81ff">0x0c</span>, <span style="color:#ae81ff">0xda</span>, <span style="color:#ae81ff">0xf0</span>, <span style="color:#ae81ff">0x8e</span>, <span style="color:#ae81ff">0xa4</span>
</span></span><span style="display:flex;"><span>    )
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    rcon <span style="color:#f92672">=</span> (<span style="color:#ae81ff">0x8d</span>, <span style="color:#ae81ff">0x01</span>, <span style="color:#ae81ff">0x02</span>, <span style="color:#ae81ff">0x04</span>, <span style="color:#ae81ff">0x08</span>, <span style="color:#ae81ff">0x10</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x40</span>, <span style="color:#ae81ff">0x80</span>, <span style="color:#ae81ff">0x1b</span>, <span style="color:#ae81ff">0x36</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    gmul2 <span style="color:#f92672">=</span> (
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x02</span>, <span style="color:#ae81ff">0x04</span>, <span style="color:#ae81ff">0x06</span>, <span style="color:#ae81ff">0x08</span>, <span style="color:#ae81ff">0x0a</span>, <span style="color:#ae81ff">0x0c</span>, <span style="color:#ae81ff">0x0e</span>, <span style="color:#ae81ff">0x10</span>, <span style="color:#ae81ff">0x12</span>, <span style="color:#ae81ff">0x14</span>, <span style="color:#ae81ff">0x16</span>, <span style="color:#ae81ff">0x18</span>, <span style="color:#ae81ff">0x1a</span>, <span style="color:#ae81ff">0x1c</span>, <span style="color:#ae81ff">0x1e</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x22</span>, <span style="color:#ae81ff">0x24</span>, <span style="color:#ae81ff">0x26</span>, <span style="color:#ae81ff">0x28</span>, <span style="color:#ae81ff">0x2a</span>, <span style="color:#ae81ff">0x2c</span>, <span style="color:#ae81ff">0x2e</span>, <span style="color:#ae81ff">0x30</span>, <span style="color:#ae81ff">0x32</span>, <span style="color:#ae81ff">0x34</span>, <span style="color:#ae81ff">0x36</span>, <span style="color:#ae81ff">0x38</span>, <span style="color:#ae81ff">0x3a</span>, <span style="color:#ae81ff">0x3c</span>, <span style="color:#ae81ff">0x3e</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0x40</span>, <span style="color:#ae81ff">0x42</span>, <span style="color:#ae81ff">0x44</span>, <span style="color:#ae81ff">0x46</span>, <span style="color:#ae81ff">0x48</span>, <span style="color:#ae81ff">0x4a</span>, <span style="color:#ae81ff">0x4c</span>, <span style="color:#ae81ff">0x4e</span>, <span style="color:#ae81ff">0x50</span>, <span style="color:#ae81ff">0x52</span>, <span style="color:#ae81ff">0x54</span>, <span style="color:#ae81ff">0x56</span>, <span style="color:#ae81ff">0x58</span>, <span style="color:#ae81ff">0x5a</span>, <span style="color:#ae81ff">0x5c</span>, <span style="color:#ae81ff">0x5e</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0x60</span>, <span style="color:#ae81ff">0x62</span>, <span style="color:#ae81ff">0x64</span>, <span style="color:#ae81ff">0x66</span>, <span style="color:#ae81ff">0x68</span>, <span style="color:#ae81ff">0x6a</span>, <span style="color:#ae81ff">0x6c</span>, <span style="color:#ae81ff">0x6e</span>, <span style="color:#ae81ff">0x70</span>, <span style="color:#ae81ff">0x72</span>, <span style="color:#ae81ff">0x74</span>, <span style="color:#ae81ff">0x76</span>, <span style="color:#ae81ff">0x78</span>, <span style="color:#ae81ff">0x7a</span>, <span style="color:#ae81ff">0x7c</span>, <span style="color:#ae81ff">0x7e</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0x80</span>, <span style="color:#ae81ff">0x82</span>, <span style="color:#ae81ff">0x84</span>, <span style="color:#ae81ff">0x86</span>, <span style="color:#ae81ff">0x88</span>, <span style="color:#ae81ff">0x8a</span>, <span style="color:#ae81ff">0x8c</span>, <span style="color:#ae81ff">0x8e</span>, <span style="color:#ae81ff">0x90</span>, <span style="color:#ae81ff">0x92</span>, <span style="color:#ae81ff">0x94</span>, <span style="color:#ae81ff">0x96</span>, <span style="color:#ae81ff">0x98</span>, <span style="color:#ae81ff">0x9a</span>, <span style="color:#ae81ff">0x9c</span>, <span style="color:#ae81ff">0x9e</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0xa0</span>, <span style="color:#ae81ff">0xa2</span>, <span style="color:#ae81ff">0xa4</span>, <span style="color:#ae81ff">0xa6</span>, <span style="color:#ae81ff">0xa8</span>, <span style="color:#ae81ff">0xaa</span>, <span style="color:#ae81ff">0xac</span>, <span style="color:#ae81ff">0xae</span>, <span style="color:#ae81ff">0xb0</span>, <span style="color:#ae81ff">0xb2</span>, <span style="color:#ae81ff">0xb4</span>, <span style="color:#ae81ff">0xb6</span>, <span style="color:#ae81ff">0xb8</span>, <span style="color:#ae81ff">0xba</span>, <span style="color:#ae81ff">0xbc</span>, <span style="color:#ae81ff">0xbe</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0xc0</span>, <span style="color:#ae81ff">0xc2</span>, <span style="color:#ae81ff">0xc4</span>, <span style="color:#ae81ff">0xc6</span>, <span style="color:#ae81ff">0xc8</span>, <span style="color:#ae81ff">0xca</span>, <span style="color:#ae81ff">0xcc</span>, <span style="color:#ae81ff">0xce</span>, <span style="color:#ae81ff">0xd0</span>, <span style="color:#ae81ff">0xd2</span>, <span style="color:#ae81ff">0xd4</span>, <span style="color:#ae81ff">0xd6</span>, <span style="color:#ae81ff">0xd8</span>, <span style="color:#ae81ff">0xda</span>, <span style="color:#ae81ff">0xdc</span>, <span style="color:#ae81ff">0xde</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0xe0</span>, <span style="color:#ae81ff">0xe2</span>, <span style="color:#ae81ff">0xe4</span>, <span style="color:#ae81ff">0xe6</span>, <span style="color:#ae81ff">0xe8</span>, <span style="color:#ae81ff">0xea</span>, <span style="color:#ae81ff">0xec</span>, <span style="color:#ae81ff">0xee</span>, <span style="color:#ae81ff">0xf0</span>, <span style="color:#ae81ff">0xf2</span>, <span style="color:#ae81ff">0xf4</span>, <span style="color:#ae81ff">0xf6</span>, <span style="color:#ae81ff">0xf8</span>, <span style="color:#ae81ff">0xfa</span>, <span style="color:#ae81ff">0xfc</span>, <span style="color:#ae81ff">0xfe</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0x1b</span>, <span style="color:#ae81ff">0x19</span>, <span style="color:#ae81ff">0x1f</span>, <span style="color:#ae81ff">0x1d</span>, <span style="color:#ae81ff">0x13</span>, <span style="color:#ae81ff">0x11</span>, <span style="color:#ae81ff">0x17</span>, <span style="color:#ae81ff">0x15</span>, <span style="color:#ae81ff">0x0b</span>, <span style="color:#ae81ff">0x09</span>, <span style="color:#ae81ff">0x0f</span>, <span style="color:#ae81ff">0x0d</span>, <span style="color:#ae81ff">0x03</span>, <span style="color:#ae81ff">0x01</span>, <span style="color:#ae81ff">0x07</span>, <span style="color:#ae81ff">0x05</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0x3b</span>, <span style="color:#ae81ff">0x39</span>, <span style="color:#ae81ff">0x3f</span>, <span style="color:#ae81ff">0x3d</span>, <span style="color:#ae81ff">0x33</span>, <span style="color:#ae81ff">0x31</span>, <span style="color:#ae81ff">0x37</span>, <span style="color:#ae81ff">0x35</span>, <span style="color:#ae81ff">0x2b</span>, <span style="color:#ae81ff">0x29</span>, <span style="color:#ae81ff">0x2f</span>, <span style="color:#ae81ff">0x2d</span>, <span style="color:#ae81ff">0x23</span>, <span style="color:#ae81ff">0x21</span>, <span style="color:#ae81ff">0x27</span>, <span style="color:#ae81ff">0x25</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0x5b</span>, <span style="color:#ae81ff">0x59</span>, <span style="color:#ae81ff">0x5f</span>, <span style="color:#ae81ff">0x5d</span>, <span style="color:#ae81ff">0x53</span>, <span style="color:#ae81ff">0x51</span>, <span style="color:#ae81ff">0x57</span>, <span style="color:#ae81ff">0x55</span>, <span style="color:#ae81ff">0x4b</span>, <span style="color:#ae81ff">0x49</span>, <span style="color:#ae81ff">0x4f</span>, <span style="color:#ae81ff">0x4d</span>, <span style="color:#ae81ff">0x43</span>, <span style="color:#ae81ff">0x41</span>, <span style="color:#ae81ff">0x47</span>, <span style="color:#ae81ff">0x45</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0x7b</span>, <span style="color:#ae81ff">0x79</span>, <span style="color:#ae81ff">0x7f</span>, <span style="color:#ae81ff">0x7d</span>, <span style="color:#ae81ff">0x73</span>, <span style="color:#ae81ff">0x71</span>, <span style="color:#ae81ff">0x77</span>, <span style="color:#ae81ff">0x75</span>, <span style="color:#ae81ff">0x6b</span>, <span style="color:#ae81ff">0x69</span>, <span style="color:#ae81ff">0x6f</span>, <span style="color:#ae81ff">0x6d</span>, <span style="color:#ae81ff">0x63</span>, <span style="color:#ae81ff">0x61</span>, <span style="color:#ae81ff">0x67</span>, <span style="color:#ae81ff">0x65</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0x9b</span>, <span style="color:#ae81ff">0x99</span>, <span style="color:#ae81ff">0x9f</span>, <span style="color:#ae81ff">0x9d</span>, <span style="color:#ae81ff">0x93</span>, <span style="color:#ae81ff">0x91</span>, <span style="color:#ae81ff">0x97</span>, <span style="color:#ae81ff">0x95</span>, <span style="color:#ae81ff">0x8b</span>, <span style="color:#ae81ff">0x89</span>, <span style="color:#ae81ff">0x8f</span>, <span style="color:#ae81ff">0x8d</span>, <span style="color:#ae81ff">0x83</span>, <span style="color:#ae81ff">0x81</span>, <span style="color:#ae81ff">0x87</span>, <span style="color:#ae81ff">0x85</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0xbb</span>, <span style="color:#ae81ff">0xb9</span>, <span style="color:#ae81ff">0xbf</span>, <span style="color:#ae81ff">0xbd</span>, <span style="color:#ae81ff">0xb3</span>, <span style="color:#ae81ff">0xb1</span>, <span style="color:#ae81ff">0xb7</span>, <span style="color:#ae81ff">0xb5</span>, <span style="color:#ae81ff">0xab</span>, <span style="color:#ae81ff">0xa9</span>, <span style="color:#ae81ff">0xaf</span>, <span style="color:#ae81ff">0xad</span>, <span style="color:#ae81ff">0xa3</span>, <span style="color:#ae81ff">0xa1</span>, <span style="color:#ae81ff">0xa7</span>, <span style="color:#ae81ff">0xa5</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0xdb</span>, <span style="color:#ae81ff">0xd9</span>, <span style="color:#ae81ff">0xdf</span>, <span style="color:#ae81ff">0xdd</span>, <span style="color:#ae81ff">0xd3</span>, <span style="color:#ae81ff">0xd1</span>, <span style="color:#ae81ff">0xd7</span>, <span style="color:#ae81ff">0xd5</span>, <span style="color:#ae81ff">0xcb</span>, <span style="color:#ae81ff">0xc9</span>, <span style="color:#ae81ff">0xcf</span>, <span style="color:#ae81ff">0xcd</span>, <span style="color:#ae81ff">0xc3</span>, <span style="color:#ae81ff">0xc1</span>, <span style="color:#ae81ff">0xc7</span>, <span style="color:#ae81ff">0xc5</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0xfb</span>, <span style="color:#ae81ff">0xf9</span>, <span style="color:#ae81ff">0xff</span>, <span style="color:#ae81ff">0xfd</span>, <span style="color:#ae81ff">0xf3</span>, <span style="color:#ae81ff">0xf1</span>, <span style="color:#ae81ff">0xf7</span>, <span style="color:#ae81ff">0xf5</span>, <span style="color:#ae81ff">0xeb</span>, <span style="color:#ae81ff">0xe9</span>, <span style="color:#ae81ff">0xef</span>, <span style="color:#ae81ff">0xed</span>, <span style="color:#ae81ff">0xe3</span>, <span style="color:#ae81ff">0xe1</span>, <span style="color:#ae81ff">0xe7</span>, <span style="color:#ae81ff">0xe5</span>
</span></span><span style="display:flex;"><span>    )
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    gmul3 <span style="color:#f92672">=</span> (
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x03</span>, <span style="color:#ae81ff">0x06</span>, <span style="color:#ae81ff">0x05</span>, <span style="color:#ae81ff">0x0c</span>, <span style="color:#ae81ff">0x0f</span>, <span style="color:#ae81ff">0x0a</span>, <span style="color:#ae81ff">0x09</span>, <span style="color:#ae81ff">0x18</span>, <span style="color:#ae81ff">0x1b</span>, <span style="color:#ae81ff">0x1e</span>, <span style="color:#ae81ff">0x1d</span>, <span style="color:#ae81ff">0x14</span>, <span style="color:#ae81ff">0x17</span>, <span style="color:#ae81ff">0x12</span>, <span style="color:#ae81ff">0x11</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0x30</span>, <span style="color:#ae81ff">0x33</span>, <span style="color:#ae81ff">0x36</span>, <span style="color:#ae81ff">0x35</span>, <span style="color:#ae81ff">0x3c</span>, <span style="color:#ae81ff">0x3f</span>, <span style="color:#ae81ff">0x3a</span>, <span style="color:#ae81ff">0x39</span>, <span style="color:#ae81ff">0x28</span>, <span style="color:#ae81ff">0x2b</span>, <span style="color:#ae81ff">0x2e</span>, <span style="color:#ae81ff">0x2d</span>, <span style="color:#ae81ff">0x24</span>, <span style="color:#ae81ff">0x27</span>, <span style="color:#ae81ff">0x22</span>, <span style="color:#ae81ff">0x21</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0x60</span>, <span style="color:#ae81ff">0x63</span>, <span style="color:#ae81ff">0x66</span>, <span style="color:#ae81ff">0x65</span>, <span style="color:#ae81ff">0x6c</span>, <span style="color:#ae81ff">0x6f</span>, <span style="color:#ae81ff">0x6a</span>, <span style="color:#ae81ff">0x69</span>, <span style="color:#ae81ff">0x78</span>, <span style="color:#ae81ff">0x7b</span>, <span style="color:#ae81ff">0x7e</span>, <span style="color:#ae81ff">0x7d</span>, <span style="color:#ae81ff">0x74</span>, <span style="color:#ae81ff">0x77</span>, <span style="color:#ae81ff">0x72</span>, <span style="color:#ae81ff">0x71</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0x50</span>, <span style="color:#ae81ff">0x53</span>, <span style="color:#ae81ff">0x56</span>, <span style="color:#ae81ff">0x55</span>, <span style="color:#ae81ff">0x5c</span>, <span style="color:#ae81ff">0x5f</span>, <span style="color:#ae81ff">0x5a</span>, <span style="color:#ae81ff">0x59</span>, <span style="color:#ae81ff">0x48</span>, <span style="color:#ae81ff">0x4b</span>, <span style="color:#ae81ff">0x4e</span>, <span style="color:#ae81ff">0x4d</span>, <span style="color:#ae81ff">0x44</span>, <span style="color:#ae81ff">0x47</span>, <span style="color:#ae81ff">0x42</span>, <span style="color:#ae81ff">0x41</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0xc0</span>, <span style="color:#ae81ff">0xc3</span>, <span style="color:#ae81ff">0xc6</span>, <span style="color:#ae81ff">0xc5</span>, <span style="color:#ae81ff">0xcc</span>, <span style="color:#ae81ff">0xcf</span>, <span style="color:#ae81ff">0xca</span>, <span style="color:#ae81ff">0xc9</span>, <span style="color:#ae81ff">0xd8</span>, <span style="color:#ae81ff">0xdb</span>, <span style="color:#ae81ff">0xde</span>, <span style="color:#ae81ff">0xdd</span>, <span style="color:#ae81ff">0xd4</span>, <span style="color:#ae81ff">0xd7</span>, <span style="color:#ae81ff">0xd2</span>, <span style="color:#ae81ff">0xd1</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0xf0</span>, <span style="color:#ae81ff">0xf3</span>, <span style="color:#ae81ff">0xf6</span>, <span style="color:#ae81ff">0xf5</span>, <span style="color:#ae81ff">0xfc</span>, <span style="color:#ae81ff">0xff</span>, <span style="color:#ae81ff">0xfa</span>, <span style="color:#ae81ff">0xf9</span>, <span style="color:#ae81ff">0xe8</span>, <span style="color:#ae81ff">0xeb</span>, <span style="color:#ae81ff">0xee</span>, <span style="color:#ae81ff">0xed</span>, <span style="color:#ae81ff">0xe4</span>, <span style="color:#ae81ff">0xe7</span>, <span style="color:#ae81ff">0xe2</span>, <span style="color:#ae81ff">0xe1</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0xa0</span>, <span style="color:#ae81ff">0xa3</span>, <span style="color:#ae81ff">0xa6</span>, <span style="color:#ae81ff">0xa5</span>, <span style="color:#ae81ff">0xac</span>, <span style="color:#ae81ff">0xaf</span>, <span style="color:#ae81ff">0xaa</span>, <span style="color:#ae81ff">0xa9</span>, <span style="color:#ae81ff">0xb8</span>, <span style="color:#ae81ff">0xbb</span>, <span style="color:#ae81ff">0xbe</span>, <span style="color:#ae81ff">0xbd</span>, <span style="color:#ae81ff">0xb4</span>, <span style="color:#ae81ff">0xb7</span>, <span style="color:#ae81ff">0xb2</span>, <span style="color:#ae81ff">0xb1</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0x90</span>, <span style="color:#ae81ff">0x93</span>, <span style="color:#ae81ff">0x96</span>, <span style="color:#ae81ff">0x95</span>, <span style="color:#ae81ff">0x9c</span>, <span style="color:#ae81ff">0x9f</span>, <span style="color:#ae81ff">0x9a</span>, <span style="color:#ae81ff">0x99</span>, <span style="color:#ae81ff">0x88</span>, <span style="color:#ae81ff">0x8b</span>, <span style="color:#ae81ff">0x8e</span>, <span style="color:#ae81ff">0x8d</span>, <span style="color:#ae81ff">0x84</span>, <span style="color:#ae81ff">0x87</span>, <span style="color:#ae81ff">0x82</span>, <span style="color:#ae81ff">0x81</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0x9b</span>, <span style="color:#ae81ff">0x98</span>, <span style="color:#ae81ff">0x9d</span>, <span style="color:#ae81ff">0x9e</span>, <span style="color:#ae81ff">0x97</span>, <span style="color:#ae81ff">0x94</span>, <span style="color:#ae81ff">0x91</span>, <span style="color:#ae81ff">0x92</span>, <span style="color:#ae81ff">0x83</span>, <span style="color:#ae81ff">0x80</span>, <span style="color:#ae81ff">0x85</span>, <span style="color:#ae81ff">0x86</span>, <span style="color:#ae81ff">0x8f</span>, <span style="color:#ae81ff">0x8c</span>, <span style="color:#ae81ff">0x89</span>, <span style="color:#ae81ff">0x8a</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0xab</span>, <span style="color:#ae81ff">0xa8</span>, <span style="color:#ae81ff">0xad</span>, <span style="color:#ae81ff">0xae</span>, <span style="color:#ae81ff">0xa7</span>, <span style="color:#ae81ff">0xa4</span>, <span style="color:#ae81ff">0xa1</span>, <span style="color:#ae81ff">0xa2</span>, <span style="color:#ae81ff">0xb3</span>, <span style="color:#ae81ff">0xb0</span>, <span style="color:#ae81ff">0xb5</span>, <span style="color:#ae81ff">0xb6</span>, <span style="color:#ae81ff">0xbf</span>, <span style="color:#ae81ff">0xbc</span>, <span style="color:#ae81ff">0xb9</span>, <span style="color:#ae81ff">0xba</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0xfb</span>, <span style="color:#ae81ff">0xf8</span>, <span style="color:#ae81ff">0xfd</span>, <span style="color:#ae81ff">0xfe</span>, <span style="color:#ae81ff">0xf7</span>, <span style="color:#ae81ff">0xf4</span>, <span style="color:#ae81ff">0xf1</span>, <span style="color:#ae81ff">0xf2</span>, <span style="color:#ae81ff">0xe3</span>, <span style="color:#ae81ff">0xe0</span>, <span style="color:#ae81ff">0xe5</span>, <span style="color:#ae81ff">0xe6</span>, <span style="color:#ae81ff">0xef</span>, <span style="color:#ae81ff">0xec</span>, <span style="color:#ae81ff">0xe9</span>, <span style="color:#ae81ff">0xea</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0xcb</span>, <span style="color:#ae81ff">0xc8</span>, <span style="color:#ae81ff">0xcd</span>, <span style="color:#ae81ff">0xce</span>, <span style="color:#ae81ff">0xc7</span>, <span style="color:#ae81ff">0xc4</span>, <span style="color:#ae81ff">0xc1</span>, <span style="color:#ae81ff">0xc2</span>, <span style="color:#ae81ff">0xd3</span>, <span style="color:#ae81ff">0xd0</span>, <span style="color:#ae81ff">0xd5</span>, <span style="color:#ae81ff">0xd6</span>, <span style="color:#ae81ff">0xdf</span>, <span style="color:#ae81ff">0xdc</span>, <span style="color:#ae81ff">0xd9</span>, <span style="color:#ae81ff">0xda</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0x5b</span>, <span style="color:#ae81ff">0x58</span>, <span style="color:#ae81ff">0x5d</span>, <span style="color:#ae81ff">0x5e</span>, <span style="color:#ae81ff">0x57</span>, <span style="color:#ae81ff">0x54</span>, <span style="color:#ae81ff">0x51</span>, <span style="color:#ae81ff">0x52</span>, <span style="color:#ae81ff">0x43</span>, <span style="color:#ae81ff">0x40</span>, <span style="color:#ae81ff">0x45</span>, <span style="color:#ae81ff">0x46</span>, <span style="color:#ae81ff">0x4f</span>, <span style="color:#ae81ff">0x4c</span>, <span style="color:#ae81ff">0x49</span>, <span style="color:#ae81ff">0x4a</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0x6b</span>, <span style="color:#ae81ff">0x68</span>, <span style="color:#ae81ff">0x6d</span>, <span style="color:#ae81ff">0x6e</span>, <span style="color:#ae81ff">0x67</span>, <span style="color:#ae81ff">0x64</span>, <span style="color:#ae81ff">0x61</span>, <span style="color:#ae81ff">0x62</span>, <span style="color:#ae81ff">0x73</span>, <span style="color:#ae81ff">0x70</span>, <span style="color:#ae81ff">0x75</span>, <span style="color:#ae81ff">0x76</span>, <span style="color:#ae81ff">0x7f</span>, <span style="color:#ae81ff">0x7c</span>, <span style="color:#ae81ff">0x79</span>, <span style="color:#ae81ff">0x7a</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0x3b</span>, <span style="color:#ae81ff">0x38</span>, <span style="color:#ae81ff">0x3d</span>, <span style="color:#ae81ff">0x3e</span>, <span style="color:#ae81ff">0x37</span>, <span style="color:#ae81ff">0x34</span>, <span style="color:#ae81ff">0x31</span>, <span style="color:#ae81ff">0x32</span>, <span style="color:#ae81ff">0x23</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x25</span>, <span style="color:#ae81ff">0x26</span>, <span style="color:#ae81ff">0x2f</span>, <span style="color:#ae81ff">0x2c</span>, <span style="color:#ae81ff">0x29</span>, <span style="color:#ae81ff">0x2a</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0x0b</span>, <span style="color:#ae81ff">0x08</span>, <span style="color:#ae81ff">0x0d</span>, <span style="color:#ae81ff">0x0e</span>, <span style="color:#ae81ff">0x07</span>, <span style="color:#ae81ff">0x04</span>, <span style="color:#ae81ff">0x01</span>, <span style="color:#ae81ff">0x02</span>, <span style="color:#ae81ff">0x13</span>, <span style="color:#ae81ff">0x10</span>, <span style="color:#ae81ff">0x15</span>, <span style="color:#ae81ff">0x16</span>, <span style="color:#ae81ff">0x1f</span>, <span style="color:#ae81ff">0x1c</span>, <span style="color:#ae81ff">0x19</span>, <span style="color:#ae81ff">0x1a</span>
</span></span><span style="display:flex;"><span>    )
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> __init__(self, key):
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>_block_size <span style="color:#f92672">=</span> <span style="color:#ae81ff">16</span>
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>_round_keys <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>_expand_key([i <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> key])
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>_state <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">_transpose</span>(self, m):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> [m[<span style="color:#ae81ff">4</span> <span style="color:#f92672">*</span> j <span style="color:#f92672">+</span> i] <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">4</span>) <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">4</span>)]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">_xor</span>(self, a, b):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> [x <span style="color:#f92672">^</span> y <span style="color:#66d9ef">for</span> x, y <span style="color:#f92672">in</span> zip(a, b)]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">_expand_key</span>(self, key):
</span></span><span style="display:flex;"><span>        round_keys <span style="color:#f92672">=</span> [key]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">10</span>):
</span></span><span style="display:flex;"><span>            round_key <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>            first <span style="color:#f92672">=</span> round_keys[i][:<span style="color:#ae81ff">4</span>]
</span></span><span style="display:flex;"><span>            last <span style="color:#f92672">=</span> round_keys[i][<span style="color:#f92672">-</span><span style="color:#ae81ff">4</span>:]
</span></span><span style="display:flex;"><span>            last <span style="color:#f92672">=</span> last[<span style="color:#ae81ff">1</span>:] <span style="color:#f92672">+</span> [last[<span style="color:#ae81ff">0</span>]]
</span></span><span style="display:flex;"><span>            last <span style="color:#f92672">=</span> [self<span style="color:#f92672">.</span>sbox[i] <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> last]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            round_key<span style="color:#f92672">.</span>extend(self<span style="color:#f92672">.</span>_xor(self<span style="color:#f92672">.</span>_xor(first, last), [self<span style="color:#f92672">.</span>rcon[i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>], <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>]))
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">4</span>):
</span></span><span style="display:flex;"><span>                round_key<span style="color:#f92672">.</span>extend(self<span style="color:#f92672">.</span>_xor(round_key[j:j <span style="color:#f92672">+</span> <span style="color:#ae81ff">4</span>], round_keys[i][j <span style="color:#f92672">+</span> <span style="color:#ae81ff">4</span>:j <span style="color:#f92672">+</span> <span style="color:#ae81ff">8</span>]))
</span></span><span style="display:flex;"><span>            round_keys<span style="color:#f92672">.</span>append(round_key)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(len(round_keys)):
</span></span><span style="display:flex;"><span>            round_keys[i] <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>_transpose(round_keys[i])
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> round_keys
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">_add_round_key</span>(self, i):
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>_state <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>_xor(self<span style="color:#f92672">.</span>_round_keys[i], self<span style="color:#f92672">.</span>_state)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">_mix_columns</span>(self):
</span></span><span style="display:flex;"><span>        s <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0</span>] <span style="color:#f92672">*</span> self<span style="color:#f92672">.</span>_block_size
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">4</span>):
</span></span><span style="display:flex;"><span>            s[i] <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>gmul2[self<span style="color:#f92672">.</span>_state[i]] <span style="color:#f92672">^</span> self<span style="color:#f92672">.</span>gmul3[self<span style="color:#f92672">.</span>_state[i <span style="color:#f92672">+</span> <span style="color:#ae81ff">4</span>]] <span style="color:#f92672">^</span> self<span style="color:#f92672">.</span>_state[i <span style="color:#f92672">+</span> <span style="color:#ae81ff">8</span>] <span style="color:#f92672">^</span> self<span style="color:#f92672">.</span>_state[i <span style="color:#f92672">+</span> <span style="color:#ae81ff">12</span>]
</span></span><span style="display:flex;"><span>            s[i <span style="color:#f92672">+</span> <span style="color:#ae81ff">4</span>] <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>_state[i] <span style="color:#f92672">^</span> self<span style="color:#f92672">.</span>gmul2[self<span style="color:#f92672">.</span>_state[i <span style="color:#f92672">+</span> <span style="color:#ae81ff">4</span>]] <span style="color:#f92672">^</span> self<span style="color:#f92672">.</span>gmul3[self<span style="color:#f92672">.</span>_state[i <span style="color:#f92672">+</span> <span style="color:#ae81ff">8</span>]] <span style="color:#f92672">^</span> self<span style="color:#f92672">.</span>_state[i <span style="color:#f92672">+</span> <span style="color:#ae81ff">12</span>]
</span></span><span style="display:flex;"><span>            s[i <span style="color:#f92672">+</span> <span style="color:#ae81ff">8</span>] <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>_state[i] <span style="color:#f92672">^</span> self<span style="color:#f92672">.</span>_state[i <span style="color:#f92672">+</span> <span style="color:#ae81ff">4</span>] <span style="color:#f92672">^</span> self<span style="color:#f92672">.</span>gmul2[self<span style="color:#f92672">.</span>_state[i <span style="color:#f92672">+</span> <span style="color:#ae81ff">8</span>]] <span style="color:#f92672">^</span> self<span style="color:#f92672">.</span>gmul3[self<span style="color:#f92672">.</span>_state[i <span style="color:#f92672">+</span> <span style="color:#ae81ff">12</span>]]
</span></span><span style="display:flex;"><span>            s[i <span style="color:#f92672">+</span> <span style="color:#ae81ff">12</span>] <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>gmul3[self<span style="color:#f92672">.</span>_state[i]] <span style="color:#f92672">^</span> self<span style="color:#f92672">.</span>_state[i <span style="color:#f92672">+</span> <span style="color:#ae81ff">4</span>] <span style="color:#f92672">^</span> self<span style="color:#f92672">.</span>_state[i <span style="color:#f92672">+</span> <span style="color:#ae81ff">8</span>] <span style="color:#f92672">^</span> self<span style="color:#f92672">.</span>gmul2[self<span style="color:#f92672">.</span>_state[i <span style="color:#f92672">+</span> <span style="color:#ae81ff">12</span>]]
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>_state <span style="color:#f92672">=</span> s
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">_shift_rows</span>(self):
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>_state <span style="color:#f92672">=</span> [
</span></span><span style="display:flex;"><span>            self<span style="color:#f92672">.</span>_state[<span style="color:#ae81ff">0</span>], self<span style="color:#f92672">.</span>_state[<span style="color:#ae81ff">1</span>], self<span style="color:#f92672">.</span>_state[<span style="color:#ae81ff">2</span>], self<span style="color:#f92672">.</span>_state[<span style="color:#ae81ff">3</span>],
</span></span><span style="display:flex;"><span>            self<span style="color:#f92672">.</span>_state[<span style="color:#ae81ff">5</span>], self<span style="color:#f92672">.</span>_state[<span style="color:#ae81ff">6</span>], self<span style="color:#f92672">.</span>_state[<span style="color:#ae81ff">7</span>], self<span style="color:#f92672">.</span>_state[<span style="color:#ae81ff">4</span>],
</span></span><span style="display:flex;"><span>            self<span style="color:#f92672">.</span>_state[<span style="color:#ae81ff">10</span>], self<span style="color:#f92672">.</span>_state[<span style="color:#ae81ff">11</span>], self<span style="color:#f92672">.</span>_state[<span style="color:#ae81ff">8</span>], self<span style="color:#f92672">.</span>_state[<span style="color:#ae81ff">9</span>],
</span></span><span style="display:flex;"><span>            self<span style="color:#f92672">.</span>_state[<span style="color:#ae81ff">15</span>], self<span style="color:#f92672">.</span>_state[<span style="color:#ae81ff">12</span>], self<span style="color:#f92672">.</span>_state[<span style="color:#ae81ff">13</span>], self<span style="color:#f92672">.</span>_state[<span style="color:#ae81ff">14</span>]
</span></span><span style="display:flex;"><span>        ]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">_sub_bytes</span>(self):
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>_state <span style="color:#f92672">=</span> [self<span style="color:#f92672">.</span>sbox[i] <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> self<span style="color:#f92672">.</span>_state]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">_encrypt_block</span>(self):
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>_add_round_key(<span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">10</span>):
</span></span><span style="display:flex;"><span>            self<span style="color:#f92672">.</span>_sub_bytes()
</span></span><span style="display:flex;"><span>            self<span style="color:#f92672">.</span>_shift_rows()
</span></span><span style="display:flex;"><span>            self<span style="color:#f92672">.</span>_mix_columns()
</span></span><span style="display:flex;"><span>            self<span style="color:#f92672">.</span>_add_round_key(i)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>_sub_bytes()
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>_shift_rows()
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>_add_round_key(<span style="color:#ae81ff">10</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">encrypt</span>(self, plaintext):
</span></span><span style="display:flex;"><span>        ciphertext <span style="color:#f92672">=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>_state <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>_transpose([c <span style="color:#66d9ef">for</span> c <span style="color:#f92672">in</span> plaintext])
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>_encrypt_block()
</span></span><span style="display:flex;"><span>        ciphertext <span style="color:#f92672">+=</span> bytes(bytearray(self<span style="color:#f92672">.</span>_transpose(self<span style="color:#f92672">.</span>_state)))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> ciphertext
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Challenge</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> __init__(self):
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>before_input <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Welcome to my military grade encryption service! Try it out by encrypting a message. You can even encrypt the flag, you will not be able to decrypt it anyway...</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>aes <span style="color:#f92672">=</span> AES(urandom(<span style="color:#ae81ff">16</span>))
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>nb_encryptions <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">challenge</span>(self, your_input):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> <span style="color:#e6db74">&#39;option&#39;</span> <span style="color:#f92672">not</span> <span style="color:#f92672">in</span> your_input:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> {<span style="color:#e6db74">&#39;error&#39;</span>: <span style="color:#e6db74">&#39;You must specify an option&#39;</span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> your_input[<span style="color:#e6db74">&#39;option&#39;</span>] <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;encrypt_message&#39;</span>:
</span></span><span style="display:flex;"><span>            message <span style="color:#f92672">=</span> bytes<span style="color:#f92672">.</span>fromhex(your_input[<span style="color:#e6db74">&#39;message&#39;</span>])
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> self<span style="color:#f92672">.</span>nb_encryptions <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0</span>:
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">return</span> {<span style="color:#e6db74">&#39;error&#39;</span>: <span style="color:#e6db74">&#39;You already encrypted a message&#39;</span>}
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> len(message) <span style="color:#f92672">!=</span> <span style="color:#ae81ff">16</span>:
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">return</span> {<span style="color:#e6db74">&#39;error&#39;</span>: <span style="color:#e6db74">&#39;Message length must be exactly 16 bytes&#39;</span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            self<span style="color:#f92672">.</span>nb_encryptions <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> {<span style="color:#e6db74">&#39;encrypted_message&#39;</span>: self<span style="color:#f92672">.</span>aes<span style="color:#f92672">.</span>encrypt(message)<span style="color:#f92672">.</span>hex()}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">elif</span> your_input[<span style="color:#e6db74">&#39;option&#39;</span>] <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;encrypt_flag&#39;</span>:
</span></span><span style="display:flex;"><span>            padding_length <span style="color:#f92672">=</span> <span style="color:#ae81ff">16</span> <span style="color:#f92672">-</span> (len(FLAG) <span style="color:#f92672">%</span> <span style="color:#ae81ff">16</span>)
</span></span><span style="display:flex;"><span>            padded_flag <span style="color:#f92672">=</span> FLAG <span style="color:#f92672">+</span> bytes([padding_length]) <span style="color:#f92672">*</span> padding_length
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            encrypted_flag  <span style="color:#f92672">=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;&#39;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">0</span>, len(padded_flag), <span style="color:#ae81ff">16</span>):
</span></span><span style="display:flex;"><span>                encrypted_flag <span style="color:#f92672">+=</span> self<span style="color:#f92672">.</span>aes<span style="color:#f92672">.</span>encrypt(padded_flag[i:i <span style="color:#f92672">+</span> <span style="color:#ae81ff">16</span>])
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> {<span style="color:#e6db74">&#39;encrypted_flag&#39;</span>: encrypted_flag<span style="color:#f92672">.</span>hex()}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> {<span style="color:#e6db74">&#39;error&#39;</span>: <span style="color:#e6db74">&#39;Unknown action&#39;</span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>listener<span style="color:#f92672">.</span>start_server(port<span style="color:#f92672">=</span><span style="color:#ae81ff">13406</span>)</span></span></code></pre></div>
    
</div>
<p><img src="/cryptohack/symmetric/images/ECB_encryption.svg" alt="ECB Encryption"></p>
<h1 id="solution">Solution</h1>
<p>Let&rsquo;s understand something about AES.
AES is a function bijective function from one block of 16 bytes to another block of 16 bytes.</p>
<p>$$
2^{128} \leftrightarrow 2^{128}
$$</p>
<p>In AES, the thing that is responsible to the non-linearity of the bijective function is the $sbox$, without the $sbox$ or with a weak one, the whole AES will be linear!</p>
<p>If AES is linear, then for all $0 &lt;= i &lt; 256$, regardless of the key, changing the $i$ bit in the plaintext will change the same multiple bytes in the ciphertext over and over again.</p>
<p>Let&rsquo;s look at the AES class used in the remote program but change 323 to <code>pass</code> so the $sbox$ will not take effect.</p>







<div class="codeblock">
    
        <div class="copy-button-box">
            <button class="copy-button" state="copy" data="#ZgotmplZ">
                <i class="bi bi-copy"></i>
            </button>
        </div>
    

    
        <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">AES</span>:
</span></span><span style="display:flex;"><span>    sbox <span style="color:#f92672">=</span> (
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0x2a</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x7e</span>, <span style="color:#ae81ff">0x54</span>, <span style="color:#ae81ff">0x82</span>, <span style="color:#ae81ff">0xa8</span>, <span style="color:#ae81ff">0xd6</span>, <span style="color:#ae81ff">0xfc</span>, <span style="color:#ae81ff">0x61</span>, <span style="color:#ae81ff">0x4b</span>, <span style="color:#ae81ff">0x35</span>, <span style="color:#ae81ff">0x1f</span>, <span style="color:#ae81ff">0xc9</span>, <span style="color:#ae81ff">0xe3</span>, <span style="color:#ae81ff">0x9d</span>, <span style="color:#ae81ff">0xb7</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0xbc</span>, <span style="color:#ae81ff">0x96</span>, <span style="color:#ae81ff">0xe8</span>, <span style="color:#ae81ff">0xc2</span>, <span style="color:#ae81ff">0x14</span>, <span style="color:#ae81ff">0x3e</span>, <span style="color:#ae81ff">0x40</span>, <span style="color:#ae81ff">0x6a</span>, <span style="color:#ae81ff">0xf7</span>, <span style="color:#ae81ff">0xdd</span>, <span style="color:#ae81ff">0xa3</span>, <span style="color:#ae81ff">0x89</span>, <span style="color:#ae81ff">0x5f</span>, <span style="color:#ae81ff">0x75</span>, <span style="color:#ae81ff">0x0b</span>, <span style="color:#ae81ff">0x21</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0x1d</span>, <span style="color:#ae81ff">0x37</span>, <span style="color:#ae81ff">0x49</span>, <span style="color:#ae81ff">0x63</span>, <span style="color:#ae81ff">0xb5</span>, <span style="color:#ae81ff">0x9f</span>, <span style="color:#ae81ff">0xe1</span>, <span style="color:#ae81ff">0xcb</span>, <span style="color:#ae81ff">0x56</span>, <span style="color:#ae81ff">0x7c</span>, <span style="color:#ae81ff">0x02</span>, <span style="color:#ae81ff">0x28</span>, <span style="color:#ae81ff">0xfe</span>, <span style="color:#ae81ff">0xd4</span>, <span style="color:#ae81ff">0xaa</span>, <span style="color:#ae81ff">0x80</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0x8b</span>, <span style="color:#ae81ff">0xa1</span>, <span style="color:#ae81ff">0xdf</span>, <span style="color:#ae81ff">0xf5</span>, <span style="color:#ae81ff">0x23</span>, <span style="color:#ae81ff">0x09</span>, <span style="color:#ae81ff">0x77</span>, <span style="color:#ae81ff">0x5d</span>, <span style="color:#ae81ff">0xc0</span>, <span style="color:#ae81ff">0xea</span>, <span style="color:#ae81ff">0x94</span>, <span style="color:#ae81ff">0xbe</span>, <span style="color:#ae81ff">0x68</span>, <span style="color:#ae81ff">0x42</span>, <span style="color:#ae81ff">0x3c</span>, <span style="color:#ae81ff">0x16</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0x44</span>, <span style="color:#ae81ff">0x6e</span>, <span style="color:#ae81ff">0x10</span>, <span style="color:#ae81ff">0x3a</span>, <span style="color:#ae81ff">0xec</span>, <span style="color:#ae81ff">0xc6</span>, <span style="color:#ae81ff">0xb8</span>, <span style="color:#ae81ff">0x92</span>, <span style="color:#ae81ff">0x0f</span>, <span style="color:#ae81ff">0x25</span>, <span style="color:#ae81ff">0x5b</span>, <span style="color:#ae81ff">0x71</span>, <span style="color:#ae81ff">0xa7</span>, <span style="color:#ae81ff">0x8d</span>, <span style="color:#ae81ff">0xf3</span>, <span style="color:#ae81ff">0xd9</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0xd2</span>, <span style="color:#ae81ff">0xf8</span>, <span style="color:#ae81ff">0x86</span>, <span style="color:#ae81ff">0xac</span>, <span style="color:#ae81ff">0x7a</span>, <span style="color:#ae81ff">0x50</span>, <span style="color:#ae81ff">0x2e</span>, <span style="color:#ae81ff">0x04</span>, <span style="color:#ae81ff">0x99</span>, <span style="color:#ae81ff">0xb3</span>, <span style="color:#ae81ff">0xcd</span>, <span style="color:#ae81ff">0xe7</span>, <span style="color:#ae81ff">0x31</span>, <span style="color:#ae81ff">0x1b</span>, <span style="color:#ae81ff">0x65</span>, <span style="color:#ae81ff">0x4f</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0x73</span>, <span style="color:#ae81ff">0x59</span>, <span style="color:#ae81ff">0x27</span>, <span style="color:#ae81ff">0x0d</span>, <span style="color:#ae81ff">0xdb</span>, <span style="color:#ae81ff">0xf1</span>, <span style="color:#ae81ff">0x8f</span>, <span style="color:#ae81ff">0xa5</span>, <span style="color:#ae81ff">0x38</span>, <span style="color:#ae81ff">0x12</span>, <span style="color:#ae81ff">0x6c</span>, <span style="color:#ae81ff">0x46</span>, <span style="color:#ae81ff">0x90</span>, <span style="color:#ae81ff">0xba</span>, <span style="color:#ae81ff">0xc4</span>, <span style="color:#ae81ff">0xee</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0xe5</span>, <span style="color:#ae81ff">0xcf</span>, <span style="color:#ae81ff">0xb1</span>, <span style="color:#ae81ff">0x9b</span>, <span style="color:#ae81ff">0x4d</span>, <span style="color:#ae81ff">0x67</span>, <span style="color:#ae81ff">0x19</span>, <span style="color:#ae81ff">0x33</span>, <span style="color:#ae81ff">0xae</span>, <span style="color:#ae81ff">0x84</span>, <span style="color:#ae81ff">0xfa</span>, <span style="color:#ae81ff">0xd0</span>, <span style="color:#ae81ff">0x06</span>, <span style="color:#ae81ff">0x2c</span>, <span style="color:#ae81ff">0x52</span>, <span style="color:#ae81ff">0x78</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0xf6</span>, <span style="color:#ae81ff">0xdc</span>, <span style="color:#ae81ff">0xa2</span>, <span style="color:#ae81ff">0x88</span>, <span style="color:#ae81ff">0x5e</span>, <span style="color:#ae81ff">0x74</span>, <span style="color:#ae81ff">0x0a</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0xbd</span>, <span style="color:#ae81ff">0x97</span>, <span style="color:#ae81ff">0xe9</span>, <span style="color:#ae81ff">0xc3</span>, <span style="color:#ae81ff">0x15</span>, <span style="color:#ae81ff">0x3f</span>, <span style="color:#ae81ff">0x41</span>, <span style="color:#ae81ff">0x6b</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0x60</span>, <span style="color:#ae81ff">0x4a</span>, <span style="color:#ae81ff">0x34</span>, <span style="color:#ae81ff">0x1e</span>, <span style="color:#ae81ff">0xc8</span>, <span style="color:#ae81ff">0xe2</span>, <span style="color:#ae81ff">0x9c</span>, <span style="color:#ae81ff">0xb6</span>, <span style="color:#ae81ff">0x2b</span>, <span style="color:#ae81ff">0x01</span>, <span style="color:#ae81ff">0x7f</span>, <span style="color:#ae81ff">0x55</span>, <span style="color:#ae81ff">0x83</span>, <span style="color:#ae81ff">0xa9</span>, <span style="color:#ae81ff">0xd7</span>, <span style="color:#ae81ff">0xfd</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0xc1</span>, <span style="color:#ae81ff">0xeb</span>, <span style="color:#ae81ff">0x95</span>, <span style="color:#ae81ff">0xbf</span>, <span style="color:#ae81ff">0x69</span>, <span style="color:#ae81ff">0x43</span>, <span style="color:#ae81ff">0x3d</span>, <span style="color:#ae81ff">0x17</span>, <span style="color:#ae81ff">0x8a</span>, <span style="color:#ae81ff">0xa0</span>, <span style="color:#ae81ff">0xde</span>, <span style="color:#ae81ff">0xf4</span>, <span style="color:#ae81ff">0x22</span>, <span style="color:#ae81ff">0x08</span>, <span style="color:#ae81ff">0x76</span>, <span style="color:#ae81ff">0x5c</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0x57</span>, <span style="color:#ae81ff">0x7d</span>, <span style="color:#ae81ff">0x03</span>, <span style="color:#ae81ff">0x29</span>, <span style="color:#ae81ff">0xff</span>, <span style="color:#ae81ff">0xd5</span>, <span style="color:#ae81ff">0xab</span>, <span style="color:#ae81ff">0x81</span>, <span style="color:#ae81ff">0x1c</span>, <span style="color:#ae81ff">0x36</span>, <span style="color:#ae81ff">0x48</span>, <span style="color:#ae81ff">0x62</span>, <span style="color:#ae81ff">0xb4</span>, <span style="color:#ae81ff">0x9e</span>, <span style="color:#ae81ff">0xe0</span>, <span style="color:#ae81ff">0xca</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0x98</span>, <span style="color:#ae81ff">0xb2</span>, <span style="color:#ae81ff">0xcc</span>, <span style="color:#ae81ff">0xe6</span>, <span style="color:#ae81ff">0x30</span>, <span style="color:#ae81ff">0x1a</span>, <span style="color:#ae81ff">0x64</span>, <span style="color:#ae81ff">0x4e</span>, <span style="color:#ae81ff">0xd3</span>, <span style="color:#ae81ff">0xf9</span>, <span style="color:#ae81ff">0x87</span>, <span style="color:#ae81ff">0xad</span>, <span style="color:#ae81ff">0x7b</span>, <span style="color:#ae81ff">0x51</span>, <span style="color:#ae81ff">0x2f</span>, <span style="color:#ae81ff">0x05</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0x0e</span>, <span style="color:#ae81ff">0x24</span>, <span style="color:#ae81ff">0x5a</span>, <span style="color:#ae81ff">0x70</span>, <span style="color:#ae81ff">0xa6</span>, <span style="color:#ae81ff">0x8c</span>, <span style="color:#ae81ff">0xf2</span>, <span style="color:#ae81ff">0xd8</span>, <span style="color:#ae81ff">0x45</span>, <span style="color:#ae81ff">0x6f</span>, <span style="color:#ae81ff">0x11</span>, <span style="color:#ae81ff">0x3b</span>, <span style="color:#ae81ff">0xed</span>, <span style="color:#ae81ff">0xc7</span>, <span style="color:#ae81ff">0xb9</span>, <span style="color:#ae81ff">0x93</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0xaf</span>, <span style="color:#ae81ff">0x85</span>, <span style="color:#ae81ff">0xfb</span>, <span style="color:#ae81ff">0xd1</span>, <span style="color:#ae81ff">0x07</span>, <span style="color:#ae81ff">0x2d</span>, <span style="color:#ae81ff">0x53</span>, <span style="color:#ae81ff">0x79</span>, <span style="color:#ae81ff">0xe4</span>, <span style="color:#ae81ff">0xce</span>, <span style="color:#ae81ff">0xb0</span>, <span style="color:#ae81ff">0x9a</span>, <span style="color:#ae81ff">0x4c</span>, <span style="color:#ae81ff">0x66</span>, <span style="color:#ae81ff">0x18</span>, <span style="color:#ae81ff">0x32</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0x39</span>, <span style="color:#ae81ff">0x13</span>, <span style="color:#ae81ff">0x6d</span>, <span style="color:#ae81ff">0x47</span>, <span style="color:#ae81ff">0x91</span>, <span style="color:#ae81ff">0xbb</span>, <span style="color:#ae81ff">0xc5</span>, <span style="color:#ae81ff">0xef</span>, <span style="color:#ae81ff">0x72</span>, <span style="color:#ae81ff">0x58</span>, <span style="color:#ae81ff">0x26</span>, <span style="color:#ae81ff">0x0c</span>, <span style="color:#ae81ff">0xda</span>, <span style="color:#ae81ff">0xf0</span>, <span style="color:#ae81ff">0x8e</span>, <span style="color:#ae81ff">0xa4</span>
</span></span><span style="display:flex;"><span>    )
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    rcon <span style="color:#f92672">=</span> (<span style="color:#ae81ff">0x8d</span>, <span style="color:#ae81ff">0x01</span>, <span style="color:#ae81ff">0x02</span>, <span style="color:#ae81ff">0x04</span>, <span style="color:#ae81ff">0x08</span>, <span style="color:#ae81ff">0x10</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x40</span>, <span style="color:#ae81ff">0x80</span>, <span style="color:#ae81ff">0x1b</span>, <span style="color:#ae81ff">0x36</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    gmul2 <span style="color:#f92672">=</span> (
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x02</span>, <span style="color:#ae81ff">0x04</span>, <span style="color:#ae81ff">0x06</span>, <span style="color:#ae81ff">0x08</span>, <span style="color:#ae81ff">0x0a</span>, <span style="color:#ae81ff">0x0c</span>, <span style="color:#ae81ff">0x0e</span>, <span style="color:#ae81ff">0x10</span>, <span style="color:#ae81ff">0x12</span>, <span style="color:#ae81ff">0x14</span>, <span style="color:#ae81ff">0x16</span>, <span style="color:#ae81ff">0x18</span>, <span style="color:#ae81ff">0x1a</span>, <span style="color:#ae81ff">0x1c</span>, <span style="color:#ae81ff">0x1e</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x22</span>, <span style="color:#ae81ff">0x24</span>, <span style="color:#ae81ff">0x26</span>, <span style="color:#ae81ff">0x28</span>, <span style="color:#ae81ff">0x2a</span>, <span style="color:#ae81ff">0x2c</span>, <span style="color:#ae81ff">0x2e</span>, <span style="color:#ae81ff">0x30</span>, <span style="color:#ae81ff">0x32</span>, <span style="color:#ae81ff">0x34</span>, <span style="color:#ae81ff">0x36</span>, <span style="color:#ae81ff">0x38</span>, <span style="color:#ae81ff">0x3a</span>, <span style="color:#ae81ff">0x3c</span>, <span style="color:#ae81ff">0x3e</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0x40</span>, <span style="color:#ae81ff">0x42</span>, <span style="color:#ae81ff">0x44</span>, <span style="color:#ae81ff">0x46</span>, <span style="color:#ae81ff">0x48</span>, <span style="color:#ae81ff">0x4a</span>, <span style="color:#ae81ff">0x4c</span>, <span style="color:#ae81ff">0x4e</span>, <span style="color:#ae81ff">0x50</span>, <span style="color:#ae81ff">0x52</span>, <span style="color:#ae81ff">0x54</span>, <span style="color:#ae81ff">0x56</span>, <span style="color:#ae81ff">0x58</span>, <span style="color:#ae81ff">0x5a</span>, <span style="color:#ae81ff">0x5c</span>, <span style="color:#ae81ff">0x5e</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0x60</span>, <span style="color:#ae81ff">0x62</span>, <span style="color:#ae81ff">0x64</span>, <span style="color:#ae81ff">0x66</span>, <span style="color:#ae81ff">0x68</span>, <span style="color:#ae81ff">0x6a</span>, <span style="color:#ae81ff">0x6c</span>, <span style="color:#ae81ff">0x6e</span>, <span style="color:#ae81ff">0x70</span>, <span style="color:#ae81ff">0x72</span>, <span style="color:#ae81ff">0x74</span>, <span style="color:#ae81ff">0x76</span>, <span style="color:#ae81ff">0x78</span>, <span style="color:#ae81ff">0x7a</span>, <span style="color:#ae81ff">0x7c</span>, <span style="color:#ae81ff">0x7e</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0x80</span>, <span style="color:#ae81ff">0x82</span>, <span style="color:#ae81ff">0x84</span>, <span style="color:#ae81ff">0x86</span>, <span style="color:#ae81ff">0x88</span>, <span style="color:#ae81ff">0x8a</span>, <span style="color:#ae81ff">0x8c</span>, <span style="color:#ae81ff">0x8e</span>, <span style="color:#ae81ff">0x90</span>, <span style="color:#ae81ff">0x92</span>, <span style="color:#ae81ff">0x94</span>, <span style="color:#ae81ff">0x96</span>, <span style="color:#ae81ff">0x98</span>, <span style="color:#ae81ff">0x9a</span>, <span style="color:#ae81ff">0x9c</span>, <span style="color:#ae81ff">0x9e</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0xa0</span>, <span style="color:#ae81ff">0xa2</span>, <span style="color:#ae81ff">0xa4</span>, <span style="color:#ae81ff">0xa6</span>, <span style="color:#ae81ff">0xa8</span>, <span style="color:#ae81ff">0xaa</span>, <span style="color:#ae81ff">0xac</span>, <span style="color:#ae81ff">0xae</span>, <span style="color:#ae81ff">0xb0</span>, <span style="color:#ae81ff">0xb2</span>, <span style="color:#ae81ff">0xb4</span>, <span style="color:#ae81ff">0xb6</span>, <span style="color:#ae81ff">0xb8</span>, <span style="color:#ae81ff">0xba</span>, <span style="color:#ae81ff">0xbc</span>, <span style="color:#ae81ff">0xbe</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0xc0</span>, <span style="color:#ae81ff">0xc2</span>, <span style="color:#ae81ff">0xc4</span>, <span style="color:#ae81ff">0xc6</span>, <span style="color:#ae81ff">0xc8</span>, <span style="color:#ae81ff">0xca</span>, <span style="color:#ae81ff">0xcc</span>, <span style="color:#ae81ff">0xce</span>, <span style="color:#ae81ff">0xd0</span>, <span style="color:#ae81ff">0xd2</span>, <span style="color:#ae81ff">0xd4</span>, <span style="color:#ae81ff">0xd6</span>, <span style="color:#ae81ff">0xd8</span>, <span style="color:#ae81ff">0xda</span>, <span style="color:#ae81ff">0xdc</span>, <span style="color:#ae81ff">0xde</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0xe0</span>, <span style="color:#ae81ff">0xe2</span>, <span style="color:#ae81ff">0xe4</span>, <span style="color:#ae81ff">0xe6</span>, <span style="color:#ae81ff">0xe8</span>, <span style="color:#ae81ff">0xea</span>, <span style="color:#ae81ff">0xec</span>, <span style="color:#ae81ff">0xee</span>, <span style="color:#ae81ff">0xf0</span>, <span style="color:#ae81ff">0xf2</span>, <span style="color:#ae81ff">0xf4</span>, <span style="color:#ae81ff">0xf6</span>, <span style="color:#ae81ff">0xf8</span>, <span style="color:#ae81ff">0xfa</span>, <span style="color:#ae81ff">0xfc</span>, <span style="color:#ae81ff">0xfe</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0x1b</span>, <span style="color:#ae81ff">0x19</span>, <span style="color:#ae81ff">0x1f</span>, <span style="color:#ae81ff">0x1d</span>, <span style="color:#ae81ff">0x13</span>, <span style="color:#ae81ff">0x11</span>, <span style="color:#ae81ff">0x17</span>, <span style="color:#ae81ff">0x15</span>, <span style="color:#ae81ff">0x0b</span>, <span style="color:#ae81ff">0x09</span>, <span style="color:#ae81ff">0x0f</span>, <span style="color:#ae81ff">0x0d</span>, <span style="color:#ae81ff">0x03</span>, <span style="color:#ae81ff">0x01</span>, <span style="color:#ae81ff">0x07</span>, <span style="color:#ae81ff">0x05</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0x3b</span>, <span style="color:#ae81ff">0x39</span>, <span style="color:#ae81ff">0x3f</span>, <span style="color:#ae81ff">0x3d</span>, <span style="color:#ae81ff">0x33</span>, <span style="color:#ae81ff">0x31</span>, <span style="color:#ae81ff">0x37</span>, <span style="color:#ae81ff">0x35</span>, <span style="color:#ae81ff">0x2b</span>, <span style="color:#ae81ff">0x29</span>, <span style="color:#ae81ff">0x2f</span>, <span style="color:#ae81ff">0x2d</span>, <span style="color:#ae81ff">0x23</span>, <span style="color:#ae81ff">0x21</span>, <span style="color:#ae81ff">0x27</span>, <span style="color:#ae81ff">0x25</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0x5b</span>, <span style="color:#ae81ff">0x59</span>, <span style="color:#ae81ff">0x5f</span>, <span style="color:#ae81ff">0x5d</span>, <span style="color:#ae81ff">0x53</span>, <span style="color:#ae81ff">0x51</span>, <span style="color:#ae81ff">0x57</span>, <span style="color:#ae81ff">0x55</span>, <span style="color:#ae81ff">0x4b</span>, <span style="color:#ae81ff">0x49</span>, <span style="color:#ae81ff">0x4f</span>, <span style="color:#ae81ff">0x4d</span>, <span style="color:#ae81ff">0x43</span>, <span style="color:#ae81ff">0x41</span>, <span style="color:#ae81ff">0x47</span>, <span style="color:#ae81ff">0x45</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0x7b</span>, <span style="color:#ae81ff">0x79</span>, <span style="color:#ae81ff">0x7f</span>, <span style="color:#ae81ff">0x7d</span>, <span style="color:#ae81ff">0x73</span>, <span style="color:#ae81ff">0x71</span>, <span style="color:#ae81ff">0x77</span>, <span style="color:#ae81ff">0x75</span>, <span style="color:#ae81ff">0x6b</span>, <span style="color:#ae81ff">0x69</span>, <span style="color:#ae81ff">0x6f</span>, <span style="color:#ae81ff">0x6d</span>, <span style="color:#ae81ff">0x63</span>, <span style="color:#ae81ff">0x61</span>, <span style="color:#ae81ff">0x67</span>, <span style="color:#ae81ff">0x65</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0x9b</span>, <span style="color:#ae81ff">0x99</span>, <span style="color:#ae81ff">0x9f</span>, <span style="color:#ae81ff">0x9d</span>, <span style="color:#ae81ff">0x93</span>, <span style="color:#ae81ff">0x91</span>, <span style="color:#ae81ff">0x97</span>, <span style="color:#ae81ff">0x95</span>, <span style="color:#ae81ff">0x8b</span>, <span style="color:#ae81ff">0x89</span>, <span style="color:#ae81ff">0x8f</span>, <span style="color:#ae81ff">0x8d</span>, <span style="color:#ae81ff">0x83</span>, <span style="color:#ae81ff">0x81</span>, <span style="color:#ae81ff">0x87</span>, <span style="color:#ae81ff">0x85</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0xbb</span>, <span style="color:#ae81ff">0xb9</span>, <span style="color:#ae81ff">0xbf</span>, <span style="color:#ae81ff">0xbd</span>, <span style="color:#ae81ff">0xb3</span>, <span style="color:#ae81ff">0xb1</span>, <span style="color:#ae81ff">0xb7</span>, <span style="color:#ae81ff">0xb5</span>, <span style="color:#ae81ff">0xab</span>, <span style="color:#ae81ff">0xa9</span>, <span style="color:#ae81ff">0xaf</span>, <span style="color:#ae81ff">0xad</span>, <span style="color:#ae81ff">0xa3</span>, <span style="color:#ae81ff">0xa1</span>, <span style="color:#ae81ff">0xa7</span>, <span style="color:#ae81ff">0xa5</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0xdb</span>, <span style="color:#ae81ff">0xd9</span>, <span style="color:#ae81ff">0xdf</span>, <span style="color:#ae81ff">0xdd</span>, <span style="color:#ae81ff">0xd3</span>, <span style="color:#ae81ff">0xd1</span>, <span style="color:#ae81ff">0xd7</span>, <span style="color:#ae81ff">0xd5</span>, <span style="color:#ae81ff">0xcb</span>, <span style="color:#ae81ff">0xc9</span>, <span style="color:#ae81ff">0xcf</span>, <span style="color:#ae81ff">0xcd</span>, <span style="color:#ae81ff">0xc3</span>, <span style="color:#ae81ff">0xc1</span>, <span style="color:#ae81ff">0xc7</span>, <span style="color:#ae81ff">0xc5</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0xfb</span>, <span style="color:#ae81ff">0xf9</span>, <span style="color:#ae81ff">0xff</span>, <span style="color:#ae81ff">0xfd</span>, <span style="color:#ae81ff">0xf3</span>, <span style="color:#ae81ff">0xf1</span>, <span style="color:#ae81ff">0xf7</span>, <span style="color:#ae81ff">0xf5</span>, <span style="color:#ae81ff">0xeb</span>, <span style="color:#ae81ff">0xe9</span>, <span style="color:#ae81ff">0xef</span>, <span style="color:#ae81ff">0xed</span>, <span style="color:#ae81ff">0xe3</span>, <span style="color:#ae81ff">0xe1</span>, <span style="color:#ae81ff">0xe7</span>, <span style="color:#ae81ff">0xe5</span>
</span></span><span style="display:flex;"><span>    )
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    gmul3 <span style="color:#f92672">=</span> (
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x03</span>, <span style="color:#ae81ff">0x06</span>, <span style="color:#ae81ff">0x05</span>, <span style="color:#ae81ff">0x0c</span>, <span style="color:#ae81ff">0x0f</span>, <span style="color:#ae81ff">0x0a</span>, <span style="color:#ae81ff">0x09</span>, <span style="color:#ae81ff">0x18</span>, <span style="color:#ae81ff">0x1b</span>, <span style="color:#ae81ff">0x1e</span>, <span style="color:#ae81ff">0x1d</span>, <span style="color:#ae81ff">0x14</span>, <span style="color:#ae81ff">0x17</span>, <span style="color:#ae81ff">0x12</span>, <span style="color:#ae81ff">0x11</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0x30</span>, <span style="color:#ae81ff">0x33</span>, <span style="color:#ae81ff">0x36</span>, <span style="color:#ae81ff">0x35</span>, <span style="color:#ae81ff">0x3c</span>, <span style="color:#ae81ff">0x3f</span>, <span style="color:#ae81ff">0x3a</span>, <span style="color:#ae81ff">0x39</span>, <span style="color:#ae81ff">0x28</span>, <span style="color:#ae81ff">0x2b</span>, <span style="color:#ae81ff">0x2e</span>, <span style="color:#ae81ff">0x2d</span>, <span style="color:#ae81ff">0x24</span>, <span style="color:#ae81ff">0x27</span>, <span style="color:#ae81ff">0x22</span>, <span style="color:#ae81ff">0x21</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0x60</span>, <span style="color:#ae81ff">0x63</span>, <span style="color:#ae81ff">0x66</span>, <span style="color:#ae81ff">0x65</span>, <span style="color:#ae81ff">0x6c</span>, <span style="color:#ae81ff">0x6f</span>, <span style="color:#ae81ff">0x6a</span>, <span style="color:#ae81ff">0x69</span>, <span style="color:#ae81ff">0x78</span>, <span style="color:#ae81ff">0x7b</span>, <span style="color:#ae81ff">0x7e</span>, <span style="color:#ae81ff">0x7d</span>, <span style="color:#ae81ff">0x74</span>, <span style="color:#ae81ff">0x77</span>, <span style="color:#ae81ff">0x72</span>, <span style="color:#ae81ff">0x71</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0x50</span>, <span style="color:#ae81ff">0x53</span>, <span style="color:#ae81ff">0x56</span>, <span style="color:#ae81ff">0x55</span>, <span style="color:#ae81ff">0x5c</span>, <span style="color:#ae81ff">0x5f</span>, <span style="color:#ae81ff">0x5a</span>, <span style="color:#ae81ff">0x59</span>, <span style="color:#ae81ff">0x48</span>, <span style="color:#ae81ff">0x4b</span>, <span style="color:#ae81ff">0x4e</span>, <span style="color:#ae81ff">0x4d</span>, <span style="color:#ae81ff">0x44</span>, <span style="color:#ae81ff">0x47</span>, <span style="color:#ae81ff">0x42</span>, <span style="color:#ae81ff">0x41</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0xc0</span>, <span style="color:#ae81ff">0xc3</span>, <span style="color:#ae81ff">0xc6</span>, <span style="color:#ae81ff">0xc5</span>, <span style="color:#ae81ff">0xcc</span>, <span style="color:#ae81ff">0xcf</span>, <span style="color:#ae81ff">0xca</span>, <span style="color:#ae81ff">0xc9</span>, <span style="color:#ae81ff">0xd8</span>, <span style="color:#ae81ff">0xdb</span>, <span style="color:#ae81ff">0xde</span>, <span style="color:#ae81ff">0xdd</span>, <span style="color:#ae81ff">0xd4</span>, <span style="color:#ae81ff">0xd7</span>, <span style="color:#ae81ff">0xd2</span>, <span style="color:#ae81ff">0xd1</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0xf0</span>, <span style="color:#ae81ff">0xf3</span>, <span style="color:#ae81ff">0xf6</span>, <span style="color:#ae81ff">0xf5</span>, <span style="color:#ae81ff">0xfc</span>, <span style="color:#ae81ff">0xff</span>, <span style="color:#ae81ff">0xfa</span>, <span style="color:#ae81ff">0xf9</span>, <span style="color:#ae81ff">0xe8</span>, <span style="color:#ae81ff">0xeb</span>, <span style="color:#ae81ff">0xee</span>, <span style="color:#ae81ff">0xed</span>, <span style="color:#ae81ff">0xe4</span>, <span style="color:#ae81ff">0xe7</span>, <span style="color:#ae81ff">0xe2</span>, <span style="color:#ae81ff">0xe1</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0xa0</span>, <span style="color:#ae81ff">0xa3</span>, <span style="color:#ae81ff">0xa6</span>, <span style="color:#ae81ff">0xa5</span>, <span style="color:#ae81ff">0xac</span>, <span style="color:#ae81ff">0xaf</span>, <span style="color:#ae81ff">0xaa</span>, <span style="color:#ae81ff">0xa9</span>, <span style="color:#ae81ff">0xb8</span>, <span style="color:#ae81ff">0xbb</span>, <span style="color:#ae81ff">0xbe</span>, <span style="color:#ae81ff">0xbd</span>, <span style="color:#ae81ff">0xb4</span>, <span style="color:#ae81ff">0xb7</span>, <span style="color:#ae81ff">0xb2</span>, <span style="color:#ae81ff">0xb1</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0x90</span>, <span style="color:#ae81ff">0x93</span>, <span style="color:#ae81ff">0x96</span>, <span style="color:#ae81ff">0x95</span>, <span style="color:#ae81ff">0x9c</span>, <span style="color:#ae81ff">0x9f</span>, <span style="color:#ae81ff">0x9a</span>, <span style="color:#ae81ff">0x99</span>, <span style="color:#ae81ff">0x88</span>, <span style="color:#ae81ff">0x8b</span>, <span style="color:#ae81ff">0x8e</span>, <span style="color:#ae81ff">0x8d</span>, <span style="color:#ae81ff">0x84</span>, <span style="color:#ae81ff">0x87</span>, <span style="color:#ae81ff">0x82</span>, <span style="color:#ae81ff">0x81</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0x9b</span>, <span style="color:#ae81ff">0x98</span>, <span style="color:#ae81ff">0x9d</span>, <span style="color:#ae81ff">0x9e</span>, <span style="color:#ae81ff">0x97</span>, <span style="color:#ae81ff">0x94</span>, <span style="color:#ae81ff">0x91</span>, <span style="color:#ae81ff">0x92</span>, <span style="color:#ae81ff">0x83</span>, <span style="color:#ae81ff">0x80</span>, <span style="color:#ae81ff">0x85</span>, <span style="color:#ae81ff">0x86</span>, <span style="color:#ae81ff">0x8f</span>, <span style="color:#ae81ff">0x8c</span>, <span style="color:#ae81ff">0x89</span>, <span style="color:#ae81ff">0x8a</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0xab</span>, <span style="color:#ae81ff">0xa8</span>, <span style="color:#ae81ff">0xad</span>, <span style="color:#ae81ff">0xae</span>, <span style="color:#ae81ff">0xa7</span>, <span style="color:#ae81ff">0xa4</span>, <span style="color:#ae81ff">0xa1</span>, <span style="color:#ae81ff">0xa2</span>, <span style="color:#ae81ff">0xb3</span>, <span style="color:#ae81ff">0xb0</span>, <span style="color:#ae81ff">0xb5</span>, <span style="color:#ae81ff">0xb6</span>, <span style="color:#ae81ff">0xbf</span>, <span style="color:#ae81ff">0xbc</span>, <span style="color:#ae81ff">0xb9</span>, <span style="color:#ae81ff">0xba</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0xfb</span>, <span style="color:#ae81ff">0xf8</span>, <span style="color:#ae81ff">0xfd</span>, <span style="color:#ae81ff">0xfe</span>, <span style="color:#ae81ff">0xf7</span>, <span style="color:#ae81ff">0xf4</span>, <span style="color:#ae81ff">0xf1</span>, <span style="color:#ae81ff">0xf2</span>, <span style="color:#ae81ff">0xe3</span>, <span style="color:#ae81ff">0xe0</span>, <span style="color:#ae81ff">0xe5</span>, <span style="color:#ae81ff">0xe6</span>, <span style="color:#ae81ff">0xef</span>, <span style="color:#ae81ff">0xec</span>, <span style="color:#ae81ff">0xe9</span>, <span style="color:#ae81ff">0xea</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0xcb</span>, <span style="color:#ae81ff">0xc8</span>, <span style="color:#ae81ff">0xcd</span>, <span style="color:#ae81ff">0xce</span>, <span style="color:#ae81ff">0xc7</span>, <span style="color:#ae81ff">0xc4</span>, <span style="color:#ae81ff">0xc1</span>, <span style="color:#ae81ff">0xc2</span>, <span style="color:#ae81ff">0xd3</span>, <span style="color:#ae81ff">0xd0</span>, <span style="color:#ae81ff">0xd5</span>, <span style="color:#ae81ff">0xd6</span>, <span style="color:#ae81ff">0xdf</span>, <span style="color:#ae81ff">0xdc</span>, <span style="color:#ae81ff">0xd9</span>, <span style="color:#ae81ff">0xda</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0x5b</span>, <span style="color:#ae81ff">0x58</span>, <span style="color:#ae81ff">0x5d</span>, <span style="color:#ae81ff">0x5e</span>, <span style="color:#ae81ff">0x57</span>, <span style="color:#ae81ff">0x54</span>, <span style="color:#ae81ff">0x51</span>, <span style="color:#ae81ff">0x52</span>, <span style="color:#ae81ff">0x43</span>, <span style="color:#ae81ff">0x40</span>, <span style="color:#ae81ff">0x45</span>, <span style="color:#ae81ff">0x46</span>, <span style="color:#ae81ff">0x4f</span>, <span style="color:#ae81ff">0x4c</span>, <span style="color:#ae81ff">0x49</span>, <span style="color:#ae81ff">0x4a</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0x6b</span>, <span style="color:#ae81ff">0x68</span>, <span style="color:#ae81ff">0x6d</span>, <span style="color:#ae81ff">0x6e</span>, <span style="color:#ae81ff">0x67</span>, <span style="color:#ae81ff">0x64</span>, <span style="color:#ae81ff">0x61</span>, <span style="color:#ae81ff">0x62</span>, <span style="color:#ae81ff">0x73</span>, <span style="color:#ae81ff">0x70</span>, <span style="color:#ae81ff">0x75</span>, <span style="color:#ae81ff">0x76</span>, <span style="color:#ae81ff">0x7f</span>, <span style="color:#ae81ff">0x7c</span>, <span style="color:#ae81ff">0x79</span>, <span style="color:#ae81ff">0x7a</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0x3b</span>, <span style="color:#ae81ff">0x38</span>, <span style="color:#ae81ff">0x3d</span>, <span style="color:#ae81ff">0x3e</span>, <span style="color:#ae81ff">0x37</span>, <span style="color:#ae81ff">0x34</span>, <span style="color:#ae81ff">0x31</span>, <span style="color:#ae81ff">0x32</span>, <span style="color:#ae81ff">0x23</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x25</span>, <span style="color:#ae81ff">0x26</span>, <span style="color:#ae81ff">0x2f</span>, <span style="color:#ae81ff">0x2c</span>, <span style="color:#ae81ff">0x29</span>, <span style="color:#ae81ff">0x2a</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0x0b</span>, <span style="color:#ae81ff">0x08</span>, <span style="color:#ae81ff">0x0d</span>, <span style="color:#ae81ff">0x0e</span>, <span style="color:#ae81ff">0x07</span>, <span style="color:#ae81ff">0x04</span>, <span style="color:#ae81ff">0x01</span>, <span style="color:#ae81ff">0x02</span>, <span style="color:#ae81ff">0x13</span>, <span style="color:#ae81ff">0x10</span>, <span style="color:#ae81ff">0x15</span>, <span style="color:#ae81ff">0x16</span>, <span style="color:#ae81ff">0x1f</span>, <span style="color:#ae81ff">0x1c</span>, <span style="color:#ae81ff">0x19</span>, <span style="color:#ae81ff">0x1a</span>
</span></span><span style="display:flex;"><span>    )
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> __init__(self, key):
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>_block_size <span style="color:#f92672">=</span> <span style="color:#ae81ff">16</span>
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>_round_keys <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>_expand_key([i <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> key])
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>_state <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">_transpose</span>(self, m):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> [m[<span style="color:#ae81ff">4</span> <span style="color:#f92672">*</span> j <span style="color:#f92672">+</span> i] <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">4</span>) <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">4</span>)]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">_xor</span>(self, a, b):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> [x <span style="color:#f92672">^</span> y <span style="color:#66d9ef">for</span> x, y <span style="color:#f92672">in</span> zip(a, b)]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">_expand_key</span>(self, key):
</span></span><span style="display:flex;"><span>        round_keys <span style="color:#f92672">=</span> [key]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">10</span>):
</span></span><span style="display:flex;"><span>            round_key <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>            first <span style="color:#f92672">=</span> round_keys[i][:<span style="color:#ae81ff">4</span>]
</span></span><span style="display:flex;"><span>            last <span style="color:#f92672">=</span> round_keys[i][<span style="color:#f92672">-</span><span style="color:#ae81ff">4</span>:]
</span></span><span style="display:flex;"><span>            last <span style="color:#f92672">=</span> last[<span style="color:#ae81ff">1</span>:] <span style="color:#f92672">+</span> [last[<span style="color:#ae81ff">0</span>]]
</span></span><span style="display:flex;"><span>            last <span style="color:#f92672">=</span> [self<span style="color:#f92672">.</span>sbox[i] <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> last]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            round_key<span style="color:#f92672">.</span>extend(self<span style="color:#f92672">.</span>_xor(self<span style="color:#f92672">.</span>_xor(first, last), [self<span style="color:#f92672">.</span>rcon[i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>], <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>]))
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">4</span>):
</span></span><span style="display:flex;"><span>                round_key<span style="color:#f92672">.</span>extend(self<span style="color:#f92672">.</span>_xor(round_key[j:j <span style="color:#f92672">+</span> <span style="color:#ae81ff">4</span>], round_keys[i][j <span style="color:#f92672">+</span> <span style="color:#ae81ff">4</span>:j <span style="color:#f92672">+</span> <span style="color:#ae81ff">8</span>]))
</span></span><span style="display:flex;"><span>            round_keys<span style="color:#f92672">.</span>append(round_key)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(len(round_keys)):
</span></span><span style="display:flex;"><span>            round_keys[i] <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>_transpose(round_keys[i])
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> round_keys
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">_add_round_key</span>(self, i):
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>_state <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>_xor(self<span style="color:#f92672">.</span>_round_keys[i], self<span style="color:#f92672">.</span>_state)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">_mix_columns</span>(self):
</span></span><span style="display:flex;"><span>        s <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0</span>] <span style="color:#f92672">*</span> self<span style="color:#f92672">.</span>_block_size
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">4</span>):
</span></span><span style="display:flex;"><span>            s[i] <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>gmul2[self<span style="color:#f92672">.</span>_state[i]] <span style="color:#f92672">^</span> self<span style="color:#f92672">.</span>gmul3[self<span style="color:#f92672">.</span>_state[i <span style="color:#f92672">+</span> <span style="color:#ae81ff">4</span>]] <span style="color:#f92672">^</span> self<span style="color:#f92672">.</span>_state[i <span style="color:#f92672">+</span> <span style="color:#ae81ff">8</span>] <span style="color:#f92672">^</span> self<span style="color:#f92672">.</span>_state[i <span style="color:#f92672">+</span> <span style="color:#ae81ff">12</span>]
</span></span><span style="display:flex;"><span>            s[i <span style="color:#f92672">+</span> <span style="color:#ae81ff">4</span>] <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>_state[i] <span style="color:#f92672">^</span> self<span style="color:#f92672">.</span>gmul2[self<span style="color:#f92672">.</span>_state[i <span style="color:#f92672">+</span> <span style="color:#ae81ff">4</span>]] <span style="color:#f92672">^</span> self<span style="color:#f92672">.</span>gmul3[self<span style="color:#f92672">.</span>_state[i <span style="color:#f92672">+</span> <span style="color:#ae81ff">8</span>]] <span style="color:#f92672">^</span> self<span style="color:#f92672">.</span>_state[i <span style="color:#f92672">+</span> <span style="color:#ae81ff">12</span>]
</span></span><span style="display:flex;"><span>            s[i <span style="color:#f92672">+</span> <span style="color:#ae81ff">8</span>] <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>_state[i] <span style="color:#f92672">^</span> self<span style="color:#f92672">.</span>_state[i <span style="color:#f92672">+</span> <span style="color:#ae81ff">4</span>] <span style="color:#f92672">^</span> self<span style="color:#f92672">.</span>gmul2[self<span style="color:#f92672">.</span>_state[i <span style="color:#f92672">+</span> <span style="color:#ae81ff">8</span>]] <span style="color:#f92672">^</span> self<span style="color:#f92672">.</span>gmul3[self<span style="color:#f92672">.</span>_state[i <span style="color:#f92672">+</span> <span style="color:#ae81ff">12</span>]]
</span></span><span style="display:flex;"><span>            s[i <span style="color:#f92672">+</span> <span style="color:#ae81ff">12</span>] <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>gmul3[self<span style="color:#f92672">.</span>_state[i]] <span style="color:#f92672">^</span> self<span style="color:#f92672">.</span>_state[i <span style="color:#f92672">+</span> <span style="color:#ae81ff">4</span>] <span style="color:#f92672">^</span> self<span style="color:#f92672">.</span>_state[i <span style="color:#f92672">+</span> <span style="color:#ae81ff">8</span>] <span style="color:#f92672">^</span> self<span style="color:#f92672">.</span>gmul2[self<span style="color:#f92672">.</span>_state[i <span style="color:#f92672">+</span> <span style="color:#ae81ff">12</span>]]
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>_state <span style="color:#f92672">=</span> s
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">_shift_rows</span>(self):
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>_state <span style="color:#f92672">=</span> [
</span></span><span style="display:flex;"><span>            self<span style="color:#f92672">.</span>_state[<span style="color:#ae81ff">0</span>], self<span style="color:#f92672">.</span>_state[<span style="color:#ae81ff">1</span>], self<span style="color:#f92672">.</span>_state[<span style="color:#ae81ff">2</span>], self<span style="color:#f92672">.</span>_state[<span style="color:#ae81ff">3</span>],
</span></span><span style="display:flex;"><span>            self<span style="color:#f92672">.</span>_state[<span style="color:#ae81ff">5</span>], self<span style="color:#f92672">.</span>_state[<span style="color:#ae81ff">6</span>], self<span style="color:#f92672">.</span>_state[<span style="color:#ae81ff">7</span>], self<span style="color:#f92672">.</span>_state[<span style="color:#ae81ff">4</span>],
</span></span><span style="display:flex;"><span>            self<span style="color:#f92672">.</span>_state[<span style="color:#ae81ff">10</span>], self<span style="color:#f92672">.</span>_state[<span style="color:#ae81ff">11</span>], self<span style="color:#f92672">.</span>_state[<span style="color:#ae81ff">8</span>], self<span style="color:#f92672">.</span>_state[<span style="color:#ae81ff">9</span>],
</span></span><span style="display:flex;"><span>            self<span style="color:#f92672">.</span>_state[<span style="color:#ae81ff">15</span>], self<span style="color:#f92672">.</span>_state[<span style="color:#ae81ff">12</span>], self<span style="color:#f92672">.</span>_state[<span style="color:#ae81ff">13</span>], self<span style="color:#f92672">.</span>_state[<span style="color:#ae81ff">14</span>]
</span></span><span style="display:flex;"><span>        ]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">_sub_bytes</span>(self):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">pass</span> <span style="color:#75715e"># self._state = [self.sbox[i] for i in self._state]</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">_encrypt_block</span>(self):
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>_add_round_key(<span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">10</span>):
</span></span><span style="display:flex;"><span>            self<span style="color:#f92672">.</span>_sub_bytes()
</span></span><span style="display:flex;"><span>            self<span style="color:#f92672">.</span>_shift_rows()
</span></span><span style="display:flex;"><span>            self<span style="color:#f92672">.</span>_mix_columns()
</span></span><span style="display:flex;"><span>            self<span style="color:#f92672">.</span>_add_round_key(i)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>_sub_bytes()
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>_shift_rows()
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>_add_round_key(<span style="color:#ae81ff">10</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">encrypt</span>(self, plaintext):
</span></span><span style="display:flex;"><span>        ciphertext <span style="color:#f92672">=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>_state <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>_transpose([c <span style="color:#66d9ef">for</span> c <span style="color:#f92672">in</span> plaintext])
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>_encrypt_block()
</span></span><span style="display:flex;"><span>        ciphertext <span style="color:#f92672">+=</span> bytes(bytearray(self<span style="color:#f92672">.</span>_transpose(self<span style="color:#f92672">.</span>_state)))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> ciphertext</span></span></code></pre></div>
    
</div>
<p>If we use this class locally and execute the</p>







<div class="codeblock">
    
        <div class="copy-button-box">
            <button class="copy-button" state="copy" data="#ZgotmplZ">
                <i class="bi bi-copy"></i>
            </button>
        </div>
    

    
        <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">xor</span>(x, y):
</span></span><span style="display:flex;"><span>    x <span style="color:#f92672">=</span> int<span style="color:#f92672">.</span>from_bytes(x, <span style="color:#e6db74">&#34;little&#34;</span>)
</span></span><span style="display:flex;"><span>    y <span style="color:#f92672">=</span> int<span style="color:#f92672">.</span>from_bytes(y, <span style="color:#e6db74">&#34;little&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    z <span style="color:#f92672">=</span> x <span style="color:#f92672">^</span> y
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> z<span style="color:#f92672">.</span>to_bytes(<span style="color:#ae81ff">16</span>, <span style="color:#e6db74">&#34;little&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>zero <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>zero <span style="color:#f92672">=</span> zero<span style="color:#f92672">.</span>to_bytes(<span style="color:#ae81ff">16</span>, <span style="color:#e6db74">&#34;little&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>key1 <span style="color:#f92672">=</span> urandom(<span style="color:#ae81ff">16</span>)
</span></span><span style="display:flex;"><span>aes1 <span style="color:#f92672">=</span> AES(key1)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>key2 <span style="color:#f92672">=</span> urandom(<span style="color:#ae81ff">16</span>)
</span></span><span style="display:flex;"><span>aes2 <span style="color:#f92672">=</span> AES(key2)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>vector_i_0 <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">&lt;&lt;</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>vector_i_0 <span style="color:#f92672">=</span> vector_i_0<span style="color:#f92672">.</span>to_bytes(<span style="color:#ae81ff">16</span>, <span style="color:#e6db74">&#34;little&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>enc1_zero <span style="color:#f92672">=</span> aes1<span style="color:#f92672">.</span>encrypt(zero)
</span></span><span style="display:flex;"><span>enc1_vector_i_0 <span style="color:#f92672">=</span> aes1<span style="color:#f92672">.</span>encrypt(vector_i_0)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>enc2_zero <span style="color:#f92672">=</span> aes2<span style="color:#f92672">.</span>encrypt(zero)
</span></span><span style="display:flex;"><span>enc2_vector_i_0 <span style="color:#f92672">=</span> aes2<span style="color:#f92672">.</span>encrypt(vector_i_0)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(xor(enc1_vector_i_0, enc1_zero)<span style="color:#f92672">.</span>hex())
</span></span><span style="display:flex;"><span>print(xor(enc2_vector_i_0, enc2_zero)<span style="color:#f92672">.</span>hex())</span></span></code></pre></div>
    
</div>
<p>As you can see, without any sbox the change that a corresponding bit made to the ciphertext is the same between all the keys, in this example the change between the cipher of specific vector to the cipher of the zero block is the same - no matter what the key is.</p>
<p>Now let&rsquo;s have a look on the same code but with our old good $sbox$ that is being used today.
Let&rsquo;s change the sbox in the code to this sbox (don&rsquo;t forget to change again the code to use the sbox at line 323).</p>
<p>With this $sbox$ the cipher will not be linear and thus the properties we talked above will not be valid.</p>







<div class="codeblock">
    
        <div class="copy-button-box">
            <button class="copy-button" state="copy" data="sbox%20=%20%28%0d%0a%20%20%20%200x63,%200x7C,%200x77,%200x7B,%200xF2,%200x6B,%200x6F,%200xC5,%200x30,%200x01,%200x67,%200x2B,%200xFE,%200xD7,%200xAB,%200x76,%0d%0a%20%20%20%200xCA,%200x82,%200xC9,%200x7D,%200xFA,%200x59,%200x47,%200xF0,%200xAD,%200xD4,%200xA2,%200xAF,%200x9C,%200xA4,%200x72,%200xC0,%0d%0a%20%20%20%200xB7,%200xFD,%200x93,%200x26,%200x36,%200x3F,%200xF7,%200xCC,%200x34,%200xA5,%200xE5,%200xF1,%200x71,%200xD8,%200x31,%200x15,%0d%0a%20%20%20%200x04,%200xC7,%200x23,%200xC3,%200x18,%200x96,%200x05,%200x9A,%200x07,%200x12,%200x80,%200xE2,%200xEB,%200x27,%200xB2,%200x75,%0d%0a%20%20%20%200x09,%200x83,%200x2C,%200x1A,%200x1B,%200x6E,%200x5A,%200xA0,%200x52,%200x3B,%200xD6,%200xB3,%200x29,%200xE3,%200x2F,%200x84,%0d%0a%20%20%20%200x53,%200xD1,%200x00,%200xED,%200x20,%200xFC,%200xB1,%200x5B,%200x6A,%200xCB,%200xBE,%200x39,%200x4A,%200x4C,%200x58,%200xCF,%0d%0a%20%20%20%200xD0,%200xEF,%200xAA,%200xFB,%200x43,%200x4D,%200x33,%200x85,%200x45,%200xF9,%200x02,%200x7F,%200x50,%200x3C,%200x9F,%200xA8,%0d%0a%20%20%20%200x51,%200xA3,%200x40,%200x8F,%200x92,%200x9D,%200x38,%200xF5,%200xBC,%200xB6,%200xDA,%200x21,%200x10,%200xFF,%200xF3,%200xD2,%0d%0a%20%20%20%200xCD,%200x0C,%200x13,%200xEC,%200x5F,%200x97,%200x44,%200x17,%200xC4,%200xA7,%200x7E,%200x3D,%200x64,%200x5D,%200x19,%200x73,%0d%0a%20%20%20%200x60,%200x81,%200x4F,%200xDC,%200x22,%200x2A,%200x90,%200x88,%200x46,%200xEE,%200xB8,%200x14,%200xDE,%200x5E,%200x0B,%200xDB,%0d%0a%20%20%20%200xE0,%200x32,%200x3A,%200x0A,%200x49,%200x06,%200x24,%200x5C,%200xC2,%200xD3,%200xAC,%200x62,%200x91,%200x95,%200xE4,%200x79,%0d%0a%20%20%20%200xE7,%200xC8,%200x37,%200x6D,%200x8D,%200xD5,%200x4E,%200xA9,%200x6C,%200x56,%200xF4,%200xEA,%200x65,%200x7A,%200xAE,%200x08,%0d%0a%20%20%20%200xBA,%200x78,%200x25,%200x2E,%200x1C,%200xA6,%200xB4,%200xC6,%200xE8,%200xDD,%200x74,%200x1F,%200x4B,%200xBD,%200x8B,%200x8A,%0d%0a%20%20%20%200x70,%200x3E,%200xB5,%200x66,%200x48,%200x03,%200xF6,%200x0E,%200x61,%200x35,%200x57,%200xB9,%200x86,%200xC1,%200x1D,%200x9E,%0d%0a%20%20%20%200xE1,%200xF8,%200x98,%200x11,%200x69,%200xD9,%200x8E,%200x94,%200x9B,%200x1E,%200x87,%200xE9,%200xCE,%200x55,%200x28,%200xDF,%0d%0a%20%20%20%200x8C,%200xA1,%200x89,%200x0D,%200xBF,%200xE6,%200x42,%200x68,%200x41,%200x99,%200x2D,%200x0F,%200xB0,%200x54,%200xBB,%200x16,%0d%0a%29">
                <i class="bi bi-copy"></i>
            </button>
        </div>
    

    
        <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>sbox <span style="color:#f92672">=</span> (
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">0x63</span>, <span style="color:#ae81ff">0x7C</span>, <span style="color:#ae81ff">0x77</span>, <span style="color:#ae81ff">0x7B</span>, <span style="color:#ae81ff">0xF2</span>, <span style="color:#ae81ff">0x6B</span>, <span style="color:#ae81ff">0x6F</span>, <span style="color:#ae81ff">0xC5</span>, <span style="color:#ae81ff">0x30</span>, <span style="color:#ae81ff">0x01</span>, <span style="color:#ae81ff">0x67</span>, <span style="color:#ae81ff">0x2B</span>, <span style="color:#ae81ff">0xFE</span>, <span style="color:#ae81ff">0xD7</span>, <span style="color:#ae81ff">0xAB</span>, <span style="color:#ae81ff">0x76</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">0xCA</span>, <span style="color:#ae81ff">0x82</span>, <span style="color:#ae81ff">0xC9</span>, <span style="color:#ae81ff">0x7D</span>, <span style="color:#ae81ff">0xFA</span>, <span style="color:#ae81ff">0x59</span>, <span style="color:#ae81ff">0x47</span>, <span style="color:#ae81ff">0xF0</span>, <span style="color:#ae81ff">0xAD</span>, <span style="color:#ae81ff">0xD4</span>, <span style="color:#ae81ff">0xA2</span>, <span style="color:#ae81ff">0xAF</span>, <span style="color:#ae81ff">0x9C</span>, <span style="color:#ae81ff">0xA4</span>, <span style="color:#ae81ff">0x72</span>, <span style="color:#ae81ff">0xC0</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">0xB7</span>, <span style="color:#ae81ff">0xFD</span>, <span style="color:#ae81ff">0x93</span>, <span style="color:#ae81ff">0x26</span>, <span style="color:#ae81ff">0x36</span>, <span style="color:#ae81ff">0x3F</span>, <span style="color:#ae81ff">0xF7</span>, <span style="color:#ae81ff">0xCC</span>, <span style="color:#ae81ff">0x34</span>, <span style="color:#ae81ff">0xA5</span>, <span style="color:#ae81ff">0xE5</span>, <span style="color:#ae81ff">0xF1</span>, <span style="color:#ae81ff">0x71</span>, <span style="color:#ae81ff">0xD8</span>, <span style="color:#ae81ff">0x31</span>, <span style="color:#ae81ff">0x15</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">0x04</span>, <span style="color:#ae81ff">0xC7</span>, <span style="color:#ae81ff">0x23</span>, <span style="color:#ae81ff">0xC3</span>, <span style="color:#ae81ff">0x18</span>, <span style="color:#ae81ff">0x96</span>, <span style="color:#ae81ff">0x05</span>, <span style="color:#ae81ff">0x9A</span>, <span style="color:#ae81ff">0x07</span>, <span style="color:#ae81ff">0x12</span>, <span style="color:#ae81ff">0x80</span>, <span style="color:#ae81ff">0xE2</span>, <span style="color:#ae81ff">0xEB</span>, <span style="color:#ae81ff">0x27</span>, <span style="color:#ae81ff">0xB2</span>, <span style="color:#ae81ff">0x75</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">0x09</span>, <span style="color:#ae81ff">0x83</span>, <span style="color:#ae81ff">0x2C</span>, <span style="color:#ae81ff">0x1A</span>, <span style="color:#ae81ff">0x1B</span>, <span style="color:#ae81ff">0x6E</span>, <span style="color:#ae81ff">0x5A</span>, <span style="color:#ae81ff">0xA0</span>, <span style="color:#ae81ff">0x52</span>, <span style="color:#ae81ff">0x3B</span>, <span style="color:#ae81ff">0xD6</span>, <span style="color:#ae81ff">0xB3</span>, <span style="color:#ae81ff">0x29</span>, <span style="color:#ae81ff">0xE3</span>, <span style="color:#ae81ff">0x2F</span>, <span style="color:#ae81ff">0x84</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">0x53</span>, <span style="color:#ae81ff">0xD1</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0xED</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0xFC</span>, <span style="color:#ae81ff">0xB1</span>, <span style="color:#ae81ff">0x5B</span>, <span style="color:#ae81ff">0x6A</span>, <span style="color:#ae81ff">0xCB</span>, <span style="color:#ae81ff">0xBE</span>, <span style="color:#ae81ff">0x39</span>, <span style="color:#ae81ff">0x4A</span>, <span style="color:#ae81ff">0x4C</span>, <span style="color:#ae81ff">0x58</span>, <span style="color:#ae81ff">0xCF</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">0xD0</span>, <span style="color:#ae81ff">0xEF</span>, <span style="color:#ae81ff">0xAA</span>, <span style="color:#ae81ff">0xFB</span>, <span style="color:#ae81ff">0x43</span>, <span style="color:#ae81ff">0x4D</span>, <span style="color:#ae81ff">0x33</span>, <span style="color:#ae81ff">0x85</span>, <span style="color:#ae81ff">0x45</span>, <span style="color:#ae81ff">0xF9</span>, <span style="color:#ae81ff">0x02</span>, <span style="color:#ae81ff">0x7F</span>, <span style="color:#ae81ff">0x50</span>, <span style="color:#ae81ff">0x3C</span>, <span style="color:#ae81ff">0x9F</span>, <span style="color:#ae81ff">0xA8</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">0x51</span>, <span style="color:#ae81ff">0xA3</span>, <span style="color:#ae81ff">0x40</span>, <span style="color:#ae81ff">0x8F</span>, <span style="color:#ae81ff">0x92</span>, <span style="color:#ae81ff">0x9D</span>, <span style="color:#ae81ff">0x38</span>, <span style="color:#ae81ff">0xF5</span>, <span style="color:#ae81ff">0xBC</span>, <span style="color:#ae81ff">0xB6</span>, <span style="color:#ae81ff">0xDA</span>, <span style="color:#ae81ff">0x21</span>, <span style="color:#ae81ff">0x10</span>, <span style="color:#ae81ff">0xFF</span>, <span style="color:#ae81ff">0xF3</span>, <span style="color:#ae81ff">0xD2</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">0xCD</span>, <span style="color:#ae81ff">0x0C</span>, <span style="color:#ae81ff">0x13</span>, <span style="color:#ae81ff">0xEC</span>, <span style="color:#ae81ff">0x5F</span>, <span style="color:#ae81ff">0x97</span>, <span style="color:#ae81ff">0x44</span>, <span style="color:#ae81ff">0x17</span>, <span style="color:#ae81ff">0xC4</span>, <span style="color:#ae81ff">0xA7</span>, <span style="color:#ae81ff">0x7E</span>, <span style="color:#ae81ff">0x3D</span>, <span style="color:#ae81ff">0x64</span>, <span style="color:#ae81ff">0x5D</span>, <span style="color:#ae81ff">0x19</span>, <span style="color:#ae81ff">0x73</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">0x60</span>, <span style="color:#ae81ff">0x81</span>, <span style="color:#ae81ff">0x4F</span>, <span style="color:#ae81ff">0xDC</span>, <span style="color:#ae81ff">0x22</span>, <span style="color:#ae81ff">0x2A</span>, <span style="color:#ae81ff">0x90</span>, <span style="color:#ae81ff">0x88</span>, <span style="color:#ae81ff">0x46</span>, <span style="color:#ae81ff">0xEE</span>, <span style="color:#ae81ff">0xB8</span>, <span style="color:#ae81ff">0x14</span>, <span style="color:#ae81ff">0xDE</span>, <span style="color:#ae81ff">0x5E</span>, <span style="color:#ae81ff">0x0B</span>, <span style="color:#ae81ff">0xDB</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">0xE0</span>, <span style="color:#ae81ff">0x32</span>, <span style="color:#ae81ff">0x3A</span>, <span style="color:#ae81ff">0x0A</span>, <span style="color:#ae81ff">0x49</span>, <span style="color:#ae81ff">0x06</span>, <span style="color:#ae81ff">0x24</span>, <span style="color:#ae81ff">0x5C</span>, <span style="color:#ae81ff">0xC2</span>, <span style="color:#ae81ff">0xD3</span>, <span style="color:#ae81ff">0xAC</span>, <span style="color:#ae81ff">0x62</span>, <span style="color:#ae81ff">0x91</span>, <span style="color:#ae81ff">0x95</span>, <span style="color:#ae81ff">0xE4</span>, <span style="color:#ae81ff">0x79</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">0xE7</span>, <span style="color:#ae81ff">0xC8</span>, <span style="color:#ae81ff">0x37</span>, <span style="color:#ae81ff">0x6D</span>, <span style="color:#ae81ff">0x8D</span>, <span style="color:#ae81ff">0xD5</span>, <span style="color:#ae81ff">0x4E</span>, <span style="color:#ae81ff">0xA9</span>, <span style="color:#ae81ff">0x6C</span>, <span style="color:#ae81ff">0x56</span>, <span style="color:#ae81ff">0xF4</span>, <span style="color:#ae81ff">0xEA</span>, <span style="color:#ae81ff">0x65</span>, <span style="color:#ae81ff">0x7A</span>, <span style="color:#ae81ff">0xAE</span>, <span style="color:#ae81ff">0x08</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">0xBA</span>, <span style="color:#ae81ff">0x78</span>, <span style="color:#ae81ff">0x25</span>, <span style="color:#ae81ff">0x2E</span>, <span style="color:#ae81ff">0x1C</span>, <span style="color:#ae81ff">0xA6</span>, <span style="color:#ae81ff">0xB4</span>, <span style="color:#ae81ff">0xC6</span>, <span style="color:#ae81ff">0xE8</span>, <span style="color:#ae81ff">0xDD</span>, <span style="color:#ae81ff">0x74</span>, <span style="color:#ae81ff">0x1F</span>, <span style="color:#ae81ff">0x4B</span>, <span style="color:#ae81ff">0xBD</span>, <span style="color:#ae81ff">0x8B</span>, <span style="color:#ae81ff">0x8A</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">0x70</span>, <span style="color:#ae81ff">0x3E</span>, <span style="color:#ae81ff">0xB5</span>, <span style="color:#ae81ff">0x66</span>, <span style="color:#ae81ff">0x48</span>, <span style="color:#ae81ff">0x03</span>, <span style="color:#ae81ff">0xF6</span>, <span style="color:#ae81ff">0x0E</span>, <span style="color:#ae81ff">0x61</span>, <span style="color:#ae81ff">0x35</span>, <span style="color:#ae81ff">0x57</span>, <span style="color:#ae81ff">0xB9</span>, <span style="color:#ae81ff">0x86</span>, <span style="color:#ae81ff">0xC1</span>, <span style="color:#ae81ff">0x1D</span>, <span style="color:#ae81ff">0x9E</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">0xE1</span>, <span style="color:#ae81ff">0xF8</span>, <span style="color:#ae81ff">0x98</span>, <span style="color:#ae81ff">0x11</span>, <span style="color:#ae81ff">0x69</span>, <span style="color:#ae81ff">0xD9</span>, <span style="color:#ae81ff">0x8E</span>, <span style="color:#ae81ff">0x94</span>, <span style="color:#ae81ff">0x9B</span>, <span style="color:#ae81ff">0x1E</span>, <span style="color:#ae81ff">0x87</span>, <span style="color:#ae81ff">0xE9</span>, <span style="color:#ae81ff">0xCE</span>, <span style="color:#ae81ff">0x55</span>, <span style="color:#ae81ff">0x28</span>, <span style="color:#ae81ff">0xDF</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">0x8C</span>, <span style="color:#ae81ff">0xA1</span>, <span style="color:#ae81ff">0x89</span>, <span style="color:#ae81ff">0x0D</span>, <span style="color:#ae81ff">0xBF</span>, <span style="color:#ae81ff">0xE6</span>, <span style="color:#ae81ff">0x42</span>, <span style="color:#ae81ff">0x68</span>, <span style="color:#ae81ff">0x41</span>, <span style="color:#ae81ff">0x99</span>, <span style="color:#ae81ff">0x2D</span>, <span style="color:#ae81ff">0x0F</span>, <span style="color:#ae81ff">0xB0</span>, <span style="color:#ae81ff">0x54</span>, <span style="color:#ae81ff">0xBB</span>, <span style="color:#ae81ff">0x16</span>,
</span></span><span style="display:flex;"><span>)</span></span></code></pre></div>
    
</div>
<p>So we now understand that the point of the $sbox$ is to make this cipher non linear. what happen when we use weak $sbox$? Let&rsquo;s have a look on the next $sbox$</p>







<div class="codeblock">
    
        <div class="copy-button-box">
            <button class="copy-button" state="copy" data="sbox%20=%20[%28i%20%5e%200b11100111%29%20for%20i%20in%20range%28256%29]">
                <i class="bi bi-copy"></i>
            </button>
        </div>
    

    
        <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>sbox <span style="color:#f92672">=</span> [(i <span style="color:#f92672">^</span> <span style="color:#ae81ff">0b11100111</span>) <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">256</span>)]</span></span></code></pre></div>
    
</div>
<p>The next $sbox$ is linear, meaning the whole cipher will become linear and the same properties will take place.</p>
<p>So, how do we exploit this vulnerability in this cipher to gain access to the flag?
First we use our local cipher to find how each byte affect the ciphertext.
We will encrypt the zero block to gain ciphertext and plaintext vector to compare to.</p>
<p>$$
enc\text{\textunderscore}zero = ENC(zero)
$$</p>
<p>Then we will iterate over each bit in the 128 bits blocks and for each bit we will create a vector for that bit, that only this bit will be $1$</p>
<p>$$
I = {p_i \ | \ only\ the\ i\ bit\ in\ the\ vector\ is\ 1 \ | \ 0 &lt;= i &lt; 256}
$$</p>
<p>For each vector there we will encrypt it</p>
<p>$$
C = {c_i = ENC(p_i) \ \ | \ \ p_i \ \ | \ \ 0 &lt;= i &lt; 256}
$$</p>
<p>Now we can calculate for each $p_i$ in $P$ what the changes it made to the bits in $c_i$.</p>
<p>$$
linear\text{\textunderscore}changes = {enc\text{\textunderscore}zero \oplus c_i \ \ | \ \ 0 &lt;= i &lt; 256}
$$</p>
<p>Those $linear\text{\textunderscore}changes$ are actually</p>
<p>$$
enc\text{\textunderscore}zero \oplus (linear\text{\textunderscore}changes * m) = enc\text{\textunderscore}data
$$
So
$$
(linear\text{\textunderscore}changes * m) = enc\text{\textunderscore}data \oplus enc\text{\textunderscore}zero
$$</p>
<p>Where $m$ is the coefficient of each variable in the linear function (the AES)</p>
<p>The thing is that now we can get the $encrypted\text{\textunderscore}flag$ and encrypt the $zero$ from the remote program (they both will be encrypted with the same key), then xor them and we will get $(linear\text{\textunderscore}changes * m)$.</p>
<p>Because we have $linear\text{\textunderscore}changes$ we can calculate $m$.</p>
<p>With $m$ we can understand how to get from the $zero$ to the $flag$.</p>
<p>We will just do the following calculation</p>
<p>$$
I * m = flag
$$</p>







<div class="codeblock">
    
        <div class="copy-button-box">
            <button class="copy-button" state="copy" data="#ZgotmplZ">
                <i class="bi bi-copy"></i>
            </button>
        </div>
    

    
        <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> pwn <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> json
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> base64
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> codecs
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> Crypto.Util.number
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> galois
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> pyfinite <span style="color:#f92672">import</span> ffield
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> os <span style="color:#f92672">import</span> urandom
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">AES_Helper</span>:
</span></span><span style="display:flex;"><span>    sbox <span style="color:#f92672">=</span> (
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0x2a</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x7e</span>, <span style="color:#ae81ff">0x54</span>, <span style="color:#ae81ff">0x82</span>, <span style="color:#ae81ff">0xa8</span>, <span style="color:#ae81ff">0xd6</span>, <span style="color:#ae81ff">0xfc</span>, <span style="color:#ae81ff">0x61</span>, <span style="color:#ae81ff">0x4b</span>, <span style="color:#ae81ff">0x35</span>, <span style="color:#ae81ff">0x1f</span>, <span style="color:#ae81ff">0xc9</span>, <span style="color:#ae81ff">0xe3</span>, <span style="color:#ae81ff">0x9d</span>, <span style="color:#ae81ff">0xb7</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0xbc</span>, <span style="color:#ae81ff">0x96</span>, <span style="color:#ae81ff">0xe8</span>, <span style="color:#ae81ff">0xc2</span>, <span style="color:#ae81ff">0x14</span>, <span style="color:#ae81ff">0x3e</span>, <span style="color:#ae81ff">0x40</span>, <span style="color:#ae81ff">0x6a</span>, <span style="color:#ae81ff">0xf7</span>, <span style="color:#ae81ff">0xdd</span>, <span style="color:#ae81ff">0xa3</span>, <span style="color:#ae81ff">0x89</span>, <span style="color:#ae81ff">0x5f</span>, <span style="color:#ae81ff">0x75</span>, <span style="color:#ae81ff">0x0b</span>, <span style="color:#ae81ff">0x21</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0x1d</span>, <span style="color:#ae81ff">0x37</span>, <span style="color:#ae81ff">0x49</span>, <span style="color:#ae81ff">0x63</span>, <span style="color:#ae81ff">0xb5</span>, <span style="color:#ae81ff">0x9f</span>, <span style="color:#ae81ff">0xe1</span>, <span style="color:#ae81ff">0xcb</span>, <span style="color:#ae81ff">0x56</span>, <span style="color:#ae81ff">0x7c</span>, <span style="color:#ae81ff">0x02</span>, <span style="color:#ae81ff">0x28</span>, <span style="color:#ae81ff">0xfe</span>, <span style="color:#ae81ff">0xd4</span>, <span style="color:#ae81ff">0xaa</span>, <span style="color:#ae81ff">0x80</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0x8b</span>, <span style="color:#ae81ff">0xa1</span>, <span style="color:#ae81ff">0xdf</span>, <span style="color:#ae81ff">0xf5</span>, <span style="color:#ae81ff">0x23</span>, <span style="color:#ae81ff">0x09</span>, <span style="color:#ae81ff">0x77</span>, <span style="color:#ae81ff">0x5d</span>, <span style="color:#ae81ff">0xc0</span>, <span style="color:#ae81ff">0xea</span>, <span style="color:#ae81ff">0x94</span>, <span style="color:#ae81ff">0xbe</span>, <span style="color:#ae81ff">0x68</span>, <span style="color:#ae81ff">0x42</span>, <span style="color:#ae81ff">0x3c</span>, <span style="color:#ae81ff">0x16</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0x44</span>, <span style="color:#ae81ff">0x6e</span>, <span style="color:#ae81ff">0x10</span>, <span style="color:#ae81ff">0x3a</span>, <span style="color:#ae81ff">0xec</span>, <span style="color:#ae81ff">0xc6</span>, <span style="color:#ae81ff">0xb8</span>, <span style="color:#ae81ff">0x92</span>, <span style="color:#ae81ff">0x0f</span>, <span style="color:#ae81ff">0x25</span>, <span style="color:#ae81ff">0x5b</span>, <span style="color:#ae81ff">0x71</span>, <span style="color:#ae81ff">0xa7</span>, <span style="color:#ae81ff">0x8d</span>, <span style="color:#ae81ff">0xf3</span>, <span style="color:#ae81ff">0xd9</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0xd2</span>, <span style="color:#ae81ff">0xf8</span>, <span style="color:#ae81ff">0x86</span>, <span style="color:#ae81ff">0xac</span>, <span style="color:#ae81ff">0x7a</span>, <span style="color:#ae81ff">0x50</span>, <span style="color:#ae81ff">0x2e</span>, <span style="color:#ae81ff">0x04</span>, <span style="color:#ae81ff">0x99</span>, <span style="color:#ae81ff">0xb3</span>, <span style="color:#ae81ff">0xcd</span>, <span style="color:#ae81ff">0xe7</span>, <span style="color:#ae81ff">0x31</span>, <span style="color:#ae81ff">0x1b</span>, <span style="color:#ae81ff">0x65</span>, <span style="color:#ae81ff">0x4f</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0x73</span>, <span style="color:#ae81ff">0x59</span>, <span style="color:#ae81ff">0x27</span>, <span style="color:#ae81ff">0x0d</span>, <span style="color:#ae81ff">0xdb</span>, <span style="color:#ae81ff">0xf1</span>, <span style="color:#ae81ff">0x8f</span>, <span style="color:#ae81ff">0xa5</span>, <span style="color:#ae81ff">0x38</span>, <span style="color:#ae81ff">0x12</span>, <span style="color:#ae81ff">0x6c</span>, <span style="color:#ae81ff">0x46</span>, <span style="color:#ae81ff">0x90</span>, <span style="color:#ae81ff">0xba</span>, <span style="color:#ae81ff">0xc4</span>, <span style="color:#ae81ff">0xee</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0xe5</span>, <span style="color:#ae81ff">0xcf</span>, <span style="color:#ae81ff">0xb1</span>, <span style="color:#ae81ff">0x9b</span>, <span style="color:#ae81ff">0x4d</span>, <span style="color:#ae81ff">0x67</span>, <span style="color:#ae81ff">0x19</span>, <span style="color:#ae81ff">0x33</span>, <span style="color:#ae81ff">0xae</span>, <span style="color:#ae81ff">0x84</span>, <span style="color:#ae81ff">0xfa</span>, <span style="color:#ae81ff">0xd0</span>, <span style="color:#ae81ff">0x06</span>, <span style="color:#ae81ff">0x2c</span>, <span style="color:#ae81ff">0x52</span>, <span style="color:#ae81ff">0x78</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0xf6</span>, <span style="color:#ae81ff">0xdc</span>, <span style="color:#ae81ff">0xa2</span>, <span style="color:#ae81ff">0x88</span>, <span style="color:#ae81ff">0x5e</span>, <span style="color:#ae81ff">0x74</span>, <span style="color:#ae81ff">0x0a</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0xbd</span>, <span style="color:#ae81ff">0x97</span>, <span style="color:#ae81ff">0xe9</span>, <span style="color:#ae81ff">0xc3</span>, <span style="color:#ae81ff">0x15</span>, <span style="color:#ae81ff">0x3f</span>, <span style="color:#ae81ff">0x41</span>, <span style="color:#ae81ff">0x6b</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0x60</span>, <span style="color:#ae81ff">0x4a</span>, <span style="color:#ae81ff">0x34</span>, <span style="color:#ae81ff">0x1e</span>, <span style="color:#ae81ff">0xc8</span>, <span style="color:#ae81ff">0xe2</span>, <span style="color:#ae81ff">0x9c</span>, <span style="color:#ae81ff">0xb6</span>, <span style="color:#ae81ff">0x2b</span>, <span style="color:#ae81ff">0x01</span>, <span style="color:#ae81ff">0x7f</span>, <span style="color:#ae81ff">0x55</span>, <span style="color:#ae81ff">0x83</span>, <span style="color:#ae81ff">0xa9</span>, <span style="color:#ae81ff">0xd7</span>, <span style="color:#ae81ff">0xfd</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0xc1</span>, <span style="color:#ae81ff">0xeb</span>, <span style="color:#ae81ff">0x95</span>, <span style="color:#ae81ff">0xbf</span>, <span style="color:#ae81ff">0x69</span>, <span style="color:#ae81ff">0x43</span>, <span style="color:#ae81ff">0x3d</span>, <span style="color:#ae81ff">0x17</span>, <span style="color:#ae81ff">0x8a</span>, <span style="color:#ae81ff">0xa0</span>, <span style="color:#ae81ff">0xde</span>, <span style="color:#ae81ff">0xf4</span>, <span style="color:#ae81ff">0x22</span>, <span style="color:#ae81ff">0x08</span>, <span style="color:#ae81ff">0x76</span>, <span style="color:#ae81ff">0x5c</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0x57</span>, <span style="color:#ae81ff">0x7d</span>, <span style="color:#ae81ff">0x03</span>, <span style="color:#ae81ff">0x29</span>, <span style="color:#ae81ff">0xff</span>, <span style="color:#ae81ff">0xd5</span>, <span style="color:#ae81ff">0xab</span>, <span style="color:#ae81ff">0x81</span>, <span style="color:#ae81ff">0x1c</span>, <span style="color:#ae81ff">0x36</span>, <span style="color:#ae81ff">0x48</span>, <span style="color:#ae81ff">0x62</span>, <span style="color:#ae81ff">0xb4</span>, <span style="color:#ae81ff">0x9e</span>, <span style="color:#ae81ff">0xe0</span>, <span style="color:#ae81ff">0xca</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0x98</span>, <span style="color:#ae81ff">0xb2</span>, <span style="color:#ae81ff">0xcc</span>, <span style="color:#ae81ff">0xe6</span>, <span style="color:#ae81ff">0x30</span>, <span style="color:#ae81ff">0x1a</span>, <span style="color:#ae81ff">0x64</span>, <span style="color:#ae81ff">0x4e</span>, <span style="color:#ae81ff">0xd3</span>, <span style="color:#ae81ff">0xf9</span>, <span style="color:#ae81ff">0x87</span>, <span style="color:#ae81ff">0xad</span>, <span style="color:#ae81ff">0x7b</span>, <span style="color:#ae81ff">0x51</span>, <span style="color:#ae81ff">0x2f</span>, <span style="color:#ae81ff">0x05</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0x0e</span>, <span style="color:#ae81ff">0x24</span>, <span style="color:#ae81ff">0x5a</span>, <span style="color:#ae81ff">0x70</span>, <span style="color:#ae81ff">0xa6</span>, <span style="color:#ae81ff">0x8c</span>, <span style="color:#ae81ff">0xf2</span>, <span style="color:#ae81ff">0xd8</span>, <span style="color:#ae81ff">0x45</span>, <span style="color:#ae81ff">0x6f</span>, <span style="color:#ae81ff">0x11</span>, <span style="color:#ae81ff">0x3b</span>, <span style="color:#ae81ff">0xed</span>, <span style="color:#ae81ff">0xc7</span>, <span style="color:#ae81ff">0xb9</span>, <span style="color:#ae81ff">0x93</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0xaf</span>, <span style="color:#ae81ff">0x85</span>, <span style="color:#ae81ff">0xfb</span>, <span style="color:#ae81ff">0xd1</span>, <span style="color:#ae81ff">0x07</span>, <span style="color:#ae81ff">0x2d</span>, <span style="color:#ae81ff">0x53</span>, <span style="color:#ae81ff">0x79</span>, <span style="color:#ae81ff">0xe4</span>, <span style="color:#ae81ff">0xce</span>, <span style="color:#ae81ff">0xb0</span>, <span style="color:#ae81ff">0x9a</span>, <span style="color:#ae81ff">0x4c</span>, <span style="color:#ae81ff">0x66</span>, <span style="color:#ae81ff">0x18</span>, <span style="color:#ae81ff">0x32</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0x39</span>, <span style="color:#ae81ff">0x13</span>, <span style="color:#ae81ff">0x6d</span>, <span style="color:#ae81ff">0x47</span>, <span style="color:#ae81ff">0x91</span>, <span style="color:#ae81ff">0xbb</span>, <span style="color:#ae81ff">0xc5</span>, <span style="color:#ae81ff">0xef</span>, <span style="color:#ae81ff">0x72</span>, <span style="color:#ae81ff">0x58</span>, <span style="color:#ae81ff">0x26</span>, <span style="color:#ae81ff">0x0c</span>, <span style="color:#ae81ff">0xda</span>, <span style="color:#ae81ff">0xf0</span>, <span style="color:#ae81ff">0x8e</span>, <span style="color:#ae81ff">0xa4</span>
</span></span><span style="display:flex;"><span>    )
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    rcon <span style="color:#f92672">=</span> (<span style="color:#ae81ff">0x8d</span>, <span style="color:#ae81ff">0x01</span>, <span style="color:#ae81ff">0x02</span>, <span style="color:#ae81ff">0x04</span>, <span style="color:#ae81ff">0x08</span>, <span style="color:#ae81ff">0x10</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x40</span>, <span style="color:#ae81ff">0x80</span>, <span style="color:#ae81ff">0x1b</span>, <span style="color:#ae81ff">0x36</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># multiple with F(2) under irreduciable polynom</span>
</span></span><span style="display:flex;"><span>    gmul2 <span style="color:#f92672">=</span> (
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x02</span>, <span style="color:#ae81ff">0x04</span>, <span style="color:#ae81ff">0x06</span>, <span style="color:#ae81ff">0x08</span>, <span style="color:#ae81ff">0x0a</span>, <span style="color:#ae81ff">0x0c</span>, <span style="color:#ae81ff">0x0e</span>, <span style="color:#ae81ff">0x10</span>, <span style="color:#ae81ff">0x12</span>, <span style="color:#ae81ff">0x14</span>, <span style="color:#ae81ff">0x16</span>, <span style="color:#ae81ff">0x18</span>, <span style="color:#ae81ff">0x1a</span>, <span style="color:#ae81ff">0x1c</span>, <span style="color:#ae81ff">0x1e</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x22</span>, <span style="color:#ae81ff">0x24</span>, <span style="color:#ae81ff">0x26</span>, <span style="color:#ae81ff">0x28</span>, <span style="color:#ae81ff">0x2a</span>, <span style="color:#ae81ff">0x2c</span>, <span style="color:#ae81ff">0x2e</span>, <span style="color:#ae81ff">0x30</span>, <span style="color:#ae81ff">0x32</span>, <span style="color:#ae81ff">0x34</span>, <span style="color:#ae81ff">0x36</span>, <span style="color:#ae81ff">0x38</span>, <span style="color:#ae81ff">0x3a</span>, <span style="color:#ae81ff">0x3c</span>, <span style="color:#ae81ff">0x3e</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0x40</span>, <span style="color:#ae81ff">0x42</span>, <span style="color:#ae81ff">0x44</span>, <span style="color:#ae81ff">0x46</span>, <span style="color:#ae81ff">0x48</span>, <span style="color:#ae81ff">0x4a</span>, <span style="color:#ae81ff">0x4c</span>, <span style="color:#ae81ff">0x4e</span>, <span style="color:#ae81ff">0x50</span>, <span style="color:#ae81ff">0x52</span>, <span style="color:#ae81ff">0x54</span>, <span style="color:#ae81ff">0x56</span>, <span style="color:#ae81ff">0x58</span>, <span style="color:#ae81ff">0x5a</span>, <span style="color:#ae81ff">0x5c</span>, <span style="color:#ae81ff">0x5e</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0x60</span>, <span style="color:#ae81ff">0x62</span>, <span style="color:#ae81ff">0x64</span>, <span style="color:#ae81ff">0x66</span>, <span style="color:#ae81ff">0x68</span>, <span style="color:#ae81ff">0x6a</span>, <span style="color:#ae81ff">0x6c</span>, <span style="color:#ae81ff">0x6e</span>, <span style="color:#ae81ff">0x70</span>, <span style="color:#ae81ff">0x72</span>, <span style="color:#ae81ff">0x74</span>, <span style="color:#ae81ff">0x76</span>, <span style="color:#ae81ff">0x78</span>, <span style="color:#ae81ff">0x7a</span>, <span style="color:#ae81ff">0x7c</span>, <span style="color:#ae81ff">0x7e</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0x80</span>, <span style="color:#ae81ff">0x82</span>, <span style="color:#ae81ff">0x84</span>, <span style="color:#ae81ff">0x86</span>, <span style="color:#ae81ff">0x88</span>, <span style="color:#ae81ff">0x8a</span>, <span style="color:#ae81ff">0x8c</span>, <span style="color:#ae81ff">0x8e</span>, <span style="color:#ae81ff">0x90</span>, <span style="color:#ae81ff">0x92</span>, <span style="color:#ae81ff">0x94</span>, <span style="color:#ae81ff">0x96</span>, <span style="color:#ae81ff">0x98</span>, <span style="color:#ae81ff">0x9a</span>, <span style="color:#ae81ff">0x9c</span>, <span style="color:#ae81ff">0x9e</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0xa0</span>, <span style="color:#ae81ff">0xa2</span>, <span style="color:#ae81ff">0xa4</span>, <span style="color:#ae81ff">0xa6</span>, <span style="color:#ae81ff">0xa8</span>, <span style="color:#ae81ff">0xaa</span>, <span style="color:#ae81ff">0xac</span>, <span style="color:#ae81ff">0xae</span>, <span style="color:#ae81ff">0xb0</span>, <span style="color:#ae81ff">0xb2</span>, <span style="color:#ae81ff">0xb4</span>, <span style="color:#ae81ff">0xb6</span>, <span style="color:#ae81ff">0xb8</span>, <span style="color:#ae81ff">0xba</span>, <span style="color:#ae81ff">0xbc</span>, <span style="color:#ae81ff">0xbe</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0xc0</span>, <span style="color:#ae81ff">0xc2</span>, <span style="color:#ae81ff">0xc4</span>, <span style="color:#ae81ff">0xc6</span>, <span style="color:#ae81ff">0xc8</span>, <span style="color:#ae81ff">0xca</span>, <span style="color:#ae81ff">0xcc</span>, <span style="color:#ae81ff">0xce</span>, <span style="color:#ae81ff">0xd0</span>, <span style="color:#ae81ff">0xd2</span>, <span style="color:#ae81ff">0xd4</span>, <span style="color:#ae81ff">0xd6</span>, <span style="color:#ae81ff">0xd8</span>, <span style="color:#ae81ff">0xda</span>, <span style="color:#ae81ff">0xdc</span>, <span style="color:#ae81ff">0xde</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0xe0</span>, <span style="color:#ae81ff">0xe2</span>, <span style="color:#ae81ff">0xe4</span>, <span style="color:#ae81ff">0xe6</span>, <span style="color:#ae81ff">0xe8</span>, <span style="color:#ae81ff">0xea</span>, <span style="color:#ae81ff">0xec</span>, <span style="color:#ae81ff">0xee</span>, <span style="color:#ae81ff">0xf0</span>, <span style="color:#ae81ff">0xf2</span>, <span style="color:#ae81ff">0xf4</span>, <span style="color:#ae81ff">0xf6</span>, <span style="color:#ae81ff">0xf8</span>, <span style="color:#ae81ff">0xfa</span>, <span style="color:#ae81ff">0xfc</span>, <span style="color:#ae81ff">0xfe</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0x1b</span>, <span style="color:#ae81ff">0x19</span>, <span style="color:#ae81ff">0x1f</span>, <span style="color:#ae81ff">0x1d</span>, <span style="color:#ae81ff">0x13</span>, <span style="color:#ae81ff">0x11</span>, <span style="color:#ae81ff">0x17</span>, <span style="color:#ae81ff">0x15</span>, <span style="color:#ae81ff">0x0b</span>, <span style="color:#ae81ff">0x09</span>, <span style="color:#ae81ff">0x0f</span>, <span style="color:#ae81ff">0x0d</span>, <span style="color:#ae81ff">0x03</span>, <span style="color:#ae81ff">0x01</span>, <span style="color:#ae81ff">0x07</span>, <span style="color:#ae81ff">0x05</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0x3b</span>, <span style="color:#ae81ff">0x39</span>, <span style="color:#ae81ff">0x3f</span>, <span style="color:#ae81ff">0x3d</span>, <span style="color:#ae81ff">0x33</span>, <span style="color:#ae81ff">0x31</span>, <span style="color:#ae81ff">0x37</span>, <span style="color:#ae81ff">0x35</span>, <span style="color:#ae81ff">0x2b</span>, <span style="color:#ae81ff">0x29</span>, <span style="color:#ae81ff">0x2f</span>, <span style="color:#ae81ff">0x2d</span>, <span style="color:#ae81ff">0x23</span>, <span style="color:#ae81ff">0x21</span>, <span style="color:#ae81ff">0x27</span>, <span style="color:#ae81ff">0x25</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0x5b</span>, <span style="color:#ae81ff">0x59</span>, <span style="color:#ae81ff">0x5f</span>, <span style="color:#ae81ff">0x5d</span>, <span style="color:#ae81ff">0x53</span>, <span style="color:#ae81ff">0x51</span>, <span style="color:#ae81ff">0x57</span>, <span style="color:#ae81ff">0x55</span>, <span style="color:#ae81ff">0x4b</span>, <span style="color:#ae81ff">0x49</span>, <span style="color:#ae81ff">0x4f</span>, <span style="color:#ae81ff">0x4d</span>, <span style="color:#ae81ff">0x43</span>, <span style="color:#ae81ff">0x41</span>, <span style="color:#ae81ff">0x47</span>, <span style="color:#ae81ff">0x45</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0x7b</span>, <span style="color:#ae81ff">0x79</span>, <span style="color:#ae81ff">0x7f</span>, <span style="color:#ae81ff">0x7d</span>, <span style="color:#ae81ff">0x73</span>, <span style="color:#ae81ff">0x71</span>, <span style="color:#ae81ff">0x77</span>, <span style="color:#ae81ff">0x75</span>, <span style="color:#ae81ff">0x6b</span>, <span style="color:#ae81ff">0x69</span>, <span style="color:#ae81ff">0x6f</span>, <span style="color:#ae81ff">0x6d</span>, <span style="color:#ae81ff">0x63</span>, <span style="color:#ae81ff">0x61</span>, <span style="color:#ae81ff">0x67</span>, <span style="color:#ae81ff">0x65</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0x9b</span>, <span style="color:#ae81ff">0x99</span>, <span style="color:#ae81ff">0x9f</span>, <span style="color:#ae81ff">0x9d</span>, <span style="color:#ae81ff">0x93</span>, <span style="color:#ae81ff">0x91</span>, <span style="color:#ae81ff">0x97</span>, <span style="color:#ae81ff">0x95</span>, <span style="color:#ae81ff">0x8b</span>, <span style="color:#ae81ff">0x89</span>, <span style="color:#ae81ff">0x8f</span>, <span style="color:#ae81ff">0x8d</span>, <span style="color:#ae81ff">0x83</span>, <span style="color:#ae81ff">0x81</span>, <span style="color:#ae81ff">0x87</span>, <span style="color:#ae81ff">0x85</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0xbb</span>, <span style="color:#ae81ff">0xb9</span>, <span style="color:#ae81ff">0xbf</span>, <span style="color:#ae81ff">0xbd</span>, <span style="color:#ae81ff">0xb3</span>, <span style="color:#ae81ff">0xb1</span>, <span style="color:#ae81ff">0xb7</span>, <span style="color:#ae81ff">0xb5</span>, <span style="color:#ae81ff">0xab</span>, <span style="color:#ae81ff">0xa9</span>, <span style="color:#ae81ff">0xaf</span>, <span style="color:#ae81ff">0xad</span>, <span style="color:#ae81ff">0xa3</span>, <span style="color:#ae81ff">0xa1</span>, <span style="color:#ae81ff">0xa7</span>, <span style="color:#ae81ff">0xa5</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0xdb</span>, <span style="color:#ae81ff">0xd9</span>, <span style="color:#ae81ff">0xdf</span>, <span style="color:#ae81ff">0xdd</span>, <span style="color:#ae81ff">0xd3</span>, <span style="color:#ae81ff">0xd1</span>, <span style="color:#ae81ff">0xd7</span>, <span style="color:#ae81ff">0xd5</span>, <span style="color:#ae81ff">0xcb</span>, <span style="color:#ae81ff">0xc9</span>, <span style="color:#ae81ff">0xcf</span>, <span style="color:#ae81ff">0xcd</span>, <span style="color:#ae81ff">0xc3</span>, <span style="color:#ae81ff">0xc1</span>, <span style="color:#ae81ff">0xc7</span>, <span style="color:#ae81ff">0xc5</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0xfb</span>, <span style="color:#ae81ff">0xf9</span>, <span style="color:#ae81ff">0xff</span>, <span style="color:#ae81ff">0xfd</span>, <span style="color:#ae81ff">0xf3</span>, <span style="color:#ae81ff">0xf1</span>, <span style="color:#ae81ff">0xf7</span>, <span style="color:#ae81ff">0xf5</span>, <span style="color:#ae81ff">0xeb</span>, <span style="color:#ae81ff">0xe9</span>, <span style="color:#ae81ff">0xef</span>, <span style="color:#ae81ff">0xed</span>, <span style="color:#ae81ff">0xe3</span>, <span style="color:#ae81ff">0xe1</span>, <span style="color:#ae81ff">0xe7</span>, <span style="color:#ae81ff">0xe5</span>
</span></span><span style="display:flex;"><span>    )
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># multiple with F(2) under irreduciable polynom</span>
</span></span><span style="display:flex;"><span>    gmul3 <span style="color:#f92672">=</span> (
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x03</span>, <span style="color:#ae81ff">0x06</span>, <span style="color:#ae81ff">0x05</span>, <span style="color:#ae81ff">0x0c</span>, <span style="color:#ae81ff">0x0f</span>, <span style="color:#ae81ff">0x0a</span>, <span style="color:#ae81ff">0x09</span>, <span style="color:#ae81ff">0x18</span>, <span style="color:#ae81ff">0x1b</span>, <span style="color:#ae81ff">0x1e</span>, <span style="color:#ae81ff">0x1d</span>, <span style="color:#ae81ff">0x14</span>, <span style="color:#ae81ff">0x17</span>, <span style="color:#ae81ff">0x12</span>, <span style="color:#ae81ff">0x11</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0x30</span>, <span style="color:#ae81ff">0x33</span>, <span style="color:#ae81ff">0x36</span>, <span style="color:#ae81ff">0x35</span>, <span style="color:#ae81ff">0x3c</span>, <span style="color:#ae81ff">0x3f</span>, <span style="color:#ae81ff">0x3a</span>, <span style="color:#ae81ff">0x39</span>, <span style="color:#ae81ff">0x28</span>, <span style="color:#ae81ff">0x2b</span>, <span style="color:#ae81ff">0x2e</span>, <span style="color:#ae81ff">0x2d</span>, <span style="color:#ae81ff">0x24</span>, <span style="color:#ae81ff">0x27</span>, <span style="color:#ae81ff">0x22</span>, <span style="color:#ae81ff">0x21</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0x60</span>, <span style="color:#ae81ff">0x63</span>, <span style="color:#ae81ff">0x66</span>, <span style="color:#ae81ff">0x65</span>, <span style="color:#ae81ff">0x6c</span>, <span style="color:#ae81ff">0x6f</span>, <span style="color:#ae81ff">0x6a</span>, <span style="color:#ae81ff">0x69</span>, <span style="color:#ae81ff">0x78</span>, <span style="color:#ae81ff">0x7b</span>, <span style="color:#ae81ff">0x7e</span>, <span style="color:#ae81ff">0x7d</span>, <span style="color:#ae81ff">0x74</span>, <span style="color:#ae81ff">0x77</span>, <span style="color:#ae81ff">0x72</span>, <span style="color:#ae81ff">0x71</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0x50</span>, <span style="color:#ae81ff">0x53</span>, <span style="color:#ae81ff">0x56</span>, <span style="color:#ae81ff">0x55</span>, <span style="color:#ae81ff">0x5c</span>, <span style="color:#ae81ff">0x5f</span>, <span style="color:#ae81ff">0x5a</span>, <span style="color:#ae81ff">0x59</span>, <span style="color:#ae81ff">0x48</span>, <span style="color:#ae81ff">0x4b</span>, <span style="color:#ae81ff">0x4e</span>, <span style="color:#ae81ff">0x4d</span>, <span style="color:#ae81ff">0x44</span>, <span style="color:#ae81ff">0x47</span>, <span style="color:#ae81ff">0x42</span>, <span style="color:#ae81ff">0x41</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0xc0</span>, <span style="color:#ae81ff">0xc3</span>, <span style="color:#ae81ff">0xc6</span>, <span style="color:#ae81ff">0xc5</span>, <span style="color:#ae81ff">0xcc</span>, <span style="color:#ae81ff">0xcf</span>, <span style="color:#ae81ff">0xca</span>, <span style="color:#ae81ff">0xc9</span>, <span style="color:#ae81ff">0xd8</span>, <span style="color:#ae81ff">0xdb</span>, <span style="color:#ae81ff">0xde</span>, <span style="color:#ae81ff">0xdd</span>, <span style="color:#ae81ff">0xd4</span>, <span style="color:#ae81ff">0xd7</span>, <span style="color:#ae81ff">0xd2</span>, <span style="color:#ae81ff">0xd1</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0xf0</span>, <span style="color:#ae81ff">0xf3</span>, <span style="color:#ae81ff">0xf6</span>, <span style="color:#ae81ff">0xf5</span>, <span style="color:#ae81ff">0xfc</span>, <span style="color:#ae81ff">0xff</span>, <span style="color:#ae81ff">0xfa</span>, <span style="color:#ae81ff">0xf9</span>, <span style="color:#ae81ff">0xe8</span>, <span style="color:#ae81ff">0xeb</span>, <span style="color:#ae81ff">0xee</span>, <span style="color:#ae81ff">0xed</span>, <span style="color:#ae81ff">0xe4</span>, <span style="color:#ae81ff">0xe7</span>, <span style="color:#ae81ff">0xe2</span>, <span style="color:#ae81ff">0xe1</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0xa0</span>, <span style="color:#ae81ff">0xa3</span>, <span style="color:#ae81ff">0xa6</span>, <span style="color:#ae81ff">0xa5</span>, <span style="color:#ae81ff">0xac</span>, <span style="color:#ae81ff">0xaf</span>, <span style="color:#ae81ff">0xaa</span>, <span style="color:#ae81ff">0xa9</span>, <span style="color:#ae81ff">0xb8</span>, <span style="color:#ae81ff">0xbb</span>, <span style="color:#ae81ff">0xbe</span>, <span style="color:#ae81ff">0xbd</span>, <span style="color:#ae81ff">0xb4</span>, <span style="color:#ae81ff">0xb7</span>, <span style="color:#ae81ff">0xb2</span>, <span style="color:#ae81ff">0xb1</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0x90</span>, <span style="color:#ae81ff">0x93</span>, <span style="color:#ae81ff">0x96</span>, <span style="color:#ae81ff">0x95</span>, <span style="color:#ae81ff">0x9c</span>, <span style="color:#ae81ff">0x9f</span>, <span style="color:#ae81ff">0x9a</span>, <span style="color:#ae81ff">0x99</span>, <span style="color:#ae81ff">0x88</span>, <span style="color:#ae81ff">0x8b</span>, <span style="color:#ae81ff">0x8e</span>, <span style="color:#ae81ff">0x8d</span>, <span style="color:#ae81ff">0x84</span>, <span style="color:#ae81ff">0x87</span>, <span style="color:#ae81ff">0x82</span>, <span style="color:#ae81ff">0x81</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0x9b</span>, <span style="color:#ae81ff">0x98</span>, <span style="color:#ae81ff">0x9d</span>, <span style="color:#ae81ff">0x9e</span>, <span style="color:#ae81ff">0x97</span>, <span style="color:#ae81ff">0x94</span>, <span style="color:#ae81ff">0x91</span>, <span style="color:#ae81ff">0x92</span>, <span style="color:#ae81ff">0x83</span>, <span style="color:#ae81ff">0x80</span>, <span style="color:#ae81ff">0x85</span>, <span style="color:#ae81ff">0x86</span>, <span style="color:#ae81ff">0x8f</span>, <span style="color:#ae81ff">0x8c</span>, <span style="color:#ae81ff">0x89</span>, <span style="color:#ae81ff">0x8a</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0xab</span>, <span style="color:#ae81ff">0xa8</span>, <span style="color:#ae81ff">0xad</span>, <span style="color:#ae81ff">0xae</span>, <span style="color:#ae81ff">0xa7</span>, <span style="color:#ae81ff">0xa4</span>, <span style="color:#ae81ff">0xa1</span>, <span style="color:#ae81ff">0xa2</span>, <span style="color:#ae81ff">0xb3</span>, <span style="color:#ae81ff">0xb0</span>, <span style="color:#ae81ff">0xb5</span>, <span style="color:#ae81ff">0xb6</span>, <span style="color:#ae81ff">0xbf</span>, <span style="color:#ae81ff">0xbc</span>, <span style="color:#ae81ff">0xb9</span>, <span style="color:#ae81ff">0xba</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0xfb</span>, <span style="color:#ae81ff">0xf8</span>, <span style="color:#ae81ff">0xfd</span>, <span style="color:#ae81ff">0xfe</span>, <span style="color:#ae81ff">0xf7</span>, <span style="color:#ae81ff">0xf4</span>, <span style="color:#ae81ff">0xf1</span>, <span style="color:#ae81ff">0xf2</span>, <span style="color:#ae81ff">0xe3</span>, <span style="color:#ae81ff">0xe0</span>, <span style="color:#ae81ff">0xe5</span>, <span style="color:#ae81ff">0xe6</span>, <span style="color:#ae81ff">0xef</span>, <span style="color:#ae81ff">0xec</span>, <span style="color:#ae81ff">0xe9</span>, <span style="color:#ae81ff">0xea</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0xcb</span>, <span style="color:#ae81ff">0xc8</span>, <span style="color:#ae81ff">0xcd</span>, <span style="color:#ae81ff">0xce</span>, <span style="color:#ae81ff">0xc7</span>, <span style="color:#ae81ff">0xc4</span>, <span style="color:#ae81ff">0xc1</span>, <span style="color:#ae81ff">0xc2</span>, <span style="color:#ae81ff">0xd3</span>, <span style="color:#ae81ff">0xd0</span>, <span style="color:#ae81ff">0xd5</span>, <span style="color:#ae81ff">0xd6</span>, <span style="color:#ae81ff">0xdf</span>, <span style="color:#ae81ff">0xdc</span>, <span style="color:#ae81ff">0xd9</span>, <span style="color:#ae81ff">0xda</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0x5b</span>, <span style="color:#ae81ff">0x58</span>, <span style="color:#ae81ff">0x5d</span>, <span style="color:#ae81ff">0x5e</span>, <span style="color:#ae81ff">0x57</span>, <span style="color:#ae81ff">0x54</span>, <span style="color:#ae81ff">0x51</span>, <span style="color:#ae81ff">0x52</span>, <span style="color:#ae81ff">0x43</span>, <span style="color:#ae81ff">0x40</span>, <span style="color:#ae81ff">0x45</span>, <span style="color:#ae81ff">0x46</span>, <span style="color:#ae81ff">0x4f</span>, <span style="color:#ae81ff">0x4c</span>, <span style="color:#ae81ff">0x49</span>, <span style="color:#ae81ff">0x4a</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0x6b</span>, <span style="color:#ae81ff">0x68</span>, <span style="color:#ae81ff">0x6d</span>, <span style="color:#ae81ff">0x6e</span>, <span style="color:#ae81ff">0x67</span>, <span style="color:#ae81ff">0x64</span>, <span style="color:#ae81ff">0x61</span>, <span style="color:#ae81ff">0x62</span>, <span style="color:#ae81ff">0x73</span>, <span style="color:#ae81ff">0x70</span>, <span style="color:#ae81ff">0x75</span>, <span style="color:#ae81ff">0x76</span>, <span style="color:#ae81ff">0x7f</span>, <span style="color:#ae81ff">0x7c</span>, <span style="color:#ae81ff">0x79</span>, <span style="color:#ae81ff">0x7a</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0x3b</span>, <span style="color:#ae81ff">0x38</span>, <span style="color:#ae81ff">0x3d</span>, <span style="color:#ae81ff">0x3e</span>, <span style="color:#ae81ff">0x37</span>, <span style="color:#ae81ff">0x34</span>, <span style="color:#ae81ff">0x31</span>, <span style="color:#ae81ff">0x32</span>, <span style="color:#ae81ff">0x23</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x25</span>, <span style="color:#ae81ff">0x26</span>, <span style="color:#ae81ff">0x2f</span>, <span style="color:#ae81ff">0x2c</span>, <span style="color:#ae81ff">0x29</span>, <span style="color:#ae81ff">0x2a</span>, 
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">0x0b</span>, <span style="color:#ae81ff">0x08</span>, <span style="color:#ae81ff">0x0d</span>, <span style="color:#ae81ff">0x0e</span>, <span style="color:#ae81ff">0x07</span>, <span style="color:#ae81ff">0x04</span>, <span style="color:#ae81ff">0x01</span>, <span style="color:#ae81ff">0x02</span>, <span style="color:#ae81ff">0x13</span>, <span style="color:#ae81ff">0x10</span>, <span style="color:#ae81ff">0x15</span>, <span style="color:#ae81ff">0x16</span>, <span style="color:#ae81ff">0x1f</span>, <span style="color:#ae81ff">0x1c</span>, <span style="color:#ae81ff">0x19</span>, <span style="color:#ae81ff">0x1a</span>
</span></span><span style="display:flex;"><span>    )
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> __init__(self, key):
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>_block_size <span style="color:#f92672">=</span> <span style="color:#ae81ff">16</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">global</span> X
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>_round_keys <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>_expand_key([i <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> key])
</span></span><span style="display:flex;"><span>        X <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>_round_keys
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>_state <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">_transpose</span>(self, m):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> [m[<span style="color:#ae81ff">4</span> <span style="color:#f92672">*</span> j <span style="color:#f92672">+</span> i] <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">4</span>) <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">4</span>)]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">_xor</span>(self, a, b):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> [x <span style="color:#f92672">^</span> y <span style="color:#66d9ef">for</span> x, y <span style="color:#f92672">in</span> zip(a, b)]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">_expand_key</span>(self, key):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">global</span> KEYS_GLOBAL
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        round_keys <span style="color:#f92672">=</span> [key]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">10</span>):
</span></span><span style="display:flex;"><span>            round_key <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>            first <span style="color:#f92672">=</span> round_keys[i][:<span style="color:#ae81ff">4</span>]
</span></span><span style="display:flex;"><span>            last <span style="color:#f92672">=</span> round_keys[i][<span style="color:#f92672">-</span><span style="color:#ae81ff">4</span>:]
</span></span><span style="display:flex;"><span>            last <span style="color:#f92672">=</span> last[<span style="color:#ae81ff">1</span>:] <span style="color:#f92672">+</span> [last[<span style="color:#ae81ff">0</span>]]
</span></span><span style="display:flex;"><span>            last <span style="color:#f92672">=</span> [self<span style="color:#f92672">.</span>sbox[i] <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> last]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            round_key<span style="color:#f92672">.</span>extend(self<span style="color:#f92672">.</span>_xor(self<span style="color:#f92672">.</span>_xor(first, last), [self<span style="color:#f92672">.</span>rcon[i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>], <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>]))
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">4</span>):
</span></span><span style="display:flex;"><span>                round_key<span style="color:#f92672">.</span>extend(self<span style="color:#f92672">.</span>_xor(round_key[j:j <span style="color:#f92672">+</span> <span style="color:#ae81ff">4</span>], round_keys[i][j <span style="color:#f92672">+</span> <span style="color:#ae81ff">4</span>:j <span style="color:#f92672">+</span> <span style="color:#ae81ff">8</span>]))
</span></span><span style="display:flex;"><span>            round_keys<span style="color:#f92672">.</span>append(round_key)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(len(round_keys)):
</span></span><span style="display:flex;"><span>            round_keys[i] <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>_transpose(round_keys[i])
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        KEYS_GLOBAL <span style="color:#f92672">=</span> round_keys
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> round_keys
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">_add_round_key</span>(self, i):
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>_state <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>_xor(self<span style="color:#f92672">.</span>_round_keys[i], self<span style="color:#f92672">.</span>_state)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">_mix_columns</span>(self):
</span></span><span style="display:flex;"><span>        s <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0</span>] <span style="color:#f92672">*</span> self<span style="color:#f92672">.</span>_block_size
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">4</span>):
</span></span><span style="display:flex;"><span>            s[i] <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>gmul2[self<span style="color:#f92672">.</span>_state[i]] <span style="color:#f92672">^</span> self<span style="color:#f92672">.</span>gmul3[self<span style="color:#f92672">.</span>_state[i <span style="color:#f92672">+</span> <span style="color:#ae81ff">4</span>]] <span style="color:#f92672">^</span> self<span style="color:#f92672">.</span>_state[i <span style="color:#f92672">+</span> <span style="color:#ae81ff">8</span>] <span style="color:#f92672">^</span> self<span style="color:#f92672">.</span>_state[i <span style="color:#f92672">+</span> <span style="color:#ae81ff">12</span>]
</span></span><span style="display:flex;"><span>            s[i <span style="color:#f92672">+</span> <span style="color:#ae81ff">4</span>] <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>_state[i] <span style="color:#f92672">^</span> self<span style="color:#f92672">.</span>gmul2[self<span style="color:#f92672">.</span>_state[i <span style="color:#f92672">+</span> <span style="color:#ae81ff">4</span>]] <span style="color:#f92672">^</span> self<span style="color:#f92672">.</span>gmul3[self<span style="color:#f92672">.</span>_state[i <span style="color:#f92672">+</span> <span style="color:#ae81ff">8</span>]] <span style="color:#f92672">^</span> self<span style="color:#f92672">.</span>_state[i <span style="color:#f92672">+</span> <span style="color:#ae81ff">12</span>]
</span></span><span style="display:flex;"><span>            s[i <span style="color:#f92672">+</span> <span style="color:#ae81ff">8</span>] <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>_state[i] <span style="color:#f92672">^</span> self<span style="color:#f92672">.</span>_state[i <span style="color:#f92672">+</span> <span style="color:#ae81ff">4</span>] <span style="color:#f92672">^</span> self<span style="color:#f92672">.</span>gmul2[self<span style="color:#f92672">.</span>_state[i <span style="color:#f92672">+</span> <span style="color:#ae81ff">8</span>]] <span style="color:#f92672">^</span> self<span style="color:#f92672">.</span>gmul3[self<span style="color:#f92672">.</span>_state[i <span style="color:#f92672">+</span> <span style="color:#ae81ff">12</span>]]
</span></span><span style="display:flex;"><span>            s[i <span style="color:#f92672">+</span> <span style="color:#ae81ff">12</span>] <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>gmul3[self<span style="color:#f92672">.</span>_state[i]] <span style="color:#f92672">^</span> self<span style="color:#f92672">.</span>_state[i <span style="color:#f92672">+</span> <span style="color:#ae81ff">4</span>] <span style="color:#f92672">^</span> self<span style="color:#f92672">.</span>_state[i <span style="color:#f92672">+</span> <span style="color:#ae81ff">8</span>] <span style="color:#f92672">^</span> self<span style="color:#f92672">.</span>gmul2[self<span style="color:#f92672">.</span>_state[i <span style="color:#f92672">+</span> <span style="color:#ae81ff">12</span>]]
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>_state <span style="color:#f92672">=</span> s
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">_shift_rows</span>(self):
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>_state <span style="color:#f92672">=</span> [
</span></span><span style="display:flex;"><span>            self<span style="color:#f92672">.</span>_state[<span style="color:#ae81ff">0</span>], self<span style="color:#f92672">.</span>_state[<span style="color:#ae81ff">1</span>], self<span style="color:#f92672">.</span>_state[<span style="color:#ae81ff">2</span>], self<span style="color:#f92672">.</span>_state[<span style="color:#ae81ff">3</span>],
</span></span><span style="display:flex;"><span>            self<span style="color:#f92672">.</span>_state[<span style="color:#ae81ff">5</span>], self<span style="color:#f92672">.</span>_state[<span style="color:#ae81ff">6</span>], self<span style="color:#f92672">.</span>_state[<span style="color:#ae81ff">7</span>], self<span style="color:#f92672">.</span>_state[<span style="color:#ae81ff">4</span>],
</span></span><span style="display:flex;"><span>            self<span style="color:#f92672">.</span>_state[<span style="color:#ae81ff">10</span>], self<span style="color:#f92672">.</span>_state[<span style="color:#ae81ff">11</span>], self<span style="color:#f92672">.</span>_state[<span style="color:#ae81ff">8</span>], self<span style="color:#f92672">.</span>_state[<span style="color:#ae81ff">9</span>],
</span></span><span style="display:flex;"><span>            self<span style="color:#f92672">.</span>_state[<span style="color:#ae81ff">15</span>], self<span style="color:#f92672">.</span>_state[<span style="color:#ae81ff">12</span>], self<span style="color:#f92672">.</span>_state[<span style="color:#ae81ff">13</span>], self<span style="color:#f92672">.</span>_state[<span style="color:#ae81ff">14</span>]
</span></span><span style="display:flex;"><span>        ]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">_sub_bytes</span>(self):
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>_state <span style="color:#f92672">=</span> [self<span style="color:#f92672">.</span>sbox[i] <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> self<span style="color:#f92672">.</span>_state]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">_encrypt_block</span>(self):
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>_add_round_key(<span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">10</span>):
</span></span><span style="display:flex;"><span>            self<span style="color:#f92672">.</span>_sub_bytes()
</span></span><span style="display:flex;"><span>            self<span style="color:#f92672">.</span>_shift_rows()
</span></span><span style="display:flex;"><span>            self<span style="color:#f92672">.</span>_mix_columns()
</span></span><span style="display:flex;"><span>            self<span style="color:#f92672">.</span>_add_round_key(i)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>_sub_bytes()
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>_shift_rows()
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>_add_round_key(<span style="color:#ae81ff">10</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">encrypt</span>(self, plaintext):
</span></span><span style="display:flex;"><span>        ciphertext <span style="color:#f92672">=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>_state <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>_transpose([c <span style="color:#66d9ef">for</span> c <span style="color:#f92672">in</span> plaintext])
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>_encrypt_block()
</span></span><span style="display:flex;"><span>        ciphertext <span style="color:#f92672">+=</span> bytes(bytearray(self<span style="color:#f92672">.</span>_transpose(self<span style="color:#f92672">.</span>_state)))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> ciphertext
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">num_to_bits</span>(x):
</span></span><span style="display:flex;"><span>    x <span style="color:#f92672">=</span> bin(x)[<span style="color:#ae81ff">2</span>:]
</span></span><span style="display:flex;"><span>    x <span style="color:#f92672">=</span> x<span style="color:#f92672">.</span>zfill(<span style="color:#ae81ff">128</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> x
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">hex_to_bits</span>(x):
</span></span><span style="display:flex;"><span>    x <span style="color:#f92672">=</span> int<span style="color:#f92672">.</span>from_bytes(x, <span style="color:#e6db74">&#34;little&#34;</span>)
</span></span><span style="display:flex;"><span>    x <span style="color:#f92672">=</span> bin(x)[<span style="color:#ae81ff">2</span>:]
</span></span><span style="display:flex;"><span>    x <span style="color:#f92672">=</span> x<span style="color:#f92672">.</span>zfill(<span style="color:#ae81ff">128</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> x
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">bits_to_hex</span>(x):
</span></span><span style="display:flex;"><span>    x <span style="color:#f92672">=</span> int(x, <span style="color:#ae81ff">2</span>)
</span></span><span style="display:flex;"><span>    x <span style="color:#f92672">=</span> x<span style="color:#f92672">.</span>to_bytes(<span style="color:#ae81ff">16</span>, <span style="color:#e6db74">&#34;little&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> x
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">xor</span>(x, y):
</span></span><span style="display:flex;"><span>    x <span style="color:#f92672">=</span> int<span style="color:#f92672">.</span>from_bytes(x, <span style="color:#e6db74">&#34;little&#34;</span>)
</span></span><span style="display:flex;"><span>    y <span style="color:#f92672">=</span> int<span style="color:#f92672">.</span>from_bytes(y, <span style="color:#e6db74">&#34;little&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    z <span style="color:#f92672">=</span> x <span style="color:#f92672">^</span> y
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> z<span style="color:#f92672">.</span>to_bytes(<span style="color:#ae81ff">16</span>, <span style="color:#e6db74">&#34;little&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">enc_helper</span>(aes, message):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> len(message) <span style="color:#f92672">!=</span> <span style="color:#ae81ff">16</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">raise</span> <span style="color:#a6e22e">Exception</span>(<span style="color:#e6db74">&#34;Bad size&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> aes<span style="color:#f92672">.</span>encrypt(message)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>GF <span style="color:#f92672">=</span> galois<span style="color:#f92672">.</span>GF(<span style="color:#ae81ff">2</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>key_random <span style="color:#f92672">=</span> urandom(<span style="color:#ae81ff">16</span>)
</span></span><span style="display:flex;"><span>aes_helper <span style="color:#f92672">=</span> AES_Helper(key_random)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Use aes_helper to find linear function</span>
</span></span><span style="display:flex;"><span>zero <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>zero <span style="color:#f92672">=</span> zero<span style="color:#f92672">.</span>to_bytes(<span style="color:#ae81ff">16</span>, <span style="color:#e6db74">&#34;little&#34;</span>)
</span></span><span style="display:flex;"><span>zero_enc_help <span style="color:#f92672">=</span> enc_helper(aes_helper, zero)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>enc_identity_vectors <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>identity_vectors <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">128</span>):
</span></span><span style="display:flex;"><span>    n <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">&lt;&lt;</span> i
</span></span><span style="display:flex;"><span>    enc_identity_vectors<span style="color:#f92672">.</span>append(enc_helper(aes_helper, n<span style="color:#f92672">.</span>to_bytes(<span style="color:#ae81ff">16</span>, <span style="color:#e6db74">&#34;little&#34;</span>)))
</span></span><span style="display:flex;"><span>    identity_vectors<span style="color:#f92672">.</span>append(n<span style="color:#f92672">.</span>to_bytes(<span style="color:#ae81ff">16</span>, <span style="color:#e6db74">&#34;little&#34;</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>linear_func <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">128</span>):
</span></span><span style="display:flex;"><span>    x <span style="color:#f92672">=</span> int<span style="color:#f92672">.</span>from_bytes(enc_identity_vectors[i], <span style="color:#e6db74">&#34;little&#34;</span>) <span style="color:#f92672">^</span> int<span style="color:#f92672">.</span>from_bytes(zero_enc_help, <span style="color:#e6db74">&#34;little&#34;</span>)
</span></span><span style="display:flex;"><span>    f <span style="color:#f92672">=</span> x<span style="color:#f92672">.</span>to_bytes(<span style="color:#ae81ff">16</span>, <span style="color:#e6db74">&#34;little&#34;</span>)
</span></span><span style="display:flex;"><span>    linear_func<span style="color:#f92672">.</span>append(f)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>linear_mul_matrix <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">128</span>):
</span></span><span style="display:flex;"><span>    curr_row <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>    c <span style="color:#f92672">=</span> hex_to_bits(linear_func[i])
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">128</span>):
</span></span><span style="display:flex;"><span>        curr_row<span style="color:#f92672">.</span>append(int(c[j]))
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    linear_mul_matrix<span style="color:#f92672">.</span>append(curr_row)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>linear_mul_matrix <span style="color:#f92672">=</span> GF(linear_mul_matrix)<span style="color:#f92672">.</span>T
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Create identity matrix</span>
</span></span><span style="display:flex;"><span>linear_identity_matrix <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">128</span>):
</span></span><span style="display:flex;"><span>    curr_row <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>    n <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">&lt;&lt;</span> i
</span></span><span style="display:flex;"><span>    c <span style="color:#f92672">=</span> num_to_bits(n)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">128</span>):
</span></span><span style="display:flex;"><span>        curr_row<span style="color:#f92672">.</span>append(int(c[j]))
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>    linear_identity_matrix<span style="color:#f92672">.</span>append(curr_row)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>linear_identity_matrix <span style="color:#f92672">=</span> GF(linear_identity_matrix)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Get enc_flag and enc_zero from remote server</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>r <span style="color:#f92672">=</span> remote(<span style="color:#e6db74">&#39;socket.cryptohack.org&#39;</span>, <span style="color:#ae81ff">13406</span>, level <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;debug&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">json_recv</span>():
</span></span><span style="display:flex;"><span>    line <span style="color:#f92672">=</span> r<span style="color:#f92672">.</span>recvline()
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> json<span style="color:#f92672">.</span>loads(line<span style="color:#f92672">.</span>decode())
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">json_send</span>(hsh):
</span></span><span style="display:flex;"><span>    request <span style="color:#f92672">=</span> json<span style="color:#f92672">.</span>dumps(hsh)<span style="color:#f92672">.</span>encode()
</span></span><span style="display:flex;"><span>    r<span style="color:#f92672">.</span>sendline(request)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">get_enc_flag</span>():
</span></span><span style="display:flex;"><span>    json_send({<span style="color:#e6db74">&#34;option&#34;</span>: <span style="color:#e6db74">&#34;encrypt_flag&#34;</span>})
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> bytes<span style="color:#f92672">.</span>fromhex(json_recv()[<span style="color:#e6db74">&#34;encrypted_flag&#34;</span>])
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">enc_message</span>(message):
</span></span><span style="display:flex;"><span>    json_send({<span style="color:#e6db74">&#34;option&#34;</span>: <span style="color:#e6db74">&#34;encrypt_message&#34;</span>, <span style="color:#e6db74">&#34;message&#34;</span>: message<span style="color:#f92672">.</span>hex()})
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> bytes<span style="color:#f92672">.</span>fromhex(json_recv()[<span style="color:#e6db74">&#34;encrypted_message&#34;</span>])
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>_ <span style="color:#f92672">=</span> r<span style="color:#f92672">.</span>recvline()
</span></span><span style="display:flex;"><span>enc_zero <span style="color:#f92672">=</span> enc_message(zero)
</span></span><span style="display:flex;"><span>enc_flag <span style="color:#f92672">=</span> get_enc_flag()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>flag <span style="color:#f92672">=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> block_i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">0</span>, len(enc_flag), <span style="color:#ae81ff">16</span>):
</span></span><span style="display:flex;"><span>    curr_enc_flag <span style="color:#f92672">=</span> enc_flag[block_i:block_i<span style="color:#f92672">+</span><span style="color:#ae81ff">16</span>]
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    enc_xored <span style="color:#f92672">=</span> xor(curr_enc_flag, enc_zero)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Get truth vector of encrypted flag xored zero flag</span>
</span></span><span style="display:flex;"><span>    truth_vector <span style="color:#f92672">=</span> GF([int(i) <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> list(hex_to_bits(enc_xored))])
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    pols <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>linalg<span style="color:#f92672">.</span>solve(linear_mul_matrix, truth_vector)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    f <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>dot(linear_identity_matrix, pols)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    s <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> f:
</span></span><span style="display:flex;"><span>        s <span style="color:#f92672">+=</span> str(i<span style="color:#f92672">.</span>item())
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    flag <span style="color:#f92672">+=</span> bits_to_hex(s)
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>r<span style="color:#f92672">.</span>close()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(flag)</span></span></code></pre></div>
    
</div>
<p><a href="/cryptohack/symmetric/code/beat_boxer.py">beat_boxer.py</a></p>

            
        </div>
    </article>

        </main>

        <footer class="footer">
    <div class="footer-left">
        <ul class="social">
            
                <li>All Rights Reserved ®.</li>
            

            
                <li>yoavshah</li>
            

            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
        </ul>
    </div>

    <div class="footer-right">
        <ul class="control status clearfix">
            
                <li>
                    
                        Word Count:
                        4601
                    
                </li>
            

            
            

            
                <li>en</li>
            

            
                <li>
                    <a href="https://gohugo.io" class="btn" target="_blank"
                        >Hugo: 0.125.3</a
                    >
                </li>
            

            
                <li>
                    <a
                        href="https://github.com/JingWangTW/dark-theme-editor"
                        class="btn"
                        target="_blank"
                        >Theme: dark-theme-editor</a
                    >
                </li>
            

            
                <li>
                    
                        Last modified: &nbsp;
                        <time>
                            May 08 2024 10:59:55
                        </time>
                    
                </li>
            

            
                <li title="">
                    
                </li>
            
        </ul>
    </div>
</footer>

    </body>

    























    
    


    
    


    <script
        type="text/javascript"
        src="/js/index_d751713.min.5eeb120f16ea146352725c420364f87befead45f678142b8f0ffbef024646931fbc06bff07a7bd6cb57fa2f8cd8a21ba6a4ee5a278ec32303a378bc1cd17f246.js"
        integrity="sha512-XusSDxbqFGNSclxCA2T4e&#43;/q1F9ngUK48P&#43;&#43;8CRkaTH7wGv/B6e9bLV/ovjNiiG6ak7lonjsMjA6N4vBzRfyRg=="></script>














<link
    rel="stylesheet"
    href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" />




</html>
